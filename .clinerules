# ARTexplorer - Claude Code Rules

## Quick Reference
- **Project**: Interactive 3D Rational Geometry Visualization Tool
- **Architecture**: Client-side JavaScript/WebGL application
- **Documentation**: See @README.md and @Geometry documents/ for detailed docs
- **Live Site**: https://arossti.github.io/ARTexplorer/

## Project Overview
ARTexplorer (Algebraic Rational Trigonometry Explorer) combines:
- **R. Buckminster Fuller's Synergetics** - Tetrahedral geometry and spatial relationships
- **N.J. Wildberger's Rational Trigonometry** - Pure algebraic geometry (quadrance/spread)

The application maintains exact rational relationships throughout calculations, avoiding floating-point errors until the GPU boundary.

## Git Workflow (Same as OBJECTIVE)
**Standard flow**: Pull main â†’ Branch â†’ Work â†’ Test â†’ Commit â†’ Push â†’ PR (optional) â†’ Merge â†’ Repeat

1. **Start**: `git checkout main && git pull origin main`
2. **Branch**: `git checkout -b FEATURE-NAME` (from main, not other branches!)
3. **Work & Test**: Edit code â†’ Test in browser
4. **Commit**: Only when user directs (after local testing passes)
5. **Push**: `git push -u origin main` or create PR if preferred
6. **Deploy**: Auto-deploys to GitHub Pages on push to main

### Critical Git Rules
- âš ï¸ **ALWAYS push before switching branches** (unpushed = can be lost!)
- âœ… **Branch from main only** (never from feature branches)
- âœ… **Test locally before commits** - User prefers to verify before committing
- â›” **NEVER commit large binary files** (PDFs, images, etc.) - these are local coding resources only, some copyright protected

### Deployment
- **Auto-deploy**: Push to `main` â†’ GitHub Actions â†’ Deploys to GitHub Pages
- **Live URL**: https://arossti.github.io/ARTexplorer/
- **Workflow**: `.github/workflows/deploy.yml`

## Critical Files & Modules

### Core Rendering
- `modules/rt-rendering.js` - WebGL rendering engine, camera, scene management
- `modules/rt-init.js` - Application initialization and UI setup
- `modules/rt-state-manager.js` - Application state persistence

### Geometry & Mathematics
- `modules/rt-polyhedra.js` - Polyhedra generation (tetrahedron, cube, icosahedron, etc.)
- `modules/rt-math.js` - Quadray coordinates, rational trigonometry, vector operations
- `modules/rt-matrix.js` - Transformation matrices for rotations/scaling

### UI & Controls
- `modules/rt-controls.js` - UI controls and form selection
- `modules/rt-papercut.js` - Cutplane/slicing functionality
- `modules/color-theory-modal.js` - Color palette management

### Utilities
- `modules/rt-filehandler.js` - Save/load geometry state
- `modules/performance-clock.js` - Performance monitoring

### Styling
- `art.css` - All application styles
- `index.html` - Main application entry point

## Key Technical Concepts

### Coordinate Systems
- **Cartesian XYZ**: Traditional 3D coordinates
- **Quadray WXYZ**: Tetrahedral coordinates (4 basis vectors from tetrahedron center)
- Conversion between systems in `rt-math.js`

### Rational Trigonometry (RT)
- **Quadrance**: Q = aÂ² (replaces distance)
- **Spread**: s = sinÂ²Î¸ (replaces angle)
- Maintains algebraic exactness throughout calculations
- Only expands to decimals at GPU boundary

### PurePhi Symbolic Algebra
- High-precision golden ratio calculations: Ï† = (1 + âˆš5)/2
- Symbolic forms like `{a: 1, b: 1}` represent (a + bâˆš5)/2
- Used for icosahedra, dodecahedra, and Ï†-dependent polyhedra
- Methods in `rt-polyhedra.js`

### Geometry Patterns
- **IVM (Isotropic Vector Matrix)**: Space-filling octahedron-tetrahedron lattice
- **Close-packing**: Sphere arrangements
- **Duals**: Each polyhedron has a dual (vertices â†” faces)

## Development Checklist
When modifying geometry code:
1. âœ… Verify rational exactness maintained (check console for "Max error")
2. âœ… Test in both Cartesian and Quadray coordinate modes
3. âœ… Ensure face winding order is correct (counter-clockwise for outward normals)
4. âœ… Test performance with high-frequency geodesics
5. âœ… Verify state saves/loads correctly

## Common Patterns
- **Module pattern**: IIFE with `window.RT = window.RT || {}`
- **Vertex format**: `[x, y, z]` arrays
- **Face format**: `[v1, v2, v3]` vertex indices (counter-clockwise)
- **Error checking**: Compare computed vs. expected quadrance values

## File Structure
```
/
â”œâ”€â”€ index.html              â† Main entry point
â”œâ”€â”€ art.css                 â† All styles
â”œâ”€â”€ modules/                â† Core JavaScript modules
â”‚   â”œâ”€â”€ rt-rendering.js
â”‚   â”œâ”€â”€ rt-polyhedra.js
â”‚   â”œâ”€â”€ rt-math.js
â”‚   â””â”€â”€ ...
â”œâ”€â”€ demos/                  â† Test/demo files
â”œâ”€â”€ Geometry documents/     â† Documentation, research notes
â”‚   â”œâ”€â”€ Basis-Vector-Symbols.md
â”‚   â”œâ”€â”€ puri-phi.md
â”‚   â””â”€â”€ ...
â””â”€â”€ .github/workflows/      â† GitHub Actions auto-deploy
```

## Always Remember
- Read @README.md for project background and mathematical foundations
- Check @Geometry documents/ for detailed technical documentation
- Maintain rational exactness - avoid premature decimal conversion
- Test geometry changes visually in the browser
- User prefers to test locally before commits
- Don't assume every code change needs immediate commit/push

## Committing Changes
- Make atomic commits with clear messages
- Follow commit format: `Type: Brief description`
- Types: `Feat`, `Fix`, `Refactor`, `Docs`, `Improve`, `Clean`
- **Always use HEREDOC syntax** for commit messages:
  ```bash
  git commit -m "$(cat <<'EOF'
  Type: Brief description of the change

  ğŸ¤– Co-Generated with [Claude Code](https://claude.com/claude-code)

  Co-Authored-By: AndyğŸ¤¦â€â™‚ï¸ & ClaudeğŸ¤– <andy@openbuilding.ca>
  EOF
  )"
  ```

## GitHub CLI (gh)
The `gh` CLI is installed and authenticated for this project. Use it for:

### Pull Requests
```bash
# Create PR with formatted description
gh pr create --title "Type: Brief description" --body "$(cat <<'EOF'
## Summary
- Bullet point summary of changes

## Changes
- Detailed list of what was modified

ğŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: AndyğŸ¤¦â€â™‚ï¸ & ClaudeğŸ¤– <andy@openbuilding.ca>
EOF
)"

# View PR status
gh pr view

# Merge PR (after review)
gh pr merge --merge
```

### Other Useful Commands
```bash
gh pr list                 # List open PRs
gh pr checkout <number>    # Check out a PR locally
gh issue list              # List open issues
gh issue create            # Create new issue
gh repo view --web         # Open repo in browser
```
