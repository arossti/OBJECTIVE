<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>A.R.T Explorer - Polyhedra Visualization</title>
    <meta name="application-name" content="A.R.T. Geometry Explorer" />
    <meta
      name="description"
      content="An interactive explorer for Algebraic Rational Trigonometry geometry by Andy Ross Thomson, M.Arch, OAA. with guidance by Metatron"
    />
    <link rel="stylesheet" href="art.css" />
  </head>
  <body>
    <!-- Password Protection Overlay -->
    <div id="password-overlay">
      <div id="password-modal">
        <h2>A.R.T Explorer</h2>
        <p>This demonstration is password protected.</p>
        <input
          type="password"
          id="password-input"
          placeholder="Enter password"
          autocomplete="off"
        />
        <button id="password-submit">Access</button>
        <div id="password-error">Incorrect password. Please try again.</div>
      </div>
    </div>

    <!-- Info Modal - Shows on initialization -->
    <div id="info-modal-overlay" class="hidden">
      <div id="info-modal">
        <h2>A.R.T. Explorer</h2>
        <p class="modal-subtitle">
          Algebraic Rational Trigonometry Geometry Engine
        </p>

        <div class="modal-content-grid">
          <!-- Left Column -->
          <div class="modal-column">
            <div class="modal-section">
              <h3>Keyboard Shortcuts</h3>
              <div class="shortcuts-grid">
                <div class="shortcut-row">
                  <span class="shortcut-key">Left-click + drag</span>
                  <span class="shortcut-desc">Orbit camera</span>
                </div>
                <div class="shortcut-row">
                  <span class="shortcut-key">Right-click + drag</span>
                  <span class="shortcut-desc">Pan camera</span>
                </div>
                <div class="shortcut-row">
                  <span class="shortcut-key">Scroll wheel</span>
                  <span class="shortcut-desc">Zoom</span>
                </div>
                <div class="shortcut-row">
                  <span class="shortcut-key">ESC</span>
                  <span class="shortcut-desc">Deselect</span>
                </div>
                <div class="shortcut-row">
                  <span class="shortcut-key">Delete</span>
                  <span class="shortcut-desc">Remove selected instance</span>
                </div>
                <div class="shortcut-row">
                  <span class="shortcut-key">Cmd/Ctrl+Z</span>
                  <span class="shortcut-desc">Undo</span>
                </div>
                <div class="shortcut-row">
                  <span class="shortcut-key">Cmd/Ctrl+Shift+Z</span>
                  <span class="shortcut-desc">Redo</span>
                </div>
              </div>
            </div>

            <div class="modal-section">
              <h3>What is A.R.T. Explorer?</h3>
              <p class="modal-text">
                A.R.T. Explorer is a unique geometry engine combining
                <strong>R. Buckminster Fuller's Synergetics</strong> with
                <strong>N.J. Wildberger's Rational Trigonometry</strong>.
              </p>
              <p class="modal-text">
                This app uses Rational Trigonometry to perform pure algebraic
                geometry calculations in quadrance and spread space, avoiding
                transcendental functions (sin, cos, tan) entirely. Working
                symbolically in quadrance space, square roots are deferred until
                the final rendering stage when instantiating THREE.js Vector3
                vertices, maintaining algebraic exactness throughout
                intermediate calculations and only expanding to floating-point
                at the GPU boundary. Golden ratio (φ) relationships are
                preserved algebraically using φ² = φ + 1, and rotations employ
                Weierstrass substitution to convert trigonometric operations
                into pure rational expressions.
              </p>
            </div>
          </div>

          <!-- Right Column -->
          <div class="modal-column">
            <div class="modal-section">
              <h3>Key Innovations</h3>
              <ul class="feature-list">
                <li>
                  <strong>Quadray Coordinates:</strong> Tetrahedral coordinate
                  system (4 basis vectors) instead of Cartesian XYZ
                </li>
                <li>
                  <strong>Rational Trigonometry:</strong> Quadrance (Q = a²)
                  replaces distance, spread replaces angle
                </li>
                <li>
                  <strong>IVM (Isotropic Vector Matrix):</strong> Space-filling
                  octahedron-tetrahedron lattice
                </li>
                <li>
                  <strong>Close-Packing:</strong> Vertex spheres calculated
                  algebraically for perfect tangency
                </li>
              </ul>
            </div>

            <div class="modal-section">
              <h3>Why This Matters</h3>
              <p class="modal-text">
                Traditional geometry engines accumulate floating-point errors.
                A.R.T. maintains <strong>exact rational relationships</strong>
                throughout calculations, enabling precision-critical
                applications in architecture, crystallography, and computational
                geometry.
              </p>
            </div>

            <div class="modal-section">
              <h3>Credits</h3>
              <ul class="credits-list">
                <li>
                  Rudolf Dorenach, Bucky's German Associate and my first
                  Synergetics mentor
                </li>
                <li>Kirby Urner, for introducting me to Quadrays</li>
                <li>
                  Tom Ace, for his work on the basis vector conversion idea
                </li>
                <li>Gerald DeJong, for introducing me to Wildberger</li>
                <li>
                  Dawn Danby and David McConville - for their moral support and
                  enthusiasm
                </li>
                <li>
                  Bonnie DeVarco, for her tireless preservation and active
                  engagement with the original work
                </li>
                <li>
                  Mark Pavlidis, for teaching me how to navigate Git and the
                  importance of clean code
                </li>
                <li>
                  Enzyme APD, for encouraging the pursuit of these ideas against
                  all odds
                </li>
                <li>Metatron — because nothing is noticed alone</li>
              </ul>
            </div>
          </div>
        </div>

        <button id="info-modal-close" class="modal-close-btn">
          Get Started
        </button>
      </div>
    </div>

    <div id="container">
      <div id="canvas-container"></div>
      <div id="controls-panel">
        <div class="panel-header">
          <div>
            <h2>A.R.T Explorer</h2>
            <h5>by Andy Ross Thomson</h5>
          </div>
          <button
            id="info-icon-btn"
            class="info-icon-btn"
            title="About A.R.T. Explorer"
          >
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <circle
                cx="12"
                cy="12"
                r="10"
                stroke="currentColor"
                stroke-width="2"
              />
              <path
                d="M12 16V12M12 8H12.01"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
              />
            </svg>
          </button>
        </div>
        <br />
        <!-- ========================================
             SECTION 1: FILE
             ======================================== -->
        <div class="control-group">
          <h3>
            <span
              class="section-toggle collapsed"
              data-target="file-section"
            ></span>
            File
          </h3>
          <div id="file-section" class="section-content collapsed">
            <div class="control-item">
              <label class="label-section">File Operations</label>
              <div class="toggle-btn-group">
                <button
                  class="toggle-btn variant-standard"
                  id="importBtn"
                  title="Import scene state from JSON file (Ctrl/Cmd+O)"
                >
                  Import
                </button>
                <button
                  class="toggle-btn variant-standard"
                  id="exportBtn"
                  title="Export scene (JSON/glTF/glB/CSV) (Ctrl/Cmd+E)"
                >
                  Export
                </button>
                <button
                  class="toggle-btn variant-standard"
                  id="saveBtn"
                  title="Quick save to JSON file (Ctrl/Cmd+S)"
                >
                  Save
                </button>
              </div>
            </div>
            <p class="info-text">
              <strong>Import:</strong> Load .json state file<br />
              <strong>Export:</strong> Choose format (JSON/glTF/glB/CSV)<br />
              <strong>Save:</strong> Quick save to timestamped JSON<br />
              <span style="font-size: 10px; color: #666"
                >Keyboard: Ctrl/Cmd+S (Save) | Ctrl/Cmd+O (Import) | Ctrl/Cmd+E
                (Export)</span
              >
            </p>
          </div>
        </div>
        <!-- END SECTION 1: FILE -->

        <!-- ========================================
             SECTION 2: COORDINATE SYSTEMS
             ======================================== -->
        <div class="control-group">
          <h3>
            <span
              class="section-toggle collapsed"
              data-target="coordinate-system-section"
            ></span>
            Coordinate Systems
          </h3>
          <div id="coordinate-system-section" class="section-content collapsed">
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showCartesianBasis" />
                Show Cartesian Basis (XYZ)
              </label>
            </div>
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showQuadray" checked />
                Show Quadray Basis (WXYZ)
                <!-- Quadray: 4 tetrahedral basis vectors pointing to cube vertices (1,1,1), (1,-1,-1), (-1,1,-1), (-1,-1,1) -->
              </label>
            </div>
            <div class="control-item">
              <label class="label-section">
                <span
                  class="geodesic-toggle collapsed"
                  data-target="cartesian-planes"
                ></span>
                Cartesian Planes
              </label>
              <div id="cartesian-planes" class="geodesic-options collapsed">
                <div class="plane-toggle-container">
                  <div class="plane-toggle-item">
                    <span class="plane-toggle-label">XY</span>
                    <div class="plane-toggle-switch" data-plane="XY">
                      <div class="plane-toggle-slider"></div>
                    </div>
                  </div>
                  <div class="plane-toggle-item">
                    <span class="plane-toggle-label">XZ</span>
                    <div class="plane-toggle-switch" data-plane="XZ">
                      <div class="plane-toggle-slider"></div>
                    </div>
                  </div>
                  <div class="plane-toggle-item">
                    <span class="plane-toggle-label">YZ</span>
                    <div class="plane-toggle-switch" data-plane="YZ">
                      <div class="plane-toggle-slider"></div>
                    </div>
                  </div>
                </div>
                <div class="spacing-top-large">
                  <label class="label-subsection">Grid Intervals</label>
                  <div class="slider-container">
                    <input
                      type="range"
                      id="cartesianTessSlider"
                      min="10"
                      max="100"
                      step="10"
                      value="10"
                    />
                    <span class="slider-value" id="cartesianTessValue">10</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="control-item">
              <label class="label-section">
                <span
                  class="geodesic-toggle collapsed"
                  data-target="ivm-grids"
                ></span>
                IVM Grids (Future Implementation)
              </label>
              <div id="ivm-grids" class="geodesic-options collapsed">
                <div class="plane-toggle-container">
                  <div class="plane-toggle-item">
                    <span class="plane-toggle-label">WX</span>
                    <div class="plane-toggle-switch" data-plane="quadrayWX">
                      <div class="plane-toggle-slider"></div>
                    </div>
                  </div>
                  <div class="plane-toggle-item">
                    <span class="plane-toggle-label">WY</span>
                    <div class="plane-toggle-switch" data-plane="quadrayWY">
                      <div class="plane-toggle-slider"></div>
                    </div>
                  </div>
                  <div class="plane-toggle-item">
                    <span class="plane-toggle-label">WZ</span>
                    <div class="plane-toggle-switch" data-plane="quadrayWZ">
                      <div class="plane-toggle-slider"></div>
                    </div>
                  </div>
                  <div class="plane-toggle-item">
                    <span class="plane-toggle-label">XY</span>
                    <div class="plane-toggle-switch" data-plane="quadrayXY">
                      <div class="plane-toggle-slider"></div>
                    </div>
                  </div>
                  <div class="plane-toggle-item">
                    <span class="plane-toggle-label">XZ</span>
                    <div class="plane-toggle-switch" data-plane="quadrayXZ">
                      <div class="plane-toggle-slider"></div>
                    </div>
                  </div>
                  <div class="plane-toggle-item">
                    <span class="plane-toggle-label">YZ</span>
                    <div class="plane-toggle-switch" data-plane="quadrayYZ">
                      <div class="plane-toggle-slider"></div>
                    </div>
                  </div>
                </div>
                <p class="info-text" style="font-size: 10px; margin-top: 5px">
                  IVM: Placeholder for TRUE IVM implementation - coplanar
                  tetrahedral faces (not yet implemented)
                </p>
              </div>
            </div>
            <div class="control-item">
              <label class="label-section">
                <span
                  class="geodesic-toggle"
                  data-target="central-angle-grids"
                ></span>
                Central Angle Grids (Corrected Tessellation)
              </label>
              <div id="central-angle-grids" class="geodesic-options">
                <div class="plane-toggle-container">
                  <div class="plane-toggle-item">
                    <span class="plane-toggle-label">WX</span>
                    <div class="plane-toggle-switch active" data-plane="ivmWX">
                      <div class="plane-toggle-slider"></div>
                    </div>
                  </div>
                  <div class="plane-toggle-item">
                    <span class="plane-toggle-label">WY</span>
                    <div class="plane-toggle-switch active" data-plane="ivmWY">
                      <div class="plane-toggle-slider"></div>
                    </div>
                  </div>
                  <div class="plane-toggle-item">
                    <span class="plane-toggle-label">WZ</span>
                    <div class="plane-toggle-switch active" data-plane="ivmWZ">
                      <div class="plane-toggle-slider"></div>
                    </div>
                  </div>
                  <div class="plane-toggle-item">
                    <span class="plane-toggle-label">XY</span>
                    <div class="plane-toggle-switch active" data-plane="ivmXY">
                      <div class="plane-toggle-slider"></div>
                    </div>
                  </div>
                  <div class="plane-toggle-item">
                    <span class="plane-toggle-label">XZ</span>
                    <div class="plane-toggle-switch active" data-plane="ivmXZ">
                      <div class="plane-toggle-slider"></div>
                    </div>
                  </div>
                  <div class="plane-toggle-item">
                    <span class="plane-toggle-label">YZ</span>
                    <div class="plane-toggle-switch active" data-plane="ivmYZ">
                      <div class="plane-toggle-slider"></div>
                    </div>
                  </div>
                </div>
                <div class="spacing-top-large">
                  <label class="label-subsection">Grid Intervals</label>
                  <div class="slider-container">
                    <input
                      type="range"
                      id="quadrayTessSlider"
                      min="12"
                      max="120"
                      step="12"
                      value="12"
                    />
                    <span class="slider-value" id="quadrayTessValue">12</span>
                  </div>
                </div>
                <p class="info-text spacing-top-small">
                  Central Angle: Triangular faces tessellated vertex-to-vertex
                  using tet edge length 2s√2 (corrected implementation without
                  bugs)
                </p>
              </div>
            </div>
          </div>
        </div>
        <!-- END SECTION 2: COORDINATE SYSTEMS -->

        <!-- ========================================
             SECTION 3: FORMS
             ======================================== -->
        <div class="control-group">
          <h3>
            <span class="section-toggle" data-target="forms-section"></span>
            Forms
          </h3>
          <div id="forms-section" class="section-content">
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showCube" checked />
                Hexahedron (Cube)
              </label>
            </div>

            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showTetrahedron" />
                Tetrahedron (Inscribed)
              </label>
              <div
                id="geodesic-tetra-all"
                class="geodesic-options geodesic-control-wrapper"
                style="display: none"
              >
                <div class="geodesic-nested">
                  <label class="checkbox-label">
                    <input type="checkbox" id="showGeodesicTetrahedron" />
                    Geodesic (Fuller)
                  </label>
                  <div class="geodesic-nested">
                    <div class="geodesic-frequency-container slider-container">
                      <label class="geodesic-frequency-label">Freq:</label>
                      <input
                        type="range"
                        id="geodesicTetraFrequency"
                        min="1"
                        max="7"
                        step="1"
                        value="1"
                      />
                      <span class="slider-value">1</span>
                    </div>
                    <div class="geodesic-projection-container">
                      <label class="geodesic-projection-label">Project:</label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicTetraProjection"
                          value="off"
                        />
                        Off (flat)
                      </label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicTetraProjection"
                          value="in"
                        />
                        InSphere
                      </label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicTetraProjection"
                          value="mid"
                        />
                        MidSphere
                      </label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicTetraProjection"
                          value="out"
                          checked
                        />
                        OutSphere
                      </label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showDualTetrahedron" checked />
                Tetrahedron Dual
              </label>
              <div
                id="geodesic-dual-tetra-all"
                class="geodesic-options geodesic-control-wrapper"
                style="display: none"
              >
                <div class="geodesic-nested">
                  <label class="checkbox-label">
                    <input type="checkbox" id="showGeodesicDualTetrahedron" />
                    Geodesic (Fuller)
                  </label>
                  <div class="geodesic-nested">
                    <div class="geodesic-frequency-container slider-container">
                      <label class="geodesic-frequency-label">Freq:</label>
                      <input
                        type="range"
                        id="geodesicDualTetraFrequency"
                        min="1"
                        max="7"
                        step="1"
                        value="1"
                      />
                      <span class="slider-value">1</span>
                    </div>
                    <div class="geodesic-projection-container">
                      <label class="geodesic-projection-label">Project:</label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicDualTetraProjection"
                          value="off"
                        />
                        Off (flat)
                      </label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicDualTetraProjection"
                          value="in"
                        />
                        InSphere
                      </label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicDualTetraProjection"
                          value="mid"
                        />
                        MidSphere
                      </label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicDualTetraProjection"
                          value="out"
                          checked
                        />
                        OutSphere
                      </label>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showOctahedron" />
                Octahedron (Dual of Cube)
              </label>
              <div
                id="geodesic-octa-all"
                class="geodesic-options geodesic-control-wrapper"
                style="display: none"
              >
                <div class="geodesic-nested">
                  <label class="checkbox-label">
                    <input type="checkbox" id="showGeodesicOctahedron" />
                    Geodesic (Fuller)
                  </label>
                  <div class="geodesic-nested">
                    <div class="geodesic-frequency-container slider-container">
                      <label class="geodesic-frequency-label">Freq:</label>
                      <input
                        type="range"
                        id="geodesicOctaFrequency"
                        min="1"
                        max="7"
                        step="1"
                        value="1"
                      />
                      <span class="slider-value">1</span>
                    </div>
                    <div class="geodesic-projection-container">
                      <label class="geodesic-projection-label">Project:</label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicOctaProjection"
                          value="off"
                        />
                        Off (flat)
                      </label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicOctaProjection"
                          value="in"
                        />
                        InSphere
                      </label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicOctaProjection"
                          value="mid"
                        />
                        MidSphere
                      </label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicOctaProjection"
                          value="out"
                          checked
                        />
                        OutSphere
                      </label>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showIcosahedron" />
                Icosahedron (20 faces, φ)
              </label>
              <div
                id="geodesic-icosa-all"
                class="geodesic-options geodesic-control-wrapper"
                style="display: none"
              >
                <div class="geodesic-nested">
                  <label class="checkbox-label">
                    <input type="checkbox" id="showGeodesicIcosahedron" />
                    Geodesic (Fuller)
                  </label>
                  <div class="geodesic-nested">
                    <div class="geodesic-frequency-container slider-container">
                      <label class="geodesic-frequency-label">Freq:</label>
                      <input
                        type="range"
                        id="geodesicIcosaFrequency"
                        min="1"
                        max="7"
                        step="1"
                        value="1"
                      />
                      <span class="slider-value">1</span>
                    </div>
                    <div class="geodesic-projection-container">
                      <label class="geodesic-projection-label">Project:</label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicIcosaProjection"
                          value="off"
                        />
                        Off (flat)
                      </label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicIcosaProjection"
                          value="in"
                        />
                        InSphere
                      </label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicIcosaProjection"
                          value="mid"
                        />
                        MidSphere
                      </label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicIcosaProjection"
                          value="out"
                          checked
                        />
                        OutSphere
                      </label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showDodecahedron" />
                Dodecahedron (12 faces, φ)
              </label>
            </div>
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showDualIcosahedron" />
                Icosahedron Dual (Face Dual)
              </label>
              <div
                id="geodesic-dual-icosa-all"
                class="geodesic-options geodesic-control-wrapper"
                style="display: none"
              >
                <div class="geodesic-nested">
                  <label class="checkbox-label">
                    <input type="checkbox" id="showGeodesicDualIcosahedron" />
                    Geodesic (Fuller)
                  </label>
                  <div class="geodesic-nested">
                    <div class="geodesic-frequency-container slider-container">
                      <label class="geodesic-frequency-label">Freq:</label>
                      <input
                        type="range"
                        id="geodesicDualIcosaFrequency"
                        min="1"
                        max="7"
                        step="1"
                        value="1"
                      />
                      <span class="slider-value">1</span>
                    </div>
                    <div class="geodesic-projection-container">
                      <label class="geodesic-projection-label">Project:</label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicDualIcosaProjection"
                          value="off"
                        />
                        Off (flat)
                      </label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicDualIcosaProjection"
                          value="in"
                        />
                        InSphere
                      </label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicDualIcosaProjection"
                          value="mid"
                        />
                        MidSphere
                      </label>
                      <label class="geodesic-projection-option">
                        <input
                          type="radio"
                          name="geodesicDualIcosaProjection"
                          value="out"
                          checked
                        />
                        OutSphere
                      </label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showCuboctahedron" />
                Cuboctahedron (VE)
              </label>
            </div>
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showRhombicDodecahedron" />
                Rhombic Dodecahedron
              </label>
            </div>

            <!-- ========== MATRICES ========== -->
            <div class="matrix-divider">
              <label class="matrix-divider-label">Matrices</label>
            </div>

            <!-- Hexahedral Matrix (IVM) -->
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showCubeMatrix" />
                Hexahedral Matrix (IVM)
              </label>
              <div
                id="cube-matrix-controls"
                class="geodesic-options matrix-control-wrapper"
                style="display: none"
              >
                <div class="matrix-control-item">
                  <label class="matrix-size-label">Matrix Size</label>
                  <div class="slider-container">
                    <input
                      type="range"
                      id="cubeMatrixSizeSlider"
                      min="1"
                      max="10"
                      step="1"
                      value="1"
                    />
                    <span class="slider-value" id="cubeMatrixSizeValue"
                      >1×1</span
                    >
                  </div>
                </div>
                <label class="checkbox-label matrix-checkbox-label">
                  <input type="checkbox" id="cubeMatrixRotate45" />
                  Rotate 45° (grid align)
                </label>
                <p class="matrix-info-text">N×N spatial array (spread = 0.5)</p>
              </div>
            </div>

            <!-- Tetrahedral Matrix (IVM) -->
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showTetMatrix" />
                Tetrahedral Matrix (IVM)
              </label>
              <div
                id="tet-matrix-controls"
                class="geodesic-options matrix-control-wrapper"
                style="display: none"
              >
                <div class="matrix-control-item">
                  <label class="matrix-size-label">Matrix Size</label>
                  <div class="slider-container">
                    <input
                      type="range"
                      id="tetMatrixSizeSlider"
                      min="1"
                      max="10"
                      step="1"
                      value="1"
                    />
                    <span class="slider-value" id="tetMatrixSizeValue"
                      >1×1</span
                    >
                  </div>
                </div>
                <label class="checkbox-label matrix-checkbox-label">
                  <input type="checkbox" id="tetMatrixRotate45" />
                  Rotate 45° (grid align)
                </label>
                <p class="matrix-info-text">
                  N×N tetrahedral array with alternating orientations
                </p>
              </div>
            </div>

            <!-- Octahedral Matrix (IVM) -->
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showOctaMatrix" />
                Octahedral Matrix (IVM)
              </label>
              <div
                id="octa-matrix-controls"
                class="geodesic-options matrix-control-wrapper"
                style="display: none"
              >
                <div class="matrix-control-item">
                  <label class="matrix-size-label">Matrix Size</label>
                  <div class="slider-container">
                    <input
                      type="range"
                      id="octaMatrixSizeSlider"
                      min="1"
                      max="10"
                      step="1"
                      value="1"
                    />
                    <span class="slider-value" id="octaMatrixSizeValue"
                      >1×1</span
                    >
                  </div>
                </div>
                <label class="checkbox-label matrix-checkbox-label">
                  <input type="checkbox" id="octaMatrixRotate45" />
                  Rotate 45° (grid align)
                </label>
                <label class="checkbox-label matrix-checkbox-label">
                  <input type="checkbox" id="octaMatrixColinearEdges" />
                  Colinear Edges (space-filling)
                </label>
                <p class="matrix-info-text">
                  N×N octahedral face-to-face array
                </p>
              </div>
            </div>

            <!-- Cuboctahedral Matrix (VE) -->
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showCuboctahedronMatrix" />
                Cuboctahedral Matrix (VE)
              </label>
              <div
                id="cubocta-matrix-controls"
                class="geodesic-options matrix-control-wrapper"
                style="display: none"
              >
                <div class="matrix-control-item">
                  <label class="matrix-size-label">Matrix Size</label>
                  <div class="slider-container">
                    <input
                      type="range"
                      id="cuboctaMatrixSizeSlider"
                      min="1"
                      max="10"
                      step="1"
                      value="1"
                    />
                    <span class="slider-value" id="cuboctaMatrixSizeValue"
                      >1×1</span
                    >
                  </div>
                </div>
                <label class="checkbox-label matrix-checkbox-label">
                  <input type="checkbox" id="cuboctaMatrixRotate45" />
                  Rotate 45° (grid align)
                </label>
                <p class="matrix-info-text">
                  N×N Vector Equilibrium space-filling array
                </p>
              </div>
            </div>

            <!-- Rhombic Dodecahedral Matrix -->
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showRhombicDodecMatrix" />
                Rhombic Dodecahedral Matrix
              </label>
              <div
                id="rhombic-dodec-matrix-controls"
                class="geodesic-options matrix-control-wrapper"
                style="display: none"
              >
                <div class="matrix-control-item">
                  <label class="matrix-size-label">Matrix Size</label>
                  <div class="slider-container">
                    <input
                      type="range"
                      id="rhombicDodecMatrixSizeSlider"
                      min="1"
                      max="10"
                      step="1"
                      value="1"
                    />
                    <span class="slider-value" id="rhombicDodecMatrixSizeValue"
                      >1×1</span
                    >
                  </div>
                </div>
                <label class="checkbox-label matrix-checkbox-label">
                  <input type="checkbox" id="rhombicDodecMatrixRotate45" />
                  Rotate 45° (grid align)
                </label>
                <label class="checkbox-label matrix-checkbox-label">
                  <input type="checkbox" id="rhombicDodecMatrixFaceCoplanar" />
                  Face Coplanarity (space-filling)
                </label>
                <p class="matrix-info-text">
                  N×N Rhombic Dodecahedron space-filling array
                </p>
              </div>
            </div>

            <!-- ========== RADIAL MATRICES ========== -->
            <div class="matrix-divider">
              <label class="matrix-divider-label">Radial Matrices</label>
            </div>

            <!-- Radial Cube Matrix -->
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showRadialCubeMatrix" />
                Cube (Radial)
              </label>
              <div
                id="radial-cube-matrix-controls"
                class="geodesic-options matrix-control-wrapper"
                style="display: none"
              >
                <div class="matrix-control-item">
                  <label class="matrix-size-label">Frequency</label>
                  <div class="slider-container">
                    <input
                      type="range"
                      id="radialCubeFreqSlider"
                      min="1"
                      max="5"
                      step="1"
                      value="1"
                    />
                    <span class="slider-value" id="radialCubeFreqDisplay"
                      >F1</span
                    >
                  </div>
                </div>
                <label class="checkbox-label matrix-checkbox-label">
                  <input type="checkbox" id="radialCubeSpaceFill" checked />
                  Space-filling
                </label>
                <p class="matrix-info-text">
                  Stellation: F2=7, F3=25 | Solid: F2=27, F3=125
                </p>
              </div>
            </div>

            <!-- Radial Rhombic Dodecahedron Matrix -->
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showRadialRhombicDodecMatrix" />
                Rhombic Dodec (Radial)
              </label>
              <div
                id="radial-rhombic-dodec-matrix-controls"
                class="geodesic-options matrix-control-wrapper"
                style="display: none"
              >
                <div class="matrix-control-item">
                  <label class="matrix-size-label">Frequency</label>
                  <div class="slider-container">
                    <input
                      type="range"
                      id="radialRhombicDodecFreqSlider"
                      min="1"
                      max="5"
                      step="1"
                      value="1"
                    />
                    <span class="slider-value" id="radialRhombicDodecFreqDisplay"
                      >F1</span
                    >
                  </div>
                </div>
                <!-- RD is inherently space-filling, no toggle needed -->
                <p class="matrix-info-text">
                  Radial FCC expansion: F1=1, F2=13, F3=55 polyhedra (always space-filling)
                </p>
              </div>
            </div>

            <!-- Radial Tetrahedron Matrix -->
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showRadialTetrahedronMatrix" />
                Tetrahedron (Radial)
              </label>
              <div
                id="radial-tetrahedron-matrix-controls"
                class="geodesic-options matrix-control-wrapper"
                style="display: none"
              >
                <div class="matrix-control-item">
                  <label class="matrix-size-label">Frequency</label>
                  <div class="slider-container">
                    <input
                      type="range"
                      id="radialTetFreqSlider"
                      min="1"
                      max="5"
                      step="1"
                      value="1"
                    />
                    <span class="slider-value" id="radialTetFreqDisplay"
                      >F1</span
                    >
                  </div>
                </div>
                <p class="matrix-info-text">
                  Stellation: F1=1, F2=5, F3=15 (alternating up/down)
                </p>
                <label class="checkbox-label matrix-checkbox-label">
                  <input type="checkbox" id="radialTetIVMMode" />
                  IVM Mode (fill oct voids)
                </label>
              </div>
            </div>

            <!-- Radial Octahedron Matrix -->
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showRadialOctahedronMatrix" />
                Octahedron (Radial)
              </label>
              <div
                id="radial-octahedron-matrix-controls"
                class="geodesic-options matrix-control-wrapper"
                style="display: none"
              >
                <div class="matrix-control-item">
                  <label class="matrix-size-label">Frequency</label>
                  <div class="slider-container">
                    <input
                      type="range"
                      id="radialOctFreqSlider"
                      min="1"
                      max="5"
                      step="1"
                      value="1"
                    />
                    <span class="slider-value" id="radialOctFreqDisplay"
                      >F1</span
                    >
                  </div>
                </div>
                <p class="matrix-info-text">
                  Vertex stellation: F1=1, F2=7, F3=25 (octahedral growth)
                </p>
                <label class="checkbox-label matrix-checkbox-label">
                  <input type="checkbox" id="radialOctIVMScale" />
                  IVM Scale (match tet faces)
                </label>
              </div>
            </div>

            <!-- Radial Cuboctahedron (VE) Matrix -->
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="showRadialCuboctahedronMatrix" />
                Cuboctahedron (Radial)
              </label>
              <div
                id="radial-cuboctahedron-matrix-controls"
                class="geodesic-options matrix-control-wrapper"
                style="display: none"
              >
                <div class="matrix-control-item">
                  <label class="matrix-size-label">Frequency</label>
                  <div class="slider-container">
                    <input
                      type="range"
                      id="radialVEFreqSlider"
                      min="1"
                      max="5"
                      step="1"
                      value="1"
                    />
                    <span class="slider-value" id="radialVEFreqDisplay"
                      >F1</span
                    >
                  </div>
                </div>
                <p class="matrix-info-text">
                  FCC packing: F1=1, F2=13, F3=55 (12 vertex directions)
                </p>
              </div>
            </div>
          </div>
        </div>
        <!-- END SECTION 3: FORMS -->

        <!-- ========================================
             SECTION 4: CONTROLS
             ======================================== -->
        <div class="control-group">
          <h3>
            <span
              class="section-toggle collapsed"
              data-target="controls-section"
            ></span>
            Controls
          </h3>
          <div id="controls-section" class="section-content collapsed">
            <!-- Tool Mode -->
            <div class="control-item">
              <label class="label-section">Tool Mode</label>
              <div class="toggle-btn-group">
                <button
                  class="toggle-btn variant-tool"
                  data-gumball-tool="move"
                >
                  Move
                </button>
                <button
                  class="toggle-btn variant-tool"
                  data-gumball-tool="scale"
                >
                  Scale
                </button>
                <button
                  class="toggle-btn variant-tool"
                  data-gumball-tool="rotate"
                >
                  Rotate
                </button>
              </div>
            </div>

            <!-- Grid Snapping -->
            <div class="control-item spacing-top-large">
              <label class="label-section">Grid Snapping</label>
              <div class="snap-toggle-container">
                <button
                  id="snapFree"
                  class="toggle-btn variant-snap active"
                  data-snap-mode="free"
                >
                  Free
                </button>
                <button
                  id="snapXYZ"
                  class="toggle-btn variant-snap"
                  data-snap-mode="xyz"
                >
                  XYZ
                </button>
                <button
                  id="snapWXYZ"
                  class="toggle-btn variant-snap"
                  data-snap-mode="wxyz"
                >
                  WXYZ
                </button>
              </div>
              <div class="snap-description">
                <strong>Free:</strong> No snapping (full precision)<br />
                <strong>XYZ:</strong> Snap to 0.1 Cartesian grid<br />
                <strong>WXYZ:</strong> Snap to √6/4 ≈ 0.612 Quadray grid
              </div>
            </div>

            <!-- NOW Button -->
            <div class="control-item spacing-top-large">
              <button id="nowButton" class="gumball-action-btn">🕐 NOW</button>
              <div class="now-counter">
                Deposited: <span id="nowCount">0</span>
              </div>
            </div>

            <!-- Cartesian Coordinates (XYZ) -->
            <div class="control-item spacing-top-large">
              <label class="label-section">XYZ Coordinates</label>
              <div class="coordinate-inputs">
                <div class="coord-container">
                  <label class="label-axis label-axis-x">X:</label>
                  <input
                    type="text"
                    id="coordX"
                    class="coord-input axis-x"
                    value="0.0000"
                  />
                </div>
                <div class="coord-container">
                  <label class="label-axis label-axis-y">Y:</label>
                  <input
                    type="text"
                    id="coordY"
                    class="coord-input axis-y"
                    value="0.0000"
                  />
                </div>
                <div class="coord-container">
                  <label class="label-axis label-axis-z">Z:</label>
                  <input
                    type="text"
                    id="coordZ"
                    class="coord-input axis-z"
                    value="0.0000"
                  />
                </div>
              </div>
            </div>

            <!-- Quadray Coordinates (WXYZ) -->
            <div class="control-item spacing-top-large">
              <label class="label-section">WXYZ Coordinates</label>
              <div class="coordinate-inputs">
                <div class="coord-container">
                  <label class="label-axis label-axis-w">W:</label>
                  <input
                    type="text"
                    id="coordW"
                    class="coord-input axis-w"
                    value="0.0000"
                  />
                </div>
                <div class="coord-container">
                  <label class="label-axis label-axis-x">X:</label>
                  <input
                    type="text"
                    id="coordX2"
                    class="coord-input axis-x"
                    value="0.0000"
                  />
                </div>
                <div class="coord-container">
                  <label class="label-axis label-axis-y">Y:</label>
                  <input
                    type="text"
                    id="coordY2"
                    class="coord-input axis-y"
                    value="0.0000"
                  />
                </div>
                <div class="coord-container">
                  <label class="label-axis label-axis-z">Z:</label>
                  <input
                    type="text"
                    id="coordZ2"
                    class="coord-input axis-z"
                    value="0.0000"
                  />
                </div>
              </div>
            </div>

            <!-- XYZ Rotation (Degrees °) -->
            <div class="control-item spacing-top-large">
              <label class="label-section">XYZ Rotation (°)</label>
              <div class="coordinate-inputs">
                <div class="coord-container">
                  <label class="label-axis label-axis-x">X:</label>
                  <input
                    type="text"
                    id="rotXDegrees"
                    class="coord-input axis-x"
                    value="0.00"
                  />
                </div>
                <div class="coord-container">
                  <label class="label-axis label-axis-y">Y:</label>
                  <input
                    type="text"
                    id="rotYDegrees"
                    class="coord-input axis-y"
                    value="0.00"
                  />
                </div>
                <div class="coord-container">
                  <label class="label-axis label-axis-z">Z:</label>
                  <input
                    type="text"
                    id="rotZDegrees"
                    class="coord-input axis-z"
                    value="0.00"
                  />
                </div>
              </div>
            </div>

            <!-- XYZ Rotation (Spread s) -->
            <div class="control-item spacing-top-small">
              <label class="label-section">XYZ Rotation (s)</label>
              <div class="coordinate-inputs">
                <div class="coord-container">
                  <label class="label-axis label-axis-x">X:</label>
                  <input
                    type="text"
                    id="rotXSpread"
                    class="coord-input axis-x"
                    value="0.00"
                  />
                </div>
                <div class="coord-container">
                  <label class="label-axis label-axis-y">Y:</label>
                  <input
                    type="text"
                    id="rotYSpread"
                    class="coord-input axis-y"
                    value="0.00"
                  />
                </div>
                <div class="coord-container">
                  <label class="label-axis label-axis-z">Z:</label>
                  <input
                    type="text"
                    id="rotZSpread"
                    class="coord-input axis-z"
                    value="0.00"
                  />
                </div>
              </div>
            </div>

            <!-- WXYZ Rotation (Degrees °) -->
            <div class="control-item spacing-top-small">
              <label class="label-section">WXYZ Rotation (°)</label>
              <div class="coordinate-inputs">
                <div class="coord-container">
                  <label class="label-axis label-axis-w">W:</label>
                  <input
                    type="text"
                    id="rotWDegrees"
                    class="coord-input axis-w"
                    value="0.00"
                  />
                </div>
                <div class="coord-container">
                  <label class="label-axis label-axis-x">X:</label>
                  <input
                    type="text"
                    id="rotXQDegrees"
                    class="coord-input axis-x"
                    value="0.00"
                  />
                </div>
                <div class="coord-container">
                  <label class="label-axis label-axis-y">Y:</label>
                  <input
                    type="text"
                    id="rotYQDegrees"
                    class="coord-input axis-y"
                    value="0.00"
                  />
                </div>
                <div class="coord-container">
                  <label class="label-axis label-axis-z">Z:</label>
                  <input
                    type="text"
                    id="rotZQDegrees"
                    class="coord-input axis-z"
                    value="0.00"
                  />
                </div>
              </div>
            </div>

            <!-- WXYZ Rotation (Spread s) -->
            <div class="control-item spacing-top-small">
              <label class="label-section">WXYZ Rotation (s)</label>
              <div class="coordinate-inputs">
                <div class="coord-container">
                  <label class="label-axis label-axis-w">W:</label>
                  <input
                    type="text"
                    id="rotWSpread"
                    class="coord-input axis-w"
                    value="0.00"
                  />
                </div>
                <div class="coord-container">
                  <label class="label-axis label-axis-x">X:</label>
                  <input
                    type="text"
                    id="rotXQSpread"
                    class="coord-input axis-x"
                    value="0.00"
                  />
                </div>
                <div class="coord-container">
                  <label class="label-axis label-axis-y">Y:</label>
                  <input
                    type="text"
                    id="rotYQSpread"
                    class="coord-input axis-y"
                    value="0.00"
                  />
                </div>
                <div class="coord-container">
                  <label class="label-axis label-axis-z">Z:</label>
                  <input
                    type="text"
                    id="rotZQSpread"
                    class="coord-input axis-z"
                    value="0.00"
                  />
                </div>
              </div>
              <p class="info-text spacing-top-small">
                s = sin²(θ), bounded 0.00-1.00
              </p>
            </div>
          </div>
        </div>
        <!-- END SECTION 4: CONTROLS -->

        <!-- ========================================
             SECTION 5: SCALE
             ======================================== -->
        <div class="control-group">
          <h3>
            <span
              class="section-toggle collapsed"
              data-target="scale-section"
            ></span>
            Scale
          </h3>
          <div id="scale-section" class="section-content collapsed">
            <div class="control-item">
              <label>Cube Edge Length</label>
              <div class="slider-container">
                <input
                  type="range"
                  id="scaleSlider"
                  min="0.5"
                  max="3.6"
                  step="0.1"
                  value="1.4"
                />
                <span class="slider-value" id="scaleValue">1.4142</span>
              </div>
            </div>
            <div class="control-item">
              <label>Tetrahedron Edge Length</label>
              <div class="slider-container">
                <input
                  type="range"
                  id="tetScaleSlider"
                  min="0.7"
                  max="5.0"
                  step="0.1"
                  value="2.0"
                />
                <span class="slider-value" id="tetScaleValue">2.0000</span>
              </div>
            </div>
            <p class="info-text" style="font-size: 10px; margin-top: 5px">
              Linked sliders: rational units follow whichever you adjust
            </p>
          </div>
        </div>
        <!-- END SECTION 5: SCALE -->

        <!-- ========================================
             SECTION 6: VISUAL OPTIONS
             ======================================== -->
        <div class="control-group">
          <h3>
            <span
              class="section-toggle collapsed"
              data-target="visual-options-section"
            ></span>
            Visual Options
          </h3>
          <div id="visual-options-section" class="section-content collapsed">
            <div class="control-item">
              <label
                style="
                  font-size: 12px;
                  margin-bottom: 5px;
                  display: block;
                  color: #b0b0b0;
                "
                >Nodes</label
              >
              <div class="node-size-selector">
                <button class="node-size-btn" data-node-size="off">Off</button>
                <button class="node-size-btn" data-node-size="sm">Sm</button>
                <button class="node-size-btn active" data-node-size="md">
                  Md
                </button>
                <button class="node-size-btn" data-node-size="lg">Lg</button>
                <button
                  class="node-size-btn"
                  data-node-size="packed"
                  title="Close-packed spheres: r = a/2 (kissing number)"
                >
                  Packed
                </button>
              </div>
            </div>
            <div class="control-item spacing-top-medium">
              <label class="label-section">Node Geometry</label>
              <div class="toggle-btn-group">
                <button
                  class="toggle-btn variant-toggle"
                  id="nodeGeomClassical"
                  data-node-geom="classical"
                >
                  Classical Spheres
                </button>
                <select
                  class="toggle-btn variant-toggle geodesic-dropdown active"
                  id="nodeGeomRT"
                >
                  <option value="1">1f Geodesic</option>
                  <option value="2">2f Geodesic</option>
                  <option value="3" selected>3f Geodesic</option>
                  <option value="4">4f Geodesic</option>
                </select>
              </div>
              <p class="info-text" style="font-size: 10px; margin-top: 5px">
                Toggle between THREE.js spheres and RT-computed geodesic nodes
                for performance comparison
              </p>
            </div>
            <div class="control-item spacing-top-small">
              <label class="checkbox-label">
                <input type="checkbox" id="nodeFlatShading" />
                Faceted Nodes (show geometry)
              </label>
              <p class="info-text" style="font-size: 10px; margin-top: 3px">
                Show faceted geometry vs smooth "sphere" shading
              </p>
            </div>
            <div class="control-item">
              <label>Face Opacity</label>
              <div class="slider-container">
                <input
                  type="range"
                  id="opacitySlider"
                  min="0"
                  max="1"
                  step="0.05"
                  value="0.35"
                />
                <span class="slider-value" id="opacityValue">0.35</span>
              </div>
            </div>
            <div class="control-item">
              <label>Node Opacity</label>
              <div class="slider-container">
                <input
                  type="range"
                  id="nodeOpacitySlider"
                  min="0"
                  max="1"
                  step="0.05"
                  value="0.60"
                />
                <span class="slider-value" id="nodeOpacityValue">0.60</span>
              </div>
            </div>
          </div>
        </div>
        <!-- END SECTION 6: VISUAL OPTIONS -->

        <!-- ========================================
             SECTION 7: CAMERA
             ======================================== -->
        <div class="control-group">
          <h3>
            <span
              class="section-toggle collapsed"
              data-target="view-section"
            ></span>
            Camera
          </h3>
          <div id="view-section" class="section-content collapsed">
            <div class="control-item">
              <label class="label-section">XYZ Cartesian Views</label>
              <div class="button-grid-2col">
                <button class="toggle-btn variant-standard" id="viewTop">
                  Top
                </button>
                <button class="toggle-btn variant-standard" id="viewBottom">
                  Bottom
                </button>
                <button class="toggle-btn variant-standard" id="viewLeft">
                  Left
                </button>
                <button class="toggle-btn variant-standard" id="viewRight">
                  Right
                </button>
                <button class="toggle-btn variant-standard" id="viewFront">
                  Front
                </button>
                <button class="toggle-btn variant-standard" id="viewBack">
                  Back
                </button>
                <button class="toggle-btn variant-standard" id="viewAxo">
                  Axo
                </button>
                <button
                  class="toggle-btn variant-standard"
                  id="viewPerspective"
                >
                  Perspective
                </button>
                <button id="resetCamera">Reset</button>
              </div>
            </div>

            <!-- WXYZ Tetrahedral Basis Views -->
            <div class="control-item spacing-top-large">
              <hr
                style="border: none; border-top: 1px solid #444; margin: 20px 0"
              />
              <label class="label-section">WXYZ Tetrahedral Views</label>
              <div class="button-grid-2col">
                <button class="toggle-btn variant-standard" id="viewW">
                  W View
                </button>
                <button class="toggle-btn variant-standard" id="viewX">
                  X View
                </button>
                <button class="toggle-btn variant-standard" id="viewY">
                  Y View
                </button>
                <button class="toggle-btn variant-standard" id="viewZ">
                  Z View
                </button>
              </div>
            </div>

            <!-- Camera Projection Controls -->
            <div class="control-item spacing-top-large">
              <label class="checkbox-label">
                <input type="checkbox" id="orthoPerspective" />
                Orthographic (Plan/Elevation)
              </label>
            </div>
            <p class="info-text">
              Switch between standard views and projection types
            </p>
          </div>
        </div>
        <!-- END SECTION 7: CAMERA -->

        <!-- ========================================
             SECTION 8: PAPERCUT
             ======================================== -->
        <div class="control-group">
          <h3>
            <span
              class="section-toggle collapsed"
              data-target="papercut-section"
            ></span>
            Papercut
          </h3>
          <div id="papercut-section" class="section-content collapsed">
            <div class="control-item">
              <label style="font-size: 12px; color: #b0b0b0">Line Weight</label>
              <div class="slider-container">
                <input type="range" id="lineWeight" min="1" max="5" value="1" />
                <span class="slider-value" id="lineWeightValue">1</span>
              </div>
            </div>
            <div class="control-item">
              <label
                class="checkbox-label"
                title="Hide back-facing polygons for better performance (~2x faster). All geometry is correctly wound."
              >
                <input type="checkbox" id="backfaceCulling" checked />
                Backface Culling
              </label>
            </div>
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="enablePrintMode" />
                Print Mode (B&amp;W)
              </label>
            </div>
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="enableCutPlane" />
                Enable Cut Plane
              </label>
            </div>
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="invertCutPlane" />
                Invert Cut Plane
              </label>
            </div>
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="intervalSnapXYZ" checked />
                XYZ Interval Snap
              </label>
            </div>
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="intervalSnapWXYZ" />
                WXYZ Interval Snap
              </label>
            </div>
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="sectionNodes" />
                Section Nodes
              </label>
            </div>
            <div class="control-item">
              <label class="checkbox-label">
                <input type="checkbox" id="adaptiveNodeResolution" />
                High Resolution Nodes
              </label>
            </div>
            <!-- Axial Cutplane Selections -->
            <div class="control-item spacing-top-large">
              <hr
                style="border: none; border-top: 1px solid #444; margin: 20px 0"
              />
              <label class="label-section">Axial Cutplane Selections</label>
              <label class="label-subsection">Cartesian Basis</label>
              <div style="display: flex; gap: 4px; margin-bottom: 8px">
                <button class="toggle-btn variant-small" id="cutplaneAxisX">
                  X
                </button>
                <button class="toggle-btn variant-small" id="cutplaneAxisY">
                  Y
                </button>
                <button
                  class="toggle-btn variant-small active"
                  id="cutplaneAxisZ"
                >
                  Z
                </button>
              </div>
              <label class="label-subsection">Tetrahedral Basis</label>
              <div style="display: flex; gap: 4px">
                <button class="toggle-btn variant-small" id="cutplaneAxisW">
                  W
                </button>
                <button
                  class="toggle-btn variant-small"
                  id="cutplaneAxisTetraX"
                >
                  X
                </button>
                <button
                  class="toggle-btn variant-small"
                  id="cutplaneAxisTetraY"
                >
                  Y
                </button>
                <button
                  class="toggle-btn variant-small"
                  id="cutplaneAxisTetraZ"
                >
                  Z
                </button>
              </div>
            </div>
            <div class="control-item">
              <label class="label-section">Print Extents</label>
              <div class="button-grid-2col">
                <button class="toggle-btn variant-standard" id="fitA4" disabled>
                  A4
                </button>
                <button
                  class="toggle-btn variant-standard"
                  id="fitLetter"
                  disabled
                >
                  Letter
                </button>
                <button class="toggle-btn variant-standard" id="fitA3" disabled>
                  A3
                </button>
                <button
                  class="toggle-btn variant-standard"
                  id="fitCustom"
                  disabled
                >
                  Custom
                </button>
              </div>
            </div>
            <p class="info-text">Print optimization tools - Coming soon</p>
          </div>
        </div>
        <!-- END SECTION 8: PAPERCUT -->

        <!-- ========================================
             SECTION 9: GEOMETRY INFO
             ======================================== -->
        <div class="control-group">
          <h3>
            <span
              class="section-toggle"
              data-target="geometry-info-section"
            ></span>
            Geometry Info
          </h3>
          <div id="geometry-info-section" class="section-content">
            <div class="stats" id="geometryStats">
              <div><strong>Scene Totals:</strong></div>
              <div id="totalVertices">Vertices: --</div>
              <div id="totalEdges">Edges: --</div>
              <div id="totalFaces">Faces: --</div>
              <div id="totalTriangles">Triangles: --</div>
            </div>

            <div class="stats" id="performanceStats" style="margin-top: 12px">
              <div><strong>Performance:</strong></div>
              <div id="perfCalcTime">Calculation: -- ms</div>
              <div id="perfNodeTime">Node Gen: -- ms</div>
              <div id="perfFPS">FPS: --</div>
              <div id="perfNodeType">Node Type: Classical</div>
              <div id="perfNodeTriangles">Node Δ: --</div>
            </div>

            <p class="info-text" style="font-size: 10px; margin-top: 10px">
              Performance metrics compare RT algebraic methods vs classical
              trigonometry
            </p>

            <div
              style="
                margin-top: 15px;
                padding-top: 12px;
                border-top: 1px solid #444;
              "
            >
              <p style="font-size: 10px; color: #888; margin-bottom: 6px">
                <strong style="color: #7ab8ff">Interactive Math Demos:</strong>
              </p>
              <ul
                style="
                  font-size: 10px;
                  color: #7ab8ff;
                  margin-left: 15px;
                  line-height: 1.6;
                "
              >
                <li>
                  <a
                    href="#"
                    id="open-quadrance-demo"
                    style="color: #7ab8ff; text-decoration: none"
                  >
                    Quadrance
                  </a>
                  <span style="color: #888"> - rational distance</span>
                </li>
                <li>
                  <a
                    href="#"
                    id="open-cross-demo"
                    style="color: #7ab8ff; text-decoration: none"
                  >
                    Cross Product
                  </a>
                  <span style="color: #888">
                    - vector relationships & spread</span
                  >
                </li>
                <li>
                  <a
                    href="#"
                    id="open-weierstrass-demo"
                    style="color: #7ab8ff; text-decoration: none"
                  >
                    Weierstrass
                  </a>
                  <span style="color: #888"> - circle parametrization</span>
                </li>
                <li>
                  <a
                    href="#"
                    id="open-color-theory-modal"
                    style="color: #7ab8ff; text-decoration: none"
                  >
                    Color Theory
                  </a>
                  <span style="color: #888">
                    - backface culling calibration</span
                  >
                </li>
              </ul>
              <p
                class="info-text"
                style="font-size: 9px; margin-top: 6px; font-style: italic"
              >
                Explore the rational trigonometry foundations used for WXYZ and
                XYZ rotations
              </p>
            </div>
          </div>
        </div>
        <!-- END SECTION 9: GEOMETRY INFO -->
      </div>
    </div>

    <!-- ========================================
         DEMO MODALS
         ======================================== -->

    <!-- Quadrance Demo Modal -->
    <div id="quadrance-modal" class="demo-modal">
      <div class="demo-modal-content">
        <div class="demo-modal-body">
          <div id="quadrance-demo-container" class="demo-container"></div>
        </div>
      </div>
    </div>

    <!-- Cross Product Demo Modal -->
    <div id="cross-modal" class="demo-modal">
      <div class="demo-modal-content">
        <div class="demo-modal-body">
          <div id="cross-demo-container" class="demo-container"></div>
        </div>
      </div>
    </div>

    <!-- Weierstrass Demo Modal -->
    <div id="weierstrass-modal" class="demo-modal">
      <div class="demo-modal-content">
        <div class="demo-modal-body">
          <div id="weierstrass-demo-container" class="demo-container"></div>
        </div>
      </div>
    </div>

    <!-- Three.js ES Modules via importmap (no build step required) -->
    <script type="importmap">
      {
        "imports": {
          "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
          "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
        }
      }
    </script>

    <!-- Application Initialization -->
    <script type="module" src="modules/rt-init.js"></script>
  </body>
</html>
