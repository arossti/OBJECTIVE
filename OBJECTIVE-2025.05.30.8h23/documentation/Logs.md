 ✅ Section 04 module loaded: Firefighting & Life Safety Systems
 OBC StateManager: Initializing...
 OBC StateManager: No saved state found, starting fresh
 Section 01 rendered - Building Information (OBC Matrix)
 Initializing Section 01 event handlers
 Section 02 rendered - Building Occupancy (OBC Matrix)
 Initializing Section 02 event handlers
 OBC StateManager: Initializing global input handlers...
 OBC StateManager: Initialized handlers for 69 editable fields
 Initializing Section 04: Firefighting & Life Safety Systems
 OBC StateManager: Initializing global input handlers...
 OBC StateManager: Initialized handlers for 70 editable fields
 ✅ Section 04 initialized with global input handling
 Section 04 rendered - Firefighting & Life Safety Systems
 Initializing Section 05 event handlers
 OBC StateManager: Initializing global input handlers...
 OBC StateManager: Initialized handlers for 75 editable fields
 Section 05 rendered
 Initializing Section 05 event handlers
 OBC StateManager: Initializing global input handlers...
 OBC StateManager: Initialized handlers for 75 editable fields
 Initializing Section 06 event handlers
 OBC StateManager: Initializing global input handlers...
 OBC StateManager: Initialized handlers for 96 editable fields
 Section 06 rendered
 Initializing Section 06 event handlers
 OBC StateManager: Initializing global input handlers...
 OBC StateManager: Initialized handlers for 96 editable fields
 Initializing Section 07 event handlers
 OBC StateManager: Initializing global input handlers...
 OBC StateManager: Initialized handlers for 111 editable fields
 Section 07 rendered
OBC-Section07.js:493 Initializing Section 07 event handlers
OBC-StateManager.js:500 OBC StateManager: Initializing global input handlers...
OBC-StateManager.js:541 OBC StateManager: Initialized handlers for 111 editable fields
OBC-Section08.js:412 Initializing Section 08 event handlers
OBC-StateManager.js:500 OBC StateManager: Initializing global input handlers...
OBC-StateManager.js:541 OBC StateManager: Initialized handlers for 134 editable fields
OBC-Section08.js:420 Section 08 rendered
OBC-Section08.js:412 Initializing Section 08 event handlers
OBC-StateManager.js:500 OBC StateManager: Initializing global input handlers...
OBC-StateManager.js:541 OBC StateManager: Initialized handlers for 134 editable fields
OBC-Section09.js:375 Initializing Section 09 event handlers
OBC-StateManager.js:500 OBC StateManager: Initializing global input handlers...
OBC-StateManager.js:541 OBC StateManager: Initialized handlers for 146 editable fields
OBC-Section09.js:383 Section 09 rendered
OBC-Section09.js:375 Initializing Section 09 event handlers
OBC-StateManager.js:500 OBC StateManager: Initializing global input handlers...
OBC-StateManager.js:541 OBC StateManager: Initialized handlers for 146 editable fields
OBC-Section10.js:231 Initializing Section 10 event handlers
OBC-StateManager.js:500 OBC StateManager: Initializing global input handlers...
OBC-StateManager.js:541 OBC StateManager: Initialized handlers for 149 editable fields
OBC-Section10.js:239 Section 10 rendered
OBC-Section10.js:231 Initializing Section 10 event handlers
OBC-StateManager.js:500 OBC StateManager: Initializing global input handlers...
OBC-StateManager.js:541 OBC StateManager: Initialized handlers for 149 editable fields
 Core TEUI modules (FieldManager) not found!
(anonymous) @ OBC-Navigation.js:933Understand this errorAI
 Initializing Section 04: Firefighting & Life Safety Systems
 OBC StateManager: Initializing global input handlers...
 OBC StateManager: Initialized handlers for 149 editable fields
 ✅ Section 04 initialized with global input handling
 Section 01 rendered - Building Information (OBC Matrix)
 Section 02 rendered - Building Occupancy (OBC Matrix)
 OBC StateManager: Initializing global input handlers...
 OBC StateManager: Initialized handlers for 149 editable fields
 Initializing Section 04: Firefighting & Life Safety Systems
 OBC StateManager: Initializing global input handlers...
 OBC StateManager: Initialized handlers for 149 editable fields
 ✅ Section 04 initialized with global input handling
 Section 04 rendered - Firefighting & Life Safety Systems
 Initializing Section 05 event handlers
 OBC StateManager: Initializing global input handlers...
 OBC StateManager: Initialized handlers for 149 editable fields
 Section 05 rendered
 Initializing Section 05 event handlers
 OBC StateManager: Initializing global input handlers...
 OBC StateManager: Initialized handlers for 149 editable fields
 Initializing Section 06 event handlers
 OBC StateManager: Initializing global input handlers...
 OBC StateManager: Initialized handlers for 149 editable fields
 Section 06 rendered
 Initializing Section 06 event handlers
 OBC StateManager: Initializing global input handlers...
 OBC StateManager: Initialized handlers for 149 editable fields
 Initializing Section 07 event handlers
 OBC StateManager: Initializing global input handlers...
 OBC StateManager: Initialized handlers for 149 editable fields
 Section 07 rendered
 Initializing Section 07 event handlers
 OBC StateManager: Initializing global input handlers...
 OBC StateManager: Initialized handlers for 149 editable fields
 Initializing Section 08 event handlers
 OBC StateManager: Initializing global input handlers...
OBC-StateManager.js:541 OBC StateManager: Initialized handlers for 149 editable fields
OBC-Section08.js:420 Section 08 rendered
OBC-Section08.js:412 Initializing Section 08 event handlers
OBC-StateManager.js:500 OBC StateManager: Initializing global input handlers...
OBC-StateManager.js:541 OBC StateManager: Initialized handlers for 149 editable fields
OBC-Section09.js:375 Initializing Section 09 event handlers
OBC-StateManager.js:500 OBC StateManager: Initializing global input handlers...
OBC-StateManager.js:541 OBC StateManager: Initialized handlers for 149 editable fields
OBC-Section09.js:383 Section 09 rendered
OBC-Section09.js:375 Initializing Section 09 event handlers
OBC-StateManager.js:500 OBC StateManager: Initializing global input handlers...
OBC-StateManager.js:541 OBC StateManager: Initialized handlers for 149 editable fields
OBC-Section10.js:231 Initializing Section 10 event handlers
OBC-StateManager.js:500 OBC StateManager: Initializing global input handlers...
OBC-StateManager.js:541 OBC StateManager: Initialized handlers for 149 editable fields
OBC-Section10.js:239 Section 10 rendered
OBC-Section10.js:231 Initializing Section 10 event handlers
OBC-StateManager.js:500 OBC StateManager: Initializing global input handlers...
OBC-StateManager.js:541 OBC StateManager: Initialized handlers for 149 editable fields
indexobc.html:540 OBC Matrix FieldManager initialized
OBC-StateManager.js:137 OBC StateManager: Initializing...
OBC-StateManager.js:145 OBC StateManager: No saved state found, starting fresh
indexobc.html:548 OBC StateManager initialized with auto-restore from localStorage
indexobc.html:556 OBC Matrix initialization complete
indexobc.html:589 Initializing notes panel...
indexobc.html:595 Found elements: {notesToggleBtn: button#notes-toggle-btn.btn.btn-sm.btn-link.text-white.me-2.d-flex.align-items-center.justify-conte…, closeNotesBtn: button#close-notes-panel.btn.btn-sm.btn-outline-secondary, notesPanel: div#global-notes-panel.notes-panel, notesTextarea: textarea#global-notes-textarea.form-control}
indexobc.html:622 Added click listener to notes toggle button

// 🚨 CRITICAL DIAGNOSTIC: Test OBJECTIVE State Loss Issue
// Run this in OBJECTIVE Calculator after returning from OBC Matrix

function debugOBJECTIVEStateLoss() {
  console.log("🔍 OBJECTIVE STATE LOSS DIAGNOSTIC");
  console.log("=====================================");
  
  // 1. Check localStorage directly
  const saved = localStorage.getItem('TEUI_Calculator_State');
  console.log("1. localStorage check:", saved ? "✅ State exists" : "❌ No state found");
  
  if (saved) {
    const parsedState = JSON.parse(saved);
    const savedFieldIds = Object.keys(parsedState);
    console.log(`   - Saved field count: ${savedFieldIds.length}`);
    console.log(`   - Sample fields: ${savedFieldIds.slice(0, 5).join(', ')}`);
    
    // Check a few specific fields that should be user-modified
    const testFields = ['h_15', 'h_13', 'd_12', 'i_16'];
    testFields.forEach(fieldId => {
      if (parsedState[fieldId]) {
        console.log(`   - ${fieldId}: "${parsedState[fieldId].value}" (${parsedState[fieldId].state})`);
      }
    });
  }
  
  // 2. Check StateManager internal state
  if (window.TEUI?.StateManager) {
    const debugInfo = TEUI.StateManager.getDebugInfo();
    console.log(`2. StateManager field count: ${debugInfo.fieldCount}`);
    
    const testFields = ['h_15', 'h_13', 'd_12', 'i_16'];
    testFields.forEach(fieldId => {
      const value = TEUI.StateManager.getValue(fieldId);
      const state = TEUI.StateManager.getDebugInfo(fieldId);
      console.log(`   - ${fieldId}: "${value}" (${state?.state || 'unknown'})`);
    });
  }
  
  // 3. Check actual DOM elements
  console.log("3. DOM element check:");
  const testFields = ['h_15', 'h_13', 'd_12', 'i_16'];
  testFields.forEach(fieldId => {
    const element = document.querySelector(`[data-field-id="${fieldId}"]`);
    if (element) {
      const domValue = element.tagName === 'SELECT' ? element.value : 
                      element.tagName === 'INPUT' ? element.value : 
                      element.textContent;
      console.log(`   - ${fieldId}: DOM shows "${domValue}"`);
    } else {
      console.log(`   - ${fieldId}: ❌ DOM element not found`);
    }
  });
  
  // 4. Test if Calculator is overwriting values
  console.log("4. Calculator impact test:");
  console.log("   - About to trigger calculateAll()...");
  
  // Store values before calculation
  const beforeCalc = {};
  testFields.forEach(fieldId => {
    beforeCalc[fieldId] = TEUI.StateManager.getValue(fieldId);
  });
  
  // Run calculation
  if (window.TEUI?.Calculator?.calculateAll) {
    TEUI.Calculator.calculateAll();
    
    // Check values after calculation
    console.log("   - After calculateAll():");
    testFields.forEach(fieldId => {
      const afterValue = TEUI.StateManager.getValue(fieldId);
      const changed = beforeCalc[fieldId] !== afterValue;
      console.log(`     - ${fieldId}: "${beforeCalc[fieldId]}" → "${afterValue}" ${changed ? '❌ CHANGED' : '✅ preserved'}`);
    });
  }
  
  console.log("=====================================");
}

// Run the diagnostic
debugOBJECTIVEStateLoss();