<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OBC Matrix</title>
    <meta
      name="description"
      content="Ontario Building Code Data Matrix - Interactive Form"
    />

    <!-- CSS Resources -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <!-- Direct style override for select elements -->
    <style>
      select,
      option,
      .form-select,
      select.form-select {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif !important;
        /* Force sans-serif as fallback */
        font-family: sans-serif !important;
      }
    </style>

    <link href="OBC-styles.css" rel="stylesheet" />

    <!-- Core Dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- App-specific scripts -->
    <script src="OBC-FileHandler.js"></script>
    <script src="OBC-MatrixData.js"></script>
    <script src="OBC-init.js"></script>
  </head>
  <body>
    <!-- Main container -->
    <div class="col-lg-12 mx-auto p-4 py-md-5">
      <!-- Header -->
      <header class="d-flex align-items-center pb-3 mb-4 border-bottom">
        <a
          href="https://openbuilding.ca"
          class="text-dark text-decoration-none"
        >
          <svg width="180" height="60" viewBox="0 0 180 60" xmlns="http://www.w3.org/2000/svg" class="logo">
            <rect width="180" height="60" fill="#f8f9fa" />
            <text x="15" y="35" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#0066cc">OBJECTIVE</text>
            <text x="15" y="50" font-family="Arial, sans-serif" font-size="14" fill="#666">Open Building</text>
          </svg>
        </a>
        <div class="ms-auto text-end">
          <h1 class="mb-0 fs-4">
            Ontario Building Code Data Matrix<br />
            Interactive Form | 2024 OBC
          </h1>
        </div>
      </header>

      <!-- Action buttons row -->
      <div class="row button-row mb-2">
        <div class="col-12 d-flex justify-content-between align-items-center">
          <div class="d-flex align-items-center">
            <span class="toggle-label part3 me-2 active">Part 3 (Large Buildings)</span>
            <label class="toggle-switch mx-2">
              <input type="checkbox" id="part-toggle">
              <span class="toggle-slider"></span>
            </label>
            <span class="toggle-label part9 ms-2">Part 9 (Housing & Small Buildings)</span>
          </div>
          
          <div class="d-flex align-items-center">
            <button
              id="disclaimerBtn"
              class="btn btn-sm btn-warning me-2"
              data-bs-toggle="modal"
              data-bs-target="#disclaimerModal"
            >
              <i class="bi bi-info-circle"></i> Instructions
            </button>
            <button
              id="reset-form-btn"
              type="button"
              class="btn btn-sm btn-success me-2"
            >
              <i class="bi bi-arrow-clockwise"></i> Reset
            </button>
            <div class="btn-group">
              <button
                id="import-export-btn"
                type="button"
                class="btn btn-sm btn-primary"
              >
                <i class="bi bi-upload"></i> Import/Export
              </button>
              <!-- Dropdown Toggle -->
              <button
                class="btn btn-sm btn-primary dropdown-toggle dropdown-toggle-split"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <span class="visually-hidden">Toggle Dropdown</span>
              </button>
              <!-- Dropdown Menu -->
              <ul class="dropdown-menu dropdown-menu-end">
                <li>
                  <a class="dropdown-item" href="#" id="import-data-btn"
                    ><i class="bi bi-upload me-2"></i>Import Data (Excel/CSV)</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" href="#" id="export-data-btn"
                    ><i class="bi bi-save me-2"></i>Export Data (CSV)</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <a class="dropdown-item" href="#" id="downloadPdf"
                    >Download PDF Form</a
                  >
                </li>
              </ul>
            </div>
          </div>
        </div>
        <!-- Hidden File Input for Import -->
        <input
          type="file"
          id="excel-file-input"
          accept=".xlsx, .xls, .csv"
          style="display: none"
        />
      </div>

      <!-- App wrapper -->
      <div id="app-wrapper">
        <!-- OBC Matrix container -->
        <div id="obc-container">
          <!-- Header information section -->
          <div id="buildingInfo" class="section">
            <div class="section-header">
              <span class="section-icon"><i class="bi bi-building"></i></span>
              Building Information
            </div>
            <div class="section-content">
              <div id="building-info-content">
                <table class="data-table">
                  <colgroup>
                    <col class="col-a" />
                    <col class="col-b" />
                    <col class="col-c" />
                    <col class="col-d" />
                    <col class="col-e" />
                    <col class="col-f" />
                    <col class="col-g" />
                    <col class="col-h" />
                    <col class="col-i" />
                    <col class="col-j" />
                    <col class="col-k" />
                    <col class="col-l" />
                    <col class="col-m" />
                  </colgroup>
                  <tr>
                    <td class="col-c">Name of Practice</td>
                    <td class="col-d user-input" contenteditable="true" data-placeholder="Enter practice name">Thomson Architecture, Inc.</td>
                    <td class="col-e"></td>
                    <td class="col-f"></td>
                    <td class="col-g"></td>
                    <td class="col-h"></td>
                    <td class="col-i"></td>
                    <td class="col-j"></td>
                    <td class="col-k"></td>
                    <td class="col-l"></td>
                    <td class="col-m">Notes:</td>
                  </tr>
                  <tr>
                    <td class="col-c">Address 1</td>
                    <td class="col-d user-input" contenteditable="true" data-placeholder="Enter address line 1">1017 Dominion Road</td>
                    <td class="col-e"></td>
                    <td class="col-f"></td>
                    <td class="col-g"></td>
                    <td class="col-h"></td>
                    <td class="col-i"></td>
                    <td class="col-j"></td>
                    <td class="col-k"></td>
                    <td class="col-l"></td>
                    <td class="col-m user-input" contenteditable="true" data-placeholder="Enter notes">Make input...</td>
                  </tr>
                  <tr>
                    <td class="col-c">Address 2</td>
                    <td class="col-d user-input" contenteditable="true" data-placeholder="Enter address line 2">Algonquin Highlands, ON. KOM 1S0</td>
                    <td class="col-e"></td>
                    <td class="col-f"></td>
                    <td class="col-g"></td>
                    <td class="col-h"></td>
                    <td class="col-i"></td>
                    <td class="col-j"></td>
                    <td class="col-k"></td>
                    <td class="col-l"></td>
                    <td class="col-m user-input" contenteditable="true" data-placeholder="Enter notes"></td>
                  </tr>
                  <tr>
                    <td class="col-c">Contact</td>
                    <td class="col-d user-input" contenteditable="true" data-placeholder="Enter contact name">Andy Thomson, M.Arch, OAA</td>
                    <td class="col-e"></td>
                    <td class="col-f"></td>
                    <td class="col-g"></td>
                    <td class="col-h"></td>
                    <td class="col-i"></td>
                    <td class="col-j"></td>
                    <td class="col-k"></td>
                    <td class="col-l"></td>
                    <td class="col-m user-input" contenteditable="true" data-placeholder="Enter notes"></td>
                  </tr>
                  <tr>
                    <td class="col-c">Name of Project</td>
                    <td class="col-d user-input" contenteditable="true" data-placeholder="Enter project name">Three Feathers Terrace</td>
                    <td class="col-e"></td>
                    <td class="col-f"></td>
                    <td class="col-g"></td>
                    <td class="col-h"></td>
                    <td class="col-i"></td>
                    <td class="col-j"></td>
                    <td class="col-k"></td>
                    <td class="col-l"></td>
                    <td class="col-m user-input" contenteditable="true" data-placeholder="Enter notes"></td>
                  </tr>
                  <tr>
                    <td class="col-c">Location/Address</td>
                    <td class="col-d user-input" contenteditable="true" data-placeholder="Enter project location">1267 3rd Line, Innisfil, ON</td>
                    <td class="col-e"></td>
                    <td class="col-f"></td>
                    <td class="col-g"></td>
                    <td class="col-h"></td>
                    <td class="col-i"></td>
                    <td class="col-j"></td>
                    <td class="col-k"></td>
                    <td class="col-l"></td>
                    <td class="col-m user-input" contenteditable="true" data-placeholder="Enter notes"></td>
                  </tr>
                  <tr>
                    <td class="col-c">Date</td>
                    <td class="col-d user-input" contenteditable="true" data-placeholder="Enter date">2025.06.05</td>
                    <td class="col-e"></td>
                    <td class="col-f"></td>
                    <td class="col-g"></td>
                    <td class="col-h"></td>
                    <td class="col-i"></td>
                    <td class="col-j"></td>
                    <td class="col-k"></td>
                    <td class="col-l"></td>
                    <td class="col-m user-input" contenteditable="true" data-placeholder="Enter notes"></td>
                  </tr>
                  <tr>
                    <td class="col-c">OAA Registration URI</td>
                    <td class="col-d user-input" contenteditable="true" data-placeholder="Enter OAA Registration URI">https://oaa.on.ca/oaa-directory/search-architects/search-architects-detail/Andrew-RossThomson</td>
                    <td class="col-e"></td>
                    <td class="col-f"></td>
                    <td class="col-g"></td>
                    <td class="col-h"></td>
                    <td class="col-i"></td>
                    <td class="col-j"></td>
                    <td class="col-k"></td>
                    <td class="col-l"></td>
                    <td class="col-m user-input" contenteditable="true" data-placeholder="Enter notes"></td>
                  </tr>
                  <tr>
                    <td class="col-c">Seal & Signature</td>
                    <td class="col-d" colspan="9">
                      <!-- Add architect stamp upload box -->
                      <div class="stamp-box-container">
                        <div class="stamp-box-wrapper">
                          <div id="stamp-box" class="stamp-box">
                            <span class="signature-label">Click to upload architect stamp</span>
                          </div>
                          <input type="file" id="stamp-input" class="file-input" accept="image/*">
                        </div>
                      </div>
                    </td>
                    <td class="col-m user-input" contenteditable="true" data-placeholder="Enter notes"></td>
                  </tr>
                </table>
              </div>
            </div>
          </div>

          <!-- Main OBC Matrix Data -->
          <div id="obcMatrix" class="section">
            <div class="section-header">
              <span class="section-icon"><i class="bi bi-table"></i></span>
              <span id="matrix-title">PART 3 - FIRE PROTECTION, OCCUPANT SAFETY AND ACCESSIBILITY</span>
            </div>
            <div class="section-content">
              <div id="matrix-content">
                <!-- This div will be populated based on the selected matrix (Part 3 or Part 9) -->
                <div class="alert alert-info m-3">Loading matrix data...</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <footer class="pt-5 mt-5 text-muted border-top">
        <div class="row">
          <div class="col-md-6">
            <p>
              Based on the framework by
              <a href="https://OpenBuilding.ca">OpenBuilding.ca</a>
            </p>
          </div>
          <div class="col-md-6 text-end">
            <p>OBC Matrix - 2024 Edition</p>
          </div>
        </div>
      </footer>
    </div>

    <!-- Modal for instructions -->
    <div
      class="modal fade"
      id="disclaimerModal"
      tabindex="-1"
      aria-labelledby="disclaimerModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header bg-warning bg-opacity-25">
            <h5 class="modal-title" id="disclaimerModalLabel">
              Using the OBC Matrix
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p>
              This tool helps you complete the Ontario Building Code Data Matrix for building permit applications.
            </p>
            <p>
              Simply enter your information in the blue input fields. You can toggle between Part 3 (large buildings) and Part 9 (housing and small buildings) forms using the toggle switch at the top.
            </p>
            <p>
              When you're finished, you can export your data as a CSV file or download a completed PDF form.
            </p>
            <hr />
            <p>
              <strong>Disclaimer:</strong> This interactive OBC Matrix is provided as a convenience tool. While every effort has been made to ensure accuracy, the official Ontario Building Code and related regulations should always be consulted for definitive requirements. This form is not a substitute for professional engineering or architectural advice.
            </p>
            <p>
              © Ontario Association of Architects - Interactive version by OpenBuilding.ca
            </p>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-primary"
              data-bs-dismiss="modal"
            >
              Got it
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Initialize components on page load -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // The functionality has been moved to OBC-init.js
        // No need to duplicate the initialization here
        
        // Any additional page-specific initialization can go here
      });
    </script>
  </body>
</html> 