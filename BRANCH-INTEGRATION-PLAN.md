# File Structure Mapping: main ‚Üí mhp/prepare-public-release

## Overview
The `mhp/prepare-public-release` branch restructured the codebase from:
- `OBJECTIVE 4011RF/` (old structure)
to:
- `src/` (new structure)

Meanwhile, `main` branch has 41 commits with ongoing development on the old structure.

## Merge Base
Common ancestor: `9d05b74` (Merge pull request #11 from arossti/mhp/license)

## File Mapping

### Core Files (Root Level)
OLD PATH (main) ‚Üí NEW PATH (prepare-public-release)
```
OBJECTIVE 4011RF/4011-AppendixE.js        ‚Üí src/core/AppendixE.js
OBJECTIVE 4011RF/4011-Calculator.js       ‚Üí src/core/Calculator.js
OBJECTIVE 4011RF/4011-ClimateValues.js    ‚Üí src/core/ClimateValues.js
OBJECTIVE 4011RF/4011-Clock.js            ‚Üí src/core/Clock.js
OBJECTIVE 4011RF/4011-ComponentBridge.js  ‚Üí src/core/ComponentBridge.js
OBJECTIVE 4011RF/4011-Dependency.js       ‚Üí src/core/Dependency.js
OBJECTIVE 4011RF/4011-ExcelMapper.js      ‚Üí src/core/ExcelMapper.js  ‚ö†Ô∏è MODIFIED IN MAIN
OBJECTIVE 4011RF/4011-FieldManager.js     ‚Üí src/core/FieldManager.js
OBJECTIVE 4011RF/4011-FileHandler.js      ‚Üí src/core/FileHandler.js  ‚ö†Ô∏è MODIFIED IN MAIN
OBJECTIVE 4011RF/4011-MobileDetect.js     ‚Üí src/core/MobileDetect.js
OBJECTIVE 4011RF/4011-QCMonitor.js        ‚Üí src/core/QCMonitor.js
OBJECTIVE 4011RF/4011-ReferenceManager.js ‚Üí src/core/ReferenceManager.js
OBJECTIVE 4011RF/4011-ReferenceToggle.js  ‚Üí src/core/ReferenceToggle.js
OBJECTIVE 4011RF/4011-ReferenceValues.js  ‚Üí src/core/ReferenceValues.js  ‚ö†Ô∏è MODIFIED IN MAIN
OBJECTIVE 4011RF/4011-SectionIntegrator.js ‚Üí src/core/SectionIntegrator.js
OBJECTIVE 4011RF/4011-StateManager.js     ‚Üí src/core/StateManager.js
OBJECTIVE 4011RF/4011-TooltipManager.js   ‚Üí src/core/TooltipManager.js  ‚ö†Ô∏è HEAVILY MODIFIED IN MAIN
OBJECTIVE 4011RF/4011-init.js             ‚Üí src/core/init.js
OBJECTIVE 4011RF/4012-Cooling.js          ‚Üí src/core/Cooling.js
OBJECTIVE 4011RF/4012-Orchestrator.js     ‚Üí src/core/Orchestrator.js
```

### Section Files
OLD PATH (main) ‚Üí NEW PATH (prepare-public-release)
```
OBJECTIVE 4011RF/sections/4012-Section01.js ‚Üí src/sections/Section01.js  ‚ö†Ô∏è MODIFIED IN MAIN
OBJECTIVE 4011RF/sections/4012-Section02.js ‚Üí src/sections/Section02.js
OBJECTIVE 4011RF/sections/4012-Section03.js ‚Üí src/sections/Section03.js  ‚ö†Ô∏è MODIFIED IN MAIN
OBJECTIVE 4011RF/sections/4012-Section04.js ‚Üí src/sections/Section04.js
OBJECTIVE 4011RF/sections/4012-Section05.js ‚Üí src/sections/Section05.js
OBJECTIVE 4011RF/sections/4012-Section06.js ‚Üí src/sections/Section06.js
OBJECTIVE 4011RF/sections/4012-Section07.js ‚Üí src/sections/Section07.js  ‚ö†Ô∏è MODIFIED IN MAIN
OBJECTIVE 4011RF/sections/4012-Section08.js ‚Üí src/sections/Section08.js  ‚ö†Ô∏è MODIFIED IN MAIN
OBJECTIVE 4011RF/sections/4012-Section09.js ‚Üí src/sections/Section09.js  ‚ö†Ô∏è MODIFIED IN MAIN
OBJECTIVE 4011RF/sections/4012-Section10.js ‚Üí src/sections/Section10.js  ‚ö†Ô∏è HEAVILY MODIFIED IN MAIN
OBJECTIVE 4011RF/sections/4012-Section11.js ‚Üí src/sections/Section11.js  ‚ö†Ô∏è HEAVILY MODIFIED IN MAIN
OBJECTIVE 4011RF/sections/4012-Section12.js ‚Üí src/sections/Section12.js  ‚ö†Ô∏è HEAVILY MODIFIED IN MAIN
OBJECTIVE 4011RF/sections/4012-Section13-GS.js ‚Üí src/sections/Section13-GS.js
OBJECTIVE 4011RF/sections/4012-Section13-OFFLINE.js ‚Üí src/sections/Section13-OFFLINE.js
OBJECTIVE 4011RF/sections/4012-Section13.js ‚Üí src/sections/Section13.js
OBJECTIVE 4011RF/sections/4012-Section14.js ‚Üí src/sections/Section14.js
OBJECTIVE 4011RF/sections/4012-Section15.js ‚Üí src/sections/Section15.js
OBJECTIVE 4011RF/sections/4012-Section16.js ‚Üí src/sections/Section16.js
OBJECTIVE 4011RF/sections/4012-Section16C.js ‚Üí src/sections/Section16C.js
OBJECTIVE 4011RF/sections/4012-Section17.js ‚Üí src/sections/Section17.js
```

### OBC Files
OLD PATH (main) ‚Üí NEW PATH (prepare-public-release)
```
OBJECTIVE 4011RF/obc/OBC-*.js        ‚Üí src/obc/OBC-*.js (1:1 mapping)
OBJECTIVE 4011RF/obc/sections/*.js   ‚Üí src/obc/sections/*.js (1:1 mapping)
OBJECTIVE 4011RF/obc/indexobc.html   ‚Üí src/obc/indexobc.html
OBJECTIVE 4011RF/obc/tests/*.html    ‚Üí src/obc/tests/*.html
```

### HTML & Config
```
OBJECTIVE 4011RF/index.html          ‚Üí index.html (moved to root)  ‚ö†Ô∏è MODIFIED IN MAIN
OBJECTIVE 4011RF/4011-MobileStyles.css ‚Üí src/4011-MobileStyles.css
                                      ‚Üí src/MobileStyles.css
```

### Assets
```
(assets remain in same relative structure under src/)
```

### Documentation
```
OBJECTIVE 4011RF/documentation/ ‚Üí (kept in old structure)
```

## Modified Files in main (need to be ported)

### Heavily Modified (Major Changes):
1. **4011-TooltipManager.js** ‚Üí src/core/TooltipManager.js
   - 1256 line changes

2. **4012-Section10.js** ‚Üí src/sections/Section10.js
   - 102 line changes
   - Features: Window/door area publishing, percentage calculations, Reference mode parity

3. **4012-Section11.js** ‚Üí src/sections/Section11.js
   - 130 line changes
   - Features: RSI/U-value conversions, Anti-Pattern fixes, import handling

4. **4012-Section12.js** ‚Üí src/sections/Section12.js
   - 157 line changes
   - Features: g_109 editability, fallback anti-pattern elimination, listener optimization

### Moderately Modified:
5. **4011-FileHandler.js** ‚Üí src/core/FileHandler.js (90 lines)
6. **4011-ExcelMapper.js** ‚Üí src/core/ExcelMapper.js (40 lines)
7. **4012-Section09.js** ‚Üí src/sections/Section09.js (24 lines)
8. **index.html** ‚Üí index.html (24 lines)

### Lightly Modified:
9. **4012-Section01.js** ‚Üí src/sections/Section01.js (14 lines)
10. **4012-Section08.js** ‚Üí src/sections/Section08.js (7 lines)
11. **4012-Section03.js** ‚Üí src/sections/Section03.js (5 lines)
12. **4012-Section07.js** ‚Üí src/sections/Section07.js (4 lines)
13. **4011-ReferenceValues.js** ‚Üí src/core/ReferenceValues.js (2 lines)

## Summary Statistics
- **Total commits in main since divergence:** 41
- **Files modified in old structure:** 38 files
- **Net changes:** +6,280 lines added, -1,947 lines removed
- **Key change areas:**
  - Reference mode calculations (S10, S11, S12)
  - Tooltip system overhaul
  - CSV import parity
  - Anti-pattern elimination
  - Bug fixes and performance optimizations

## Recommended Integration Strategy

### Option 1: Cherry-pick commits (RECOMMENDED)
Since the changes are in the old structure, you could:
1. Checkout `mhp/prepare-public-release`
2. Cherry-pick commits from main that modify the old structure
3. Git will handle the rename detection automatically if similarity is high enough

### Option 2: Manual port
For each modified file in main:
1. Get the diff: `git diff 9d05b74..main -- OBJECTIVE\ 4011RF/path/to/file.js`
2. Apply to new location: `src/new/path/file.js`

### Option 3: Merge with rename hints
```bash
git checkout mhp/prepare-public-release
git merge main -X rename-threshold=50
```

## Testing Strategy
After integration, verify:
1. All 41 commits worth of bug fixes are present
2. Reference mode calculations work correctly
3. CSV import parity maintained
4. Tooltip system functional
5. All section calculations accurate

## Detailed Commit List (main since 9d05b74)

```
c84daa3 üîß FIX: g_109 editability now updates immediately on mode switch
d002f0a üîß FIX: g_109 now editable in Reference mode when d_108 is MEASURED
745a594 üìù DOCS: Add fallback anti-pattern fix to G101-BUG.md
169eaff üîí SECURITY: Eliminate fallback anti-patterns in S12 calculations
e91085d üìù DOCS: Update G101-BUG.md with complete fix documentation
d714537 ‚ö° PERF: Optimize S12 listeners - remove redundant RSI listeners
0934120 üîß FIX: S12 Reference g_101 now reads correct S11 state path
1867cc0 üìù DOCS: Add fallback elimination guidance to G101-BUG.md
b1f45b3 ‚ú® FEATURE: S10 publishes window/door areas with S11 field IDs
ccceb6d üîß FIX: Add missing percentage calculations for S10 Reference mode
d1826de üîß FIX: Complete Reference mode calculation parity for S10/S11
428efb6 üîß FIX: Add RSI/U-value conversions for Reference mode in S11
ef28054 üîß FIX: Add missing i_82 calculation in Reference mode
bb232fd üé® STYLE: Run ESLint and Prettier formatting on codebase
cd7b234 üìö DOCS: Add debug session log and reorganize documentation
1427347 üîß FIX: Remove Anti-Pattern duplicate defaults in S11
abff4b1 üßπ CLEANUP: Remove verbose logging from S10, S12, and S01
2f00b37 üìö DOCS: Add Anti-Pattern 6 and debugging methodology to cheatsheet + cleanup
cc7f46b üîß FIX: Remove S09 dropdown listener for d_12 to prevent state mixing
571098a üîç DEBUG: Add call stack trace for d_12/ref_d_12 writes
```
(and 21 more commits)
