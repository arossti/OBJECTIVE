4011-MobileDetect.js:113 Desktop device detected
4011-Section18.js:6 Section 18 (Notes) placeholder loaded.
 S02: Target defaults set from field definitions - overriding any localStorage empties
 S02: Reference defaults set from field definitions with overrides - overriding any localStorage empties
 ✅ S02: Header controls injected successfully
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 [S02] Refreshing UI for TARGET mode
 [S02] Updated h_12 (reporting year) slider = "2022" (target mode)
 [S02] Updated h_13 (service life) slider = "50" (target mode)
 [S02] Updated h_15 = "1427.2" (target mode)
 [S02] Updated i_17 = "8154" (target mode)
 [S02] Updated l_12 = "$0.1300" (target mode)
 [S02] Updated l_13 = "$0.5070" (target mode)
 [S02] Updated l_14 = "$1.6200" (target mode)
 [S02] Updated l_15 = "$180.00" (target mode)
 [S02] Updated l_16 = "$1.5000" (target mode)
 S03: Sliders initialized via FieldManager
 S03: Section rendered - initializing Self-Contained State Module.
 S03: Header controls setup complete
 S03: ModeManager exposed globally for cross-section integration.
 S03: Checking climate data availability (attempt 1/10)
 S03: Climate data available (8) ['BC', 'AB', 'SK', 'MB', 'ON', 'QC', 'NU', 'NT']
 S03: Synced province "ON" to StateManager for cross-section communication
 City dropdown updated for ON - selected: Alexandria
 S03: Sliders initialized via FieldManager
 S03: Weather data updated for Alexandria, ON (Present)
 Section03: Province selected: ON
 S03: Synced province change "ON" to StateManager key "d_19"
 City dropdown updated for ON - selected: Alexandria
 S03: Weather data updated for Alexandria, ON (Present)
 S03: Self-Contained State Module initialization complete
 S04: Initializing Pattern A ModeManager
 S04: TargetState minimal defaults set (user inputs only)
 S04: ReferenceState minimal defaults set (user inputs only)
 S04: Synced Target defaults to StateManager
 S04: Pattern A initialization complete
 ✅ S04: Header controls injected successfully
 [S04] Found 17 editable fields
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
 [S04] j_32 update: 0
 [S01] j_32 listener: null → 0
 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 0
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 S05: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔄 [S05] updateCalculatedDisplayValues: mode=target
 S06: Pattern A initialization starting...
 S06: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 🟢 [S06-TAR] Storing d_43 = 0 (from d_44=0, d_45=0, d_46=0)
 [S04] S06 onsite renewable subtotal changed: d_43
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S06 offsite renewable subtotal changed: i_43
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 🔵 [S06-REF] Storing ref_d_43 = 0 (from d_44=0, d_45=0, d_46=0)
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 🔄 [S06] updateCalculatedDisplayValues: mode=target
 S06: Pattern A initialization complete.
 🚀 [S07] onSectionRendered: Initializing state defaults from FieldDefinitions
 🔧 [S07] TargetState.setDefaults: Initializing from FieldDefinitions
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_49
 ✅ [S07] getFieldDefault: Found default for d_49 = "User Defined"
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_51
 ✅ [S07] getFieldDefault: Found default for d_51 = "Heatpump"
 ✅ [S07] TargetState.setDefaults: d_49="User Defined", d_51="Heatpump"
 [S04] d_51 listener fired - S07 fuel type
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 🌐 [S07] TargetState.setDefaults: Published to StateManager
 🔧 [S07] ReferenceState.setDefaults: Initializing from FieldDefinitions
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_49
 ✅ [S07] getFieldDefault: Found default for d_49 = "User Defined"
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_51
 ✅ [S07] getFieldDefault: Found default for d_51 = "Heatpump"
 ✅ [S07] ReferenceState.setDefaults: d_49="User Defined", d_51="Heatpump"
 [S04] S07 water heating fuel type changed (Reference): ref_d_51
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 🔗 [S07] ReferenceState.setDefaults: Published to StateManager with ref_ prefix
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_49
 ✅ [S07] getFieldDefault: Found default for d_49 = "User Defined"
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_51
 ✅ [S07] getFieldDefault: Found default for d_51 = "Heatpump"
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (TGT)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S04] e_51 listener fired - S07 gas
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] k_54 listener fired - S07 oil
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
4011-Section07.js:658 [S07] 🚨 CRITICAL: ref_d_63 missing, using default 0 for Reference calculation
calculateWaterUse @ 4011-Section07.js:658
calculateReferenceModel @ 4011-Section07.js:988
calculateAll @ 4011-Section07.js:1031
onSectionRendered @ 4011-Section07.js:1433
initializeSectionEventHandlers @ 4011-FieldManager.js:398
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ 4011-FieldManager.js:1461Understand this warningAI
4011-Section07.js:806 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (REF)
4011-Section07.js:841 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
4011-Section08.js:633 [S08] S04 listeners setup complete
4011-Section04.js:2537 [S04] S08 forestry offset changed: d_60
4011-Section04.js:450 [S04] 🔄 Updating calculated display values for target mode
4011-Section04.js:458 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
4011-Section04.js:539 [S04 DEBUG] Target mode - j_32: 0
4011-Section04.js:539 [S04 DEBUG] Target mode - k_32: 0
4011-Section04.js:539 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:574 [S04] Calculated display values updated for target mode
 [S09] ✅ Pattern A dual-engine listeners registered (5 Target/Reference pairs)
 S09: Target defaults loaded from field definitions
 S09: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6, lighting: 2.0
 S09: Header controls injected successfully
 [S09] ✅ Pattern A dual-engine listeners registered (5 Target/Reference pairs)
 S09: UI refreshed for target mode
 [S04] S09 total internal gains changed (Reference): ref_h_71
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S09 heating internal gains changed (Reference): ref_i_71
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S09 cooling internal gains changed (Reference): ref_k_71
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Occupancy changed (Reference): ref_d_63
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
 [S04] j_32 update: 0
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (TGT)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (REF)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S09] Updated calculated display values for target mode
 [S09] Updated calculated display values for target mode
 [S09] ✅ Pattern A dual-engine listeners registered (5 Target/Reference pairs)
 S09: UI refreshed for target mode
 [S09] Updated calculated display values for target mode
 [S09] Updated calculated display values for target mode
 S10: Section rendered - initializing Self-Contained State Module.
 S10: TargetState defaults loaded from field definitions (single source of truth)
 S10: ReferenceState defaults loaded from field definitions with Reference overrides
4011-Section10.js:2385 S10: Simplified global StateManager listeners added
4011-Section10.js:2434 S10: ModeManager exposed globally for cross-section integration.
4011-Section11.js:1893 S11: Section rendered - initializing Self-Contained State Module.
4011-Section11.js:127 S11: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
4011-Section11.js:199 S11: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
4011-FieldManager.js:400 Error in envelopeTransmissionLosses module onSectionRendered: ReferenceError: registerWithStateManager is not defined
    at Object.onSectionRendered (4011-Section11.js:1910:5)
    at initializeSectionEventHandlers (4011-FieldManager.js:398:23)
    at renderSection (4011-FieldManager.js:443:7)
    at 4011-FieldManager.js:470:7
    at Array.forEach (<anonymous>)
    at Object.renderAllSections (4011-FieldManager.js:469:27)
    at HTMLDocument.<anonymous> (4011-FieldManager.js:1461:21)
initializeSectionEventHandlers @ 4011-FieldManager.js:400
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ 4011-FieldManager.js:1461Understand this errorAI
4011-Section12.js:2505 S12: Section rendered - initializing Pattern A Dual-State Module.
4011-Section12.js:85 S12: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
4011-Section12.js:1562 [S12] U-agg REF: TB%=0 → g_101=0.000000, g_102=0.000000
4011-Section12.js:1904 [S12DB] REF CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
4011-Section12.js:1932 [S12DB] REF h_101 calc: (4600*0*24)/1000 = 0
 [S12DB] REF i_101 result: 0 * 0 = 0
 [S12DB] REF g_104 calc: (0*0 + 0*1e-7)/0.0000011 = 0
 [S12DB] REF ROW104: i_101=0, i_102=0, i_103=0 → i_104=0
 [S12DB] REF ROW104: h_21="StaticCapacitance", k_98=0 → k_104=0
 [S12DB] STORED for S15: ref_d_101=0
 [S12DB] STORED for S15: ref_d_102=1e-7
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S12DB] STORED for S15: ref_g_101=0
 [S12DB] STORED for S15: ref_g_102=0
 [S12DB] STORED for S15: ref_g_104=0
 S10: Reference listener triggered by ref_i_103, recalculating all.
 S10: Reference utilization factor dependency ref_i_103 changed.
 [S12DB] STORED for S15: ref_i_101=0
 [S12DB] STORED for S15: ref_i_102=0
 [S12DB] STORED for S15: ref_i_104=0
 [Section12] Reference results stored with ref_ prefix for downstream sections
 [S12] U-agg TGT: TB%=0 → g_101=0.000000, g_102=0.000000
 [S12DB] TGT CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
 [S12DB] TGT h_101 calc: (4600*0*24)/1000 = 0
 [S12DB] TGT i_101 result: 0 * 0 = 0
 [S12DB] TGT g_104 calc: (0*0 + 0*1e-7)/0.0000011 = 0
 [S12DB] TGT ROW104: i_101=0, i_102=0, i_103=0 → i_104=0
 [S12DB] TGT ROW104: h_21="StaticCapacitance", k_98=0 → k_104=0
 [S12DB] g_104 DISPLAY (target): null
 [Section12] Calculated display values updated for target mode
 [S12] U-agg REF: TB%=0 → g_101=0.000000, g_102=0.000000
 [S12DB] REF CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
 [S12DB] REF h_101 calc: (4600*0*24)/1000 = 0
 [S12DB] REF i_101 result: 0 * 0 = 0
 [S12DB] REF g_104 calc: (0*0 + 0*1e-7)/0.0000011 = 0
 [S12DB] REF ROW104: i_101=0, i_102=0, i_103=0 → i_104=0
 [S12DB] REF ROW104: h_21="StaticCapacitance", k_98=0 → k_104=0
 [S12DB] STORED for S15: ref_d_101=0
 [S12DB] STORED for S15: ref_d_102=1e-7
 [S12DB] STORED for S15: ref_g_101=0
 [S12DB] STORED for S15: ref_g_102=0
 [S12DB] STORED for S15: ref_g_104=0
 [S12DB] STORED for S15: ref_i_101=0
 [S12DB] STORED for S15: ref_i_102=0
 [S12DB] STORED for S15: ref_i_104=0
 [Section12] Reference results stored with ref_ prefix for downstream sections
 [S12] U-agg TGT: TB%=0 → g_101=0.000000, g_102=0.000000
 [S12DB] TGT CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
 [S12DB] TGT h_101 calc: (4600*0*24)/1000 = 0
 [S12DB] TGT i_101 result: 0 * 0 = 0
 [S12DB] TGT g_104 calc: (0*0 + 0*1e-7)/0.0000011 = 0
 [S12DB] TGT ROW104: i_101=0, i_102=0, i_103=0 → i_104=0
 [S12DB] TGT ROW104: h_21="StaticCapacitance", k_98=0 → k_104=0
 [S12DB] g_104 DISPLAY (target): null
 [Section12] Calculated display values updated for target mode
 S10: Target listener triggered by i_103, recalculating all.
 S10: Target utilization factor dependency i_103 changed.
 [S12] U-agg REF: TB%=0 → g_101=0.000000, g_102=0.000000
 [S12DB] REF CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
 [S12DB] REF h_101 calc: (4600*0*24)/1000 = 0
 [S12DB] REF i_101 result: 0 * 0 = 0
 [S12DB] REF g_104 calc: (0*0 + 0*1e-7)/0.0000011 = 0
 [S12DB] REF ROW104: i_101=0, i_102=0, i_103=0 → i_104=0
 [S12DB] REF ROW104: h_21="StaticCapacitance", k_98=0 → k_104=0
 [S12DB] STORED for S15: ref_d_101=0
 [S12DB] STORED for S15: ref_d_102=1e-7
 [S12DB] STORED for S15: ref_g_101=0
 [S12DB] STORED for S15: ref_g_102=0
 [S12DB] STORED for S15: ref_g_104=0
 [S12DB] STORED for S15: ref_i_101=0
 [S12DB] STORED for S15: ref_i_102=0
 [S12DB] STORED for S15: ref_i_104=0
 [Section12] Reference results stored with ref_ prefix for downstream sections
 [S12] U-agg TGT: TB%=0 → g_101=0.000000, g_102=0.000000
 S10: Target listener triggered by i_103, recalculating all.
 S10: Target utilization factor dependency i_103 changed.
 [S12DB] TGT CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
 [S12DB] TGT h_101 calc: (4600*0*24)/1000 = 0
 [S12DB] TGT i_101 result: 0 * 0 = 0
 [S12DB] TGT g_104 calc: (0*0 + 0*1e-7)/0.0000011 = 0
 [S12DB] TGT ROW104: i_101=0, i_102=0, i_103=0 → i_104=0
 [S12DB] TGT ROW104: h_21="StaticCapacitance", k_98=0 → k_104=0
 [S12DB] g_104 DISPLAY (target): 0
 [Section12] Calculated display values updated for target mode
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S12] U-agg REF: TB%=0 → g_101=0.000000, g_102=0.000000
 [S12DB] REF CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
 [S12DB] REF h_101 calc: (4600*0*24)/1000 = 0
 [S12DB] REF i_101 result: 0 * 0 = 0
 [S12DB] REF g_104 calc: (0*0 + 0*1e-7)/0.0000011 = 0
 [S12DB] REF ROW104: i_101=0, i_102=0, i_103=0 → i_104=0
 [S12DB] REF ROW104: h_21="StaticCapacitance", k_98=0 → k_104=0
 [S12DB] STORED for S15: ref_d_101=0
 [S12DB] STORED for S15: ref_d_102=1e-7
 [S12DB] STORED for S15: ref_g_101=0
 [S12DB] STORED for S15: ref_g_102=0
 [S12DB] STORED for S15: ref_g_104=0
 [S12DB] STORED for S15: ref_i_101=0
 [S12DB] STORED for S15: ref_i_102=0
 [S12DB] STORED for S15: ref_i_104=0
 [Section12] Reference results stored with ref_ prefix for downstream sections
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S12] U-agg TGT: TB%=0 → g_101=0.000000, g_102=0.000000
 [S12DB] TGT CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
 [S12DB] TGT h_101 calc: (4600*0*24)/1000 = 0
 [S12DB] TGT i_101 result: 0 * 0 = 0
 [S12DB] TGT g_104 calc: (0*0 + 0*1e-7)/0.0000011 = 0
 [S12DB] TGT ROW104: i_101=0, i_102=0, i_103=0 → i_104=0
 [S12DB] TGT ROW104: h_21="StaticCapacitance", k_98=0 → k_104=0
 [S12DB] g_104 DISPLAY (target): 0
 [Section12] Calculated display values updated for target mode
 [S12] U-agg REF: TB%=0 → g_101=0.000000, g_102=0.000000
 [S12DB] REF CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
 [S12DB] REF h_101 calc: (4600*0*24)/1000 = 0
 [S12DB] REF i_101 result: 0 * 0 = 0
 [S12DB] REF g_104 calc: (0*0 + 0*1e-7)/0.0000011 = 0
 [S12DB] REF ROW104: i_101=0, i_102=0, i_103=0 → i_104=0
 [S12DB] REF ROW104: h_21="StaticCapacitance", k_98=0 → k_104=0
 [S12DB] STORED for S15: ref_d_101=0
 [S12DB] STORED for S15: ref_d_102=1e-7
 [S12DB] STORED for S15: ref_g_101=0
 [S12DB] STORED for S15: ref_g_102=0
 [S12DB] STORED for S15: ref_g_104=0
 [S12DB] STORED for S15: ref_i_101=0
 [S12DB] STORED for S15: ref_i_102=0
 [S12DB] STORED for S15: ref_i_104=0
 [Section12] Reference results stored with ref_ prefix for downstream sections
 [S12] U-agg TGT: TB%=0 → g_101=0.000000, g_102=0.000000
 [S12DB] TGT CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
 [S12DB] TGT h_101 calc: (4600*0*24)/1000 = 0
 [S12DB] TGT i_101 result: 0 * 0 = 0
 [S12DB] TGT g_104 calc: (0*0 + 0*1e-7)/0.0000011 = 0
 [S12DB] TGT ROW104: i_101=0, i_102=0, i_103=0 → i_104=0
 [S12DB] TGT ROW104: h_21="StaticCapacitance", k_98=0 → k_104=0
 [S12DB] g_104 DISPLAY (target): 0
 [Section12] Calculated display values updated for target mode
 S12: Pattern A initialization complete.
 [Section13] 🔗 Attaching StateManager listeners...
 [Section13] 🔗 Attaching CRITICAL upstream listeners...
 [Section13] ✅ ALL LISTENERS ATTACHED SUCCESSFULLY
 S13: Section rendered - initializing Pattern A Dual-State Module.
 [S13 DEBUG] Loading reference standard: "OBC SB10 5.5-6 Z6"
 [S13 DEBUG] Found reference values: {f_113: '7.1', j_115: '0.90', d_118: '81', d_119: '8.33'}
 S13: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6 {f_113: '7.1', j_115: '0.90', d_118: '81', d_119: '8.33', j_116: '3.3', …}
 [Section13] 🔗 Attaching StateManager listeners...
 [Section13] 🔗 Attaching CRITICAL upstream listeners...
 [Section13] ✅ ALL LISTENERS ATTACHED SUCCESSFULLY
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=0, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=0
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 0
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S04] S13 space oil volume changed (Reference): ref_f_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 0
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:574 [S04] Calculated display values updated for target mode
4011-Section10.js:2356 S10: Reference listener triggered by ref_m_121, recalculating all.
4011-Section10.js:2377 S10: Reference utilization factor dependency ref_m_121 changed.
4011-Section13.js:3270 [Section13] Reference results stored with ref_ prefix for downstream sections
4011-Section13.js:3273 [S13 DEBUG] Total Reference results stored: 34
4011-Section13.js:3019 [Section13] Reference Model calculations complete
4011-Section13.js:2924 [Section13] ✅ Reference Model complete
4011-Section13.js:2926 [Section13] 🔄 Starting Target Model calculations...
4011-Section13.js:3033 [Section13] Running Target Model calculations...
4011-Section13.js:2439 [S13] TGT HEATING: system=Heatpump, ted=0, afue=1, cop=3.663540445486518
4011-Section10.js:2347 S10: Target listener triggered by m_121, recalculating all.
 S10: Target utilization factor dependency m_121 changed.
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="CoolingNo Cooling", heatingType="Heatpump", isCoolingActive=false, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=0, l_116=0, l_114=0
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="CoolingNo Cooling", heatingType="Heatpump", isCoolingActive=false, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=0, l_116=0, l_114=0
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="CoolingNo Cooling", heatingType="Heatpump", isCoolingActive=false, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=0, l_116=0, l_114=0
 [S04] f_115 listener fired - S13 oil
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S13 space gas volume changed: h_115
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [S13] Set up dropdown event handlers for 4 dropdowns
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 S13: Pattern A initialization complete.
 S14: Section rendered - initializing Pattern A Dual-State Module.
 S14: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 0 + 0 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -120694.93352 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -120694.93352 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 0 - 120694.93352 = -120694.93352
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=-120694.93352, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=0
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): -12944.544564564565
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = -12944.544564564565
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 S10: Reference listener triggered by ref_m_121, recalculating all.
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 0 + 169206.3999999999 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 48511.4664799999 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 48511.4664799999 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 0 - 120694.93352 = -120694.93352
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="CoolingNo Cooling", heatingType="Heatpump", isCoolingActive=false, coolingDemand=-27137.857101615613
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=0, l_116=0, l_114=0
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="CoolingNo Cooling", heatingType="Heatpump", isCoolingActive=false, coolingDemand=-27137.857101615613
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=0, l_116=0, l_114=0
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 0 + 169206.3999999999 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 48511.4664799999 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 48511.4664799999 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 0 - 120694.93352 = -120694.93352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 0 + 169206.3999999999 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 48511.4664799999 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 48511.4664799999 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 0 - 120694.93352 = -120694.93352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 0 + 169206.3999999999 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 48511.4664799999 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 48511.4664799999 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 0 - 120694.93352 = -120694.93352
 S10: Reference utilization factor dependency ref_m_121 changed.
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 0 + 169206.3999999999 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 48511.4664799999 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 48511.4664799999 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 0 - 120694.93352 = -120694.93352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 0 + 169206.3999999999 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 48511.4664799999 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 48511.4664799999 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 0 - 120694.93352 = -120694.93352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 0 + 169206.3999999999 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 48511.4664799999 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 48511.4664799999 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 0 - 120694.93352 = -120694.93352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 0 + 169206.3999999999 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 48511.4664799999 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 48511.4664799999 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 0 - 120694.93352 = -120694.93352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 0 + 169206.3999999999 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 48511.4664799999 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 48511.4664799999 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 0 - 120694.93352 = -120694.93352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 0 + 169206.3999999999 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 48511.4664799999 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 48511.4664799999 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 0 - 120694.93352 = -120694.93352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 0 + 169206.3999999999 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 48511.4664799999 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 48511.4664799999 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 0 - 120694.93352 = -120694.93352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 0 + 169206.3999999999 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 48511.4664799999 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 48511.4664799999 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 0 - 120694.93352 = -120694.93352
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=52082.01983999997, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="CoolingNo Cooling", heatingType="Heatpump", isCoolingActive=false, coolingDemand=-27137.857101615613
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=0, l_116=0, l_114=0
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="CoolingNo Cooling", heatingType="Heatpump", isCoolingActive=false, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=0, l_116=0, l_114=0
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="CoolingNo Cooling", heatingType="Heatpump", isCoolingActive=false, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=0, l_116=0, l_114=0
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=48511.4664799999, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=0
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 5202.859982839973
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
4011-Section13.js:3258 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
4011-Section13.js:3258 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 5202.859982839973
4011-Section04.js:2678 [S04] S13 space gas volume changed (Reference): ref_h_115
4011-Section04.js:975 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
4011-Section04.js:1625 [S04] Reference model calculations complete
4011-Section04.js:1631 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
4011-Section04.js:450 [S04] 🔄 Updating calculated display values for target mode
4011-Section04.js:458 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
4011-Section04.js:539 [S04 DEBUG] Target mode - j_32: 0
4011-Section04.js:539 [S04 DEBUG] Target mode - k_32: 0
4011-Section04.js:539 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=52082.01983999997, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="CoolingNo Cooling", heatingType="Heatpump", isCoolingActive=false, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=0, l_116=0, l_114=0
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="CoolingNo Cooling", heatingType="Heatpump", isCoolingActive=false, coolingDemand=-27137.857101615613
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=0, l_116=0, l_114=0
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="CoolingNo Cooling", heatingType="Heatpump", isCoolingActive=false, coolingDemand=-27137.857101615613
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=0, l_116=0, l_114=0
 S14: Pattern A initialization complete.
 [S04] S15 reference electricity changed: ref_d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
 [S04] j_32 update: 0
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 161357.7864799999, K32: 5808.880313279996
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] S15 target electricity changed: d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 161357.7864799999, K32: 5808.880313279996
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=161357.7864799999, ref_k_32=5808.880313279996 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for reference mode
 [S04DB] displayContext mode=reference j_32=0 ref_j_32=161357.7864799999 k_32=0 ref_k_32=5808.880313279996
 [S04 DEBUG] Reference mode - j_32: ref_j_32=161357.7864799999 (NO fallback to Target)
 [S04 DEBUG] Reference mode - k_32: ref_k_32=5808.880313279996 (NO fallback to Target)
 [S04 DEBUG] Reference mode - l_27: ref_l_27=36 (NO fallback to Target)
 [S04] Calculated display values updated for reference mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for reference mode
 [S04DB] displayContext mode=reference j_32=0 ref_j_32=161357.7864799999 k_32=0 ref_k_32=5808.880313279996
 [S04 DEBUG] Reference mode - j_32: ref_j_32=161357.7864799999 (NO fallback to Target)
 [S04 DEBUG] Reference mode - k_32: ref_k_32=5808.880313279996 (NO fallback to Target)
 [S04 DEBUG] Reference mode - l_27: ref_l_27=36 (NO fallback to Target)
 [S04] Calculated display values updated for reference mode
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=161357.7864799999, ref_k_32=5808.880313279996 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=161357.7864799999 k_32=0 ref_k_32=5808.880313279996
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=161357.7864799999 k_32=0 ref_k_32=5808.880313279996
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 ✅ S15: Header controls injected successfully
 [StateManager] 🎯 h_10 setValue: "93.0" (state: default)
 [StateManager] h_10 setValue stack trace:
setValue @ 4011-StateManager.js:346
(anonymous) @ 4011-StateManager.js:222
initializeFromFieldManager @ 4011-StateManager.js:216
initialize @ 4011-StateManager.js:193
initialize @ 4011-Calculator.js:60
(anonymous) @ 4011-Calculator.js:973
 S02: Target defaults set from field definitions - overriding any localStorage empties
 S02: Loaded and merged Target state from localStorage
 S02: Reference defaults set from field definitions with overrides - overriding any localStorage empties
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 [S02] Refreshing UI for TARGET mode
 [S02] Updated h_12 (reporting year) slider = "2022" (target mode)
 [S02] Updated h_13 (service life) slider = "50" (target mode)
 [S02] Updated h_15 = "1427.2" (target mode)
 [S02] Updated i_17 = "8154" (target mode)
 [S02] Updated l_12 = "$0.1300" (target mode)
 [S02] Updated l_13 = "$0.5070" (target mode)
 [S02] Updated l_14 = "$1.6200" (target mode)
 [S02] Updated l_15 = "$180.00" (target mode)
 [S02] Updated l_16 = "$1.5000" (target mode)
 S03: Sliders initialized via FieldManager
 S03: Section rendered - initializing Self-Contained State Module.
 S03: ModeManager exposed globally for cross-section integration.
 S03: Checking climate data availability (attempt 1/10)
 S03: Climate data available (8) ['BC', 'AB', 'SK', 'MB', 'ON', 'QC', 'NU', 'NT']
 S03: Synced province "ON" to StateManager for cross-section communication
 City dropdown updated for ON - selected: Alexandria
 S03: Sliders initialized via FieldManager
 S03: Weather data updated for Alexandria, ON (Present)
 Section03: Province selected: ON
 S03: Synced province change "ON" to StateManager key "d_19"
 City dropdown updated for ON - selected: Alexandria
 S03: Weather data updated for Alexandria, ON (Present)
4011-Section03.js:2119 S03: Self-Contained State Module initialization complete
4011-Section04.js:334 S04: Initializing Pattern A ModeManager
4011-Section04.js:174 S04: TargetState minimal defaults set (user inputs only)
4011-Section04.js:207 S04: TargetState loaded from localStorage
4011-Section04.js:262 S04: ReferenceState minimal defaults set (user inputs only)
4011-Section04.js:300 S04: ReferenceState loaded from localStorage
4011-Section01.js:1110 [S01] j_32 listener: 0 → 0
4011-Section01.js:1111 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 0
4011-Section04.js:347 S04: Synced Target defaults to StateManager
4011-Section04.js:350 S04: Pattern A initialization complete
4011-Section04.js:2360 [S04] Found 17 editable fields
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
 [S04] j_32 update: 0
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 S05: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔄 [S05] updateCalculatedDisplayValues: mode=target
 S06: Pattern A initialization starting...
 S06: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 🟢 [S06-TAR] Storing d_43 = 0 (from d_44=0, d_45=0, d_46=0)
 [S04] S06 onsite renewable subtotal changed: d_43
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S06 offsite renewable subtotal changed: i_43
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 🔵 [S06-REF] Storing ref_d_43 = 0 (from d_44=0, d_45=0, d_46=0)
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 🔄 [S06] updateCalculatedDisplayValues: mode=target
 S06: Pattern A initialization complete.
 🚀 [S07] onSectionRendered: Initializing state defaults from FieldDefinitions
 🔧 [S07] TargetState.setDefaults: Initializing from FieldDefinitions
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_49
 ✅ [S07] getFieldDefault: Found default for d_49 = "User Defined"
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_51
 ✅ [S07] getFieldDefault: Found default for d_51 = "Heatpump"
 ✅ [S07] TargetState.setDefaults: d_49="User Defined", d_51="Heatpump"
 🌐 [S07] TargetState.setDefaults: Published to StateManager
 🔧 [S07] ReferenceState.setDefaults: Initializing from FieldDefinitions
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_49
 ✅ [S07] getFieldDefault: Found default for d_49 = "User Defined"
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_51
 ✅ [S07] getFieldDefault: Found default for d_51 = "Heatpump"
 ✅ [S07] ReferenceState.setDefaults: d_49="User Defined", d_51="Heatpump"
 [S04] S07 water heating fuel type changed (Reference): ref_d_51
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 🔗 [S07] ReferenceState.setDefaults: Published to StateManager with ref_ prefix
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_49
 ✅ [S07] getFieldDefault: Found default for d_49 = "User Defined"
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_51
 ✅ [S07] getFieldDefault: Found default for d_51 = "Heatpump"
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (TGT)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S04] e_51 listener fired - S07 gas
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] k_54 listener fired - S07 oil
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S07] 🚨 CRITICAL: ref_d_63 missing, using default 0 for Reference calculation
calculateWaterUse @ 4011-Section07.js:658
calculateReferenceModel @ 4011-Section07.js:988
calculateAll @ 4011-Section07.js:1031
onSectionRendered @ 4011-Section07.js:1433
initializeSectionEventHandlers @ 4011-FieldManager.js:398
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ 4011-Calculator.js:973Understand this warningAI
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (REF)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S08] S04 listeners setup complete
 [S04] S08 forestry offset changed: d_60
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S09] ✅ Pattern A dual-engine listeners registered (5 Target/Reference pairs)
 [S09] ✅ Pattern A dual-engine listeners registered (5 Target/Reference pairs)
 S09: UI refreshed for target mode
 [S04] S09 total internal gains changed (Reference): ref_h_71
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S09 heating internal gains changed (Reference): ref_i_71
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S09 cooling internal gains changed (Reference): ref_k_71
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Occupancy changed (Reference): ref_d_63
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
 [S04] j_32 update: 0
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
4011-Section04.js:1556 [S04] Dual-engine calculations completed successfully
4011-Section04.js:450 [S04] 🔄 Updating calculated display values for target mode
4011-Section04.js:458 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
4011-Section04.js:539 [S04 DEBUG] Target mode - j_32: 0
4011-Section04.js:539 [S04 DEBUG] Target mode - k_32: 0
4011-Section04.js:539 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:574 [S04] Calculated display values updated for target mode
4011-Section07.js:806 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (TGT)
4011-Section07.js:841 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
4011-Section07.js:806 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (REF)
4011-Section07.js:841 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S09] Updated calculated display values for target mode
 [S09] Updated calculated display values for target mode
 [S09] ✅ Pattern A dual-engine listeners registered (5 Target/Reference pairs)
 S09: UI refreshed for target mode
 [S09] Updated calculated display values for target mode
 [S09] Updated calculated display values for target mode
 S10: Section rendered - initializing Self-Contained State Module.
 S10: Simplified global StateManager listeners added
 S10: ModeManager exposed globally for cross-section integration.
 S11: Section rendered - initializing Self-Contained State Module.
 S11: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 S11: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 Error in envelopeTransmissionLosses module onSectionRendered: 
initializeSectionEventHandlers @ 4011-FieldManager.js:400
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ 4011-Calculator.js:973Understand this errorAI
 [Section13] 🔗 Attaching StateManager listeners...
 [Section13] 🔗 Attaching CRITICAL upstream listeners...
 [Section13] ✅ ALL LISTENERS ATTACHED SUCCESSFULLY
 S13: Section rendered - initializing Pattern A Dual-State Module.
 [S13 DEBUG] Loading reference standard: "OBC SB10 5.5-6 Z6"
 [S13 DEBUG] Found reference values: {f_113: '7.1', j_115: '0.90', d_118: '81', d_119: '8.33'}
 S13: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6 {f_113: '7.1', j_115: '0.90', d_118: '81', d_119: '8.33', j_116: '3.3', …}
 [Section13] 🔗 Attaching StateManager listeners...
 [Section13] 🔗 Attaching CRITICAL upstream listeners...
 [Section13] ✅ ALL LISTENERS ATTACHED SUCCESSFULLY
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=0, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=0
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 0
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S04] S13 space oil volume changed (Reference): ref_f_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 0
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 S10: Reference listener triggered by ref_m_121, recalculating all.
 S10: Reference utilization factor dependency ref_m_121 changed.
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=0, afue=1, cop=3.663540445486518
 S10: Target listener triggered by m_121, recalculating all.
 S10: Target utilization factor dependency m_121 changed.
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=2.7, l_116=0, l_114=0
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=2.7, l_116=0, l_114=0
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=2.7, l_116=0, l_114=0
 [S04] f_115 listener fired - S13 oil
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S13 space gas volume changed: h_115
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
4011-Section04.js:458 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
4011-Section04.js:539 [S04 DEBUG] Target mode - j_32: 0
4011-Section04.js:539 [S04 DEBUG] Target mode - k_32: 0
4011-Section04.js:539 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:574 [S04] Calculated display values updated for target mode
4011-Section13.js:3072 [Section13] Target Model calculations complete
4011-Section13.js:2928 [Section13] ✅ Target Model complete
4011-Section13.js:2955 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
4011-Section13.js:2961 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
4011-Section13.js:226 [Section13] 🔄 Updating calculated display values for target mode
4011-Section13.js:310 [Section13] Calculated display values updated for target mode
 [S13] Set up dropdown event handlers for 4 dropdowns
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 S13: Pattern A initialization complete.
 S14: Section rendered - initializing Pattern A Dual-State Module.
 S14: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.11539679999 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.428123200021 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.428123200021 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=-12913.428123200021, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=0
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): -1384.9665511797534
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = -1384.9665511797534
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 S10: Reference listener triggered by ref_m_121, recalculating all.
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 S10: Reference utilization factor dependency ref_m_121 changed.
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=26279.609839999983, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=-12913.343520000053, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=13486.4629835961
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): -1384.9574774774833
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = -1384.9574774774833
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=26279.609839999983, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 S14: Pattern A initialization complete.
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ 4011-Calculator.js:973Understand this warningAI
 [S04] S15 reference electricity changed: ref_d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
 [S04] j_32 update: 0
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 76754.58647999995, K32: 2763.1651132799984
24011-Section05.js:266 🔄 [S05] updateCalculatedDisplayValues: mode=target
4011-Section15.js:1486 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ 4011-Calculator.js:973Understand this warningAI
4011-Section15.js:1486 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ 4011-Calculator.js:973Understand this warningAI
4011-Section15.js:1486 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
calculateReferenceModel @ 4011-Section15.js:1654
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ 4011-Calculator.js:973Understand this warningAI
4011-Section04.js:2439 [S04] S15 target electricity changed: d_136
4011-Section04.js:1534 [S04] Starting dual-engine Excel-compliant calculations
4011-Section04.js:975 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
24011-Section05.js:266 🔄 [S05] updateCalculatedDisplayValues: mode=target
24011-Section05.js:266 🔄 [S05] updateCalculatedDisplayValues: mode=target
24011-Section15.js:1486 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateTargetModel @ 4011-Section04.js:1577
calculateAll @ 4011-Section04.js:1543
(anonymous) @ 4011-Section04.js:2440
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setCalculatedValue @ 4011-Section15.js:158
calculateValues @ 4011-Section15.js:1842
calculateTargetModel @ 4011-Section15.js:1701
calculateAll @ 4011-Section15.js:1390
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
calculateReferenceModel @ 4011-Section15.js:1654
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ 4011-Calculator.js:973Understand this warningAI
4011-Section04.js:975 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 76754.58647999995, K32: 2763.1651132799984
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
2 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2440
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setCalculatedValue @ 4011-Section15.js:158
calculateValues @ 4011-Section15.js:1842
calculateTargetModel @ 4011-Section15.js:1701
calculateAll @ 4011-Section15.js:1390
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
calculateReferenceModel @ 4011-Section15.js:1654
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ 4011-Calculator.js:973Understand this warningAI
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=76754.58647999995, ref_k_32=2763.1651132799984 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for reference mode
 [S04DB] displayContext mode=reference j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
 [S04 DEBUG] Reference mode - j_32: ref_j_32=76754.58647999995 (NO fallback to Target)
 [S04 DEBUG] Reference mode - k_32: ref_k_32=2763.1651132799984 (NO fallback to Target)
 [S04 DEBUG] Reference mode - l_27: ref_l_27=36 (NO fallback to Target)
 [S04] Calculated display values updated for reference mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for reference mode
 [S04DB] displayContext mode=reference j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
 [S04 DEBUG] Reference mode - j_32: ref_j_32=76754.58647999995 (NO fallback to Target)
 [S04 DEBUG] Reference mode - k_32: ref_k_32=2763.1651132799984 (NO fallback to Target)
 [S04 DEBUG] Reference mode - l_27: ref_l_27=36 (NO fallback to Target)
 [S04] Calculated display values updated for reference mode
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
calculateReferenceModel @ 4011-Section15.js:1654
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ 4011-Calculator.js:973Understand this warningAI
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ 4011-Calculator.js:973Understand this warningAI
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=76754.58647999995, ref_k_32=2763.1651132799984 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
4011-Section04.js:539 [S04 DEBUG] Target mode - j_32: 0
4011-Section04.js:539 [S04 DEBUG] Target mode - k_32: 0
4011-Section04.js:539 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:574 [S04] Calculated display values updated for target mode
4011-Section15.js:1486 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
onSectionRendered @ 4011-Section15.js:2276
initializeSectionEventHandlers @ 4011-FieldManager.js:398
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ 4011-Calculator.js:973Understand this warningAI
4011-Section03.js:1059 Section03: Province selected: ON
4011-Section03.js:1068 S03: Synced province change "ON" to StateManager key "d_19"
4011-Section03.js:1126 City dropdown updated for ON - selected: Alexandria
4011-Section15.js:1486 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
forceTEDITELIUpdate @ 4011-SectionIntegrator.js:305
initializeTEDITELIIntegration @ 4011-SectionIntegrator.js:241
(anonymous) @ 4011-SectionIntegrator.js:187
initializeAllIntegrations @ 4011-SectionIntegrator.js:184
(anonymous) @ 4011-SectionIntegrator.js:106
renderAllSections @ 4011-FieldManager.js:474
initialize @ 4011-Calculator.js:66
(anonymous) @ 4011-Calculator.js:973Understand this warningAI
4011-FileHandler.js:62 [SAFARI DEBUG] Setting up S03 Excel import buttons. selectExcelBtn and locationFileInput FOUND.
4011-Clock.js:28 [CLOCK] Performance monitoring initialized
 [StateManager] 🎯 h_10 setValue: "93.0" (state: default)
 [StateManager] h_10 setValue stack trace:
setValue @ 4011-StateManager.js:346
(anonymous) @ 4011-StateManager.js:222
initializeFromFieldManager @ 4011-StateManager.js:216
initialize @ 4011-StateManager.js:193
(anonymous) @ 4011-init.js:857
 S02: Target defaults set from field definitions - overriding any localStorage empties
 S02: Loaded and merged Target state from localStorage
 S02: Reference defaults set from field definitions with overrides - overriding any localStorage empties
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 [S02] Refreshing UI for TARGET mode
 [S02] Updated h_12 (reporting year) slider = "2022" (target mode)
 [S02] Updated h_13 (service life) slider = "50" (target mode)
 [S02] Updated h_15 = "1427.2" (target mode)
 [S02] Updated i_17 = "8154" (target mode)
 [S02] Updated l_12 = "$0.1300" (target mode)
 [S02] Updated l_13 = "$0.5070" (target mode)
 [S02] Updated l_14 = "$1.6200" (target mode)
 [S02] Updated l_15 = "$180.00" (target mode)
 [S02] Updated l_16 = "$1.5000" (target mode)
 S03: Sliders initialized via FieldManager
 S03: Section rendered - initializing Self-Contained State Module.
 S03: ModeManager exposed globally for cross-section integration.
 S03: Checking climate data availability (attempt 1/10)
 S03: Climate data available (8) ['BC', 'AB', 'SK', 'MB', 'ON', 'QC', 'NU', 'NT']
 S03: Synced province "ON" to StateManager for cross-section communication
 City dropdown updated for ON - selected: Alexandria
 S03: Sliders initialized via FieldManager
 S03: Weather data updated for Alexandria, ON (Present)
 Section03: Province selected: ON
 S03: Synced province change "ON" to StateManager key "d_19"
 City dropdown updated for ON - selected: Alexandria
 S03: Weather data updated for Alexandria, ON (Present)
 S03: Self-Contained State Module initialization complete
 S04: Initializing Pattern A ModeManager
 S04: TargetState minimal defaults set (user inputs only)
 S04: TargetState loaded from localStorage
 S04: ReferenceState minimal defaults set (user inputs only)
 S04: ReferenceState loaded from localStorage
 [S01] j_32 listener: 0 → 0
 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 0
 S04: Synced Target defaults to StateManager
 S04: Pattern A initialization complete
 [S04] Found 17 editable fields
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
 [S04] j_32 update: 0
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 S05: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔄 [S05] updateCalculatedDisplayValues: mode=target
 S06: Pattern A initialization starting...
 S06: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 🟢 [S06-TAR] Storing d_43 = 0 (from d_44=0, d_45=0, d_46=0)
 [S04] S06 onsite renewable subtotal changed: d_43
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S06 offsite renewable subtotal changed: i_43
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 🔵 [S06-REF] Storing ref_d_43 = 0 (from d_44=0, d_45=0, d_46=0)
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 🔄 [S06] updateCalculatedDisplayValues: mode=target
 S06: Pattern A initialization complete.
 🚀 [S07] onSectionRendered: Initializing state defaults from FieldDefinitions
 🔧 [S07] TargetState.setDefaults: Initializing from FieldDefinitions
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_49
 ✅ [S07] getFieldDefault: Found default for d_49 = "User Defined"
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_51
 ✅ [S07] getFieldDefault: Found default for d_51 = "Heatpump"
 ✅ [S07] TargetState.setDefaults: d_49="User Defined", d_51="Heatpump"
 🌐 [S07] TargetState.setDefaults: Published to StateManager
 🔧 [S07] ReferenceState.setDefaults: Initializing from FieldDefinitions
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_49
 ✅ [S07] getFieldDefault: Found default for d_49 = "User Defined"
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_51
 ✅ [S07] getFieldDefault: Found default for d_51 = "Heatpump"
 ✅ [S07] ReferenceState.setDefaults: d_49="User Defined", d_51="Heatpump"
 [S04] S07 water heating fuel type changed (Reference): ref_d_51
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 🔗 [S07] ReferenceState.setDefaults: Published to StateManager with ref_ prefix
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_49
 ✅ [S07] getFieldDefault: Found default for d_49 = "User Defined"
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_51
 ✅ [S07] getFieldDefault: Found default for d_51 = "Heatpump"
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (TGT)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S04] e_51 listener fired - S07 gas
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] k_54 listener fired - S07 oil
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S07] 🚨 CRITICAL: ref_d_63 missing, using default 0 for Reference calculation
calculateWaterUse @ 4011-Section07.js:658
calculateReferenceModel @ 4011-Section07.js:988
calculateAll @ 4011-Section07.js:1031
onSectionRendered @ 4011-Section07.js:1433
initializeSectionEventHandlers @ 4011-FieldManager.js:398
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ 4011-init.js:858Understand this warningAI
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (REF)
4011-Section07.js:841 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
4011-Section08.js:633 [S08] S04 listeners setup complete
4011-Section04.js:2537 [S04] S08 forestry offset changed: d_60
4011-Section04.js:450 [S04] 🔄 Updating calculated display values for target mode
4011-Section04.js:458 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
4011-Section04.js:539 [S04 DEBUG] Target mode - j_32: 0
4011-Section04.js:539 [S04 DEBUG] Target mode - k_32: 0
4011-Section04.js:539 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:574 [S04] Calculated display values updated for target mode
4011-Section09.js:2208 [S09] ✅ Pattern A dual-engine listeners registered (5 Target/Reference pairs)
4011-Section09.js:2208 [S09] ✅ Pattern A dual-engine listeners registered (5 Target/Reference pairs)
 S09: UI refreshed for target mode
 [S04] S09 total internal gains changed (Reference): ref_h_71
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S09 heating internal gains changed (Reference): ref_i_71
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S09 cooling internal gains changed (Reference): ref_k_71
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Occupancy changed (Reference): ref_d_63
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
 [S04] j_32 update: 0
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (TGT)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (REF)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S09] Updated calculated display values for target mode
 [S09] Updated calculated display values for target mode
 [S09] ✅ Pattern A dual-engine listeners registered (5 Target/Reference pairs)
 S09: UI refreshed for target mode
 [S09] Updated calculated display values for target mode
 [S09] Updated calculated display values for target mode
 S10: Section rendered - initializing Self-Contained State Module.
 S10: Simplified global StateManager listeners added
 S10: ModeManager exposed globally for cross-section integration.
 S11: Section rendered - initializing Self-Contained State Module.
 S11: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 S11: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 Error in envelopeTransmissionLosses module onSectionRendered: 
initializeSectionEventHandlers @ 4011-FieldManager.js:400
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ 4011-init.js:858Understand this errorAI
 [Section13] 🔗 Attaching StateManager listeners...
 [Section13] 🔗 Attaching CRITICAL upstream listeners...
 [Section13] ✅ ALL LISTENERS ATTACHED SUCCESSFULLY
 S13: Section rendered - initializing Pattern A Dual-State Module.
 [S13 DEBUG] Loading reference standard: "OBC SB10 5.5-6 Z6"
4011-Section13.js:100 [S13 DEBUG] Found reference values: {f_113: '7.1', j_115: '0.90', d_118: '81', d_119: '8.33'}
4011-Section13.js:129 S13: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6 {f_113: '7.1', j_115: '0.90', d_118: '81', d_119: '8.33', j_116: '3.3', …}
4011-Section13.js:1936 [Section13] 🔗 Attaching StateManager listeners...
4011-Section13.js:1986 [Section13] 🔗 Attaching CRITICAL upstream listeners...
4011-Section13.js:2024 [Section13] ✅ ALL LISTENERS ATTACHED SUCCESSFULLY
4011-Section13.js:2910 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
4011-Section13.js:2916 [Section13] 🎯 Mode captured at calculation start: target
4011-Section13.js:2922 [Section13] 🔄 Starting Reference Model calculations...
4011-Section13.js:2972 [Section13] Running Reference Model calculations...
4011-Section13.js:2986 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
4011-Section13.js:2439 [S13] REF HEATING: system=Gas, ted=0, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=0
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 0
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S04] S13 space oil volume changed (Reference): ref_f_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 0
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 S10: Reference listener triggered by ref_m_121, recalculating all.
 S10: Reference utilization factor dependency ref_m_121 changed.
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=0, afue=1, cop=3.663540445486518
 S10: Target listener triggered by m_121, recalculating all.
 S10: Target utilization factor dependency m_121 changed.
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=2.7, l_116=0, l_114=0
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=2.7, l_116=0, l_114=0
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=2.7, l_116=0, l_114=0
 [S04] f_115 listener fired - S13 oil
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S13 space gas volume changed: h_115
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [S13] Set up dropdown event handlers for 4 dropdowns
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 S13: Pattern A initialization complete.
 S14: Section rendered - initializing Pattern A Dual-State Module.
 S14: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.11539679999 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.428123200021 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.428123200021 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=-12913.428123200021, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=0
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): -1384.9665511797534
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = -1384.9665511797534
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 S10: Reference listener triggered by ref_m_121, recalculating all.
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
4011-Section14.js:1063 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1078 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
4011-Section14.js:1015 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
4011-Section14.js:1015 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
4011-Section14.js:1015 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
4011-Section14.js:1015 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
4011-Section14.js:1043 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
4011-Section14.js:1050 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
4011-Section14.js:1060 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
4011-Section14.js:1063 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1078 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 S10: Reference utilization factor dependency ref_m_121 changed.
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=26279.609839999983, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=-12913.343520000053, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=13486.4629835961
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): -1384.9574774774833
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = -1384.9574774774833
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=26279.609839999983, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 S14: Pattern A initialization complete.
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ 4011-init.js:858Understand this warningAI
 [S04] S15 reference electricity changed: ref_d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
 [S04] j_32 update: 0
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 76754.58647999995, K32: 2763.1651132799984
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ 4011-init.js:858Understand this warningAI
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ 4011-init.js:858Understand this warningAI
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
calculateReferenceModel @ 4011-Section15.js:1654
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ 4011-init.js:858Understand this warningAI
 [S04] S15 target electricity changed: d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
2 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateTargetModel @ 4011-Section04.js:1577
calculateAll @ 4011-Section04.js:1543
(anonymous) @ 4011-Section04.js:2440
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setCalculatedValue @ 4011-Section15.js:158
calculateValues @ 4011-Section15.js:1842
calculateTargetModel @ 4011-Section15.js:1701
calculateAll @ 4011-Section15.js:1390
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
calculateReferenceModel @ 4011-Section15.js:1654
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ 4011-init.js:858Understand this warningAI
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 76754.58647999995, K32: 2763.1651132799984
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
2 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2440
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setCalculatedValue @ 4011-Section15.js:158
calculateValues @ 4011-Section15.js:1842
calculateTargetModel @ 4011-Section15.js:1701
calculateAll @ 4011-Section15.js:1390
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
calculateReferenceModel @ 4011-Section15.js:1654
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ 4011-init.js:858Understand this warningAI
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=76754.58647999995, ref_k_32=2763.1651132799984 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for reference mode
 [S04DB] displayContext mode=reference j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
 [S04 DEBUG] Reference mode - j_32: ref_j_32=76754.58647999995 (NO fallback to Target)
 [S04 DEBUG] Reference mode - k_32: ref_k_32=2763.1651132799984 (NO fallback to Target)
 [S04 DEBUG] Reference mode - l_27: ref_l_27=36 (NO fallback to Target)
 [S04] Calculated display values updated for reference mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for reference mode
 [S04DB] displayContext mode=reference j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
 [S04 DEBUG] Reference mode - j_32: ref_j_32=76754.58647999995 (NO fallback to Target)
 [S04 DEBUG] Reference mode - k_32: ref_k_32=2763.1651132799984 (NO fallback to Target)
 [S04 DEBUG] Reference mode - l_27: ref_l_27=36 (NO fallback to Target)
 [S04] Calculated display values updated for reference mode
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
calculateReferenceModel @ 4011-Section15.js:1654
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ 4011-init.js:858Understand this warningAI
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ 4011-init.js:858Understand this warningAI
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=76754.58647999995, ref_k_32=2763.1651132799984 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
onSectionRendered @ 4011-Section15.js:2276
initializeSectionEventHandlers @ 4011-FieldManager.js:398
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ 4011-init.js:858Understand this warningAI
 Section03: Province selected: ON
4011-Section03.js:1068 S03: Synced province change "ON" to StateManager key "d_19"
4011-Section03.js:1126 City dropdown updated for ON - selected: Alexandria
4011-Section15.js:1486 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
forceTEDITELIUpdate @ 4011-SectionIntegrator.js:305
initializeTEDITELIIntegration @ 4011-SectionIntegrator.js:241
(anonymous) @ 4011-SectionIntegrator.js:187
initializeAllIntegrations @ 4011-SectionIntegrator.js:184
(anonymous) @ 4011-SectionIntegrator.js:106
renderAllSections @ 4011-FieldManager.js:474
(anonymous) @ 4011-init.js:858Understand this warningAI
4011-ReferenceToggle.js:200 [ReferenceToggle] Master Reference Toggle initialization complete
4011-StateManager.js:343 [StateManager] 🎯 h_10 setValue: "93.0" (state: default)
4011-StateManager.js:346 [StateManager] h_10 setValue stack trace:
setValue @ 4011-StateManager.js:346
(anonymous) @ 4011-StateManager.js:222
initializeFromFieldManager @ 4011-StateManager.js:216
initialize @ 4011-StateManager.js:193
(anonymous) @ index.html:1002
4011-Section02.js:1680 S02: Target defaults set from field definitions - overriding any localStorage empties
4011-Section02.js:1631 S02: Loaded and merged Target state from localStorage
4011-Section02.js:1756 S02: Reference defaults set from field definitions with overrides - overriding any localStorage empties
4011-Section02.js:869 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
4011-Section02.js:874 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 [S02] Refreshing UI for TARGET mode
 [S02] Updated h_12 (reporting year) slider = "2022" (target mode)
 [S02] Updated h_13 (service life) slider = "50" (target mode)
 [S02] Updated h_15 = "1427.2" (target mode)
 [S02] Updated i_17 = "8154" (target mode)
 [S02] Updated l_12 = "$0.1300" (target mode)
 [S02] Updated l_13 = "$0.5070" (target mode)
 [S02] Updated l_14 = "$1.6200" (target mode)
 [S02] Updated l_15 = "$180.00" (target mode)
 [S02] Updated l_16 = "$1.5000" (target mode)
 S03: Sliders initialized via FieldManager
 S03: Section rendered - initializing Self-Contained State Module.
 S03: ModeManager exposed globally for cross-section integration.
 S03: Checking climate data availability (attempt 1/10)
 S03: Climate data available (8) ['BC', 'AB', 'SK', 'MB', 'ON', 'QC', 'NU', 'NT']
 S03: Synced province "ON" to StateManager for cross-section communication
 City dropdown updated for ON - selected: Alexandria
 S03: Sliders initialized via FieldManager
 S03: Weather data updated for Alexandria, ON (Present)
 Section03: Province selected: ON
 S03: Synced province change "ON" to StateManager key "d_19"
 City dropdown updated for ON - selected: Alexandria
 S03: Weather data updated for Alexandria, ON (Present)
 S03: Self-Contained State Module initialization complete
 S04: Initializing Pattern A ModeManager
 S04: TargetState minimal defaults set (user inputs only)
 S04: TargetState loaded from localStorage
 S04: ReferenceState minimal defaults set (user inputs only)
 S04: ReferenceState loaded from localStorage
 [S01] j_32 listener: 0 → 0
 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 0
 S04: Synced Target defaults to StateManager
 S04: Pattern A initialization complete
 [S04] Found 17 editable fields
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
 [S04] j_32 update: 0
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 S05: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔄 [S05] updateCalculatedDisplayValues: mode=target
 S06: Pattern A initialization starting...
 S06: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 🟢 [S06-TAR] Storing d_43 = 0 (from d_44=0, d_45=0, d_46=0)
 [S04] S06 onsite renewable subtotal changed: d_43
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S06 offsite renewable subtotal changed: i_43
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 🔵 [S06-REF] Storing ref_d_43 = 0 (from d_44=0, d_45=0, d_46=0)
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 🔄 [S06] updateCalculatedDisplayValues: mode=target
 S06: Pattern A initialization complete.
 🚀 [S07] onSectionRendered: Initializing state defaults from FieldDefinitions
 🔧 [S07] TargetState.setDefaults: Initializing from FieldDefinitions
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_49
 ✅ [S07] getFieldDefault: Found default for d_49 = "User Defined"
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_51
 ✅ [S07] getFieldDefault: Found default for d_51 = "Heatpump"
 ✅ [S07] TargetState.setDefaults: d_49="User Defined", d_51="Heatpump"
 🌐 [S07] TargetState.setDefaults: Published to StateManager
 🔧 [S07] ReferenceState.setDefaults: Initializing from FieldDefinitions
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_49
 ✅ [S07] getFieldDefault: Found default for d_49 = "User Defined"
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_51
 ✅ [S07] getFieldDefault: Found default for d_51 = "Heatpump"
 ✅ [S07] ReferenceState.setDefaults: d_49="User Defined", d_51="Heatpump"
 [S04] S07 water heating fuel type changed (Reference): ref_d_51
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 🔗 [S07] ReferenceState.setDefaults: Published to StateManager with ref_ prefix
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_49
 ✅ [S07] getFieldDefault: Found default for d_49 = "User Defined"
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_51
 ✅ [S07] getFieldDefault: Found default for d_51 = "Heatpump"
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (TGT)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S04] e_51 listener fired - S07 gas
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] k_54 listener fired - S07 oil
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S07] 🚨 CRITICAL: ref_d_63 missing, using default 0 for Reference calculation
calculateWaterUse @ 4011-Section07.js:658
calculateReferenceModel @ 4011-Section07.js:988
calculateAll @ 4011-Section07.js:1031
onSectionRendered @ 4011-Section07.js:1433
initializeSectionEventHandlers @ 4011-FieldManager.js:398
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ index.html:1047Understand this warningAI
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (REF)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S08] S04 listeners setup complete
 [S04] S08 forestry offset changed: d_60
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S09] ✅ Pattern A dual-engine listeners registered (5 Target/Reference pairs)
4011-Section09.js:2208 [S09] ✅ Pattern A dual-engine listeners registered (5 Target/Reference pairs)
4011-Section09.js:311 S09: UI refreshed for target mode
4011-Section04.js:2687 [S04] S09 total internal gains changed (Reference): ref_h_71
4011-Section04.js:975 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
4011-Section04.js:1625 [S04] Reference model calculations complete
4011-Section04.js:1631 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
4011-Section04.js:450 [S04] 🔄 Updating calculated display values for target mode
4011-Section04.js:458 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
4011-Section04.js:539 [S04 DEBUG] Target mode - j_32: 0
4011-Section04.js:539 [S04 DEBUG] Target mode - k_32: 0
4011-Section04.js:539 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S09 heating internal gains changed (Reference): ref_i_71
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S09 cooling internal gains changed (Reference): ref_k_71
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Occupancy changed (Reference): ref_d_63
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
 [S04] j_32 update: 0
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (TGT)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (REF)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S09] Updated calculated display values for target mode
 [S09] Updated calculated display values for target mode
 [S09] ✅ Pattern A dual-engine listeners registered (5 Target/Reference pairs)
 S09: UI refreshed for target mode
 [S09] Updated calculated display values for target mode
 [S09] Updated calculated display values for target mode
 S10: Section rendered - initializing Self-Contained State Module.
 S10: Simplified global StateManager listeners added
 S10: ModeManager exposed globally for cross-section integration.
 S11: Section rendered - initializing Self-Contained State Module.
 S11: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 S11: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 Error in envelopeTransmissionLosses module onSectionRendered: 
initializeSectionEventHandlers @ 4011-FieldManager.js:400
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ index.html:1047Understand this errorAI
 [Section13] 🔗 Attaching StateManager listeners...
 [Section13] 🔗 Attaching CRITICAL upstream listeners...
 [Section13] ✅ ALL LISTENERS ATTACHED SUCCESSFULLY
 S13: Section rendered - initializing Pattern A Dual-State Module.
 [S13 DEBUG] Loading reference standard: "OBC SB10 5.5-6 Z6"
 [S13 DEBUG] Found reference values: {f_113: '7.1', j_115: '0.90', d_118: '81', d_119: '8.33'}
 S13: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6 {f_113: '7.1', j_115: '0.90', d_118: '81', d_119: '8.33', j_116: '3.3', …}
 [Section13] 🔗 Attaching StateManager listeners...
 [Section13] 🔗 Attaching CRITICAL upstream listeners...
 [Section13] ✅ ALL LISTENERS ATTACHED SUCCESSFULLY
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=0, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=0
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 0
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S04] S13 space oil volume changed (Reference): ref_f_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 0
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:574 [S04] Calculated display values updated for target mode
4011-Section10.js:2356 S10: Reference listener triggered by ref_m_121, recalculating all.
4011-Section10.js:2377 S10: Reference utilization factor dependency ref_m_121 changed.
4011-Section13.js:3270 [Section13] Reference results stored with ref_ prefix for downstream sections
4011-Section13.js:3273 [S13 DEBUG] Total Reference results stored: 34
4011-Section13.js:3019 [Section13] Reference Model calculations complete
4011-Section13.js:2924 [Section13] ✅ Reference Model complete
4011-Section13.js:2926 [Section13] 🔄 Starting Target Model calculations...
4011-Section13.js:3033 [Section13] Running Target Model calculations...
4011-Section13.js:2439 [S13] TGT HEATING: system=Heatpump, ted=0, afue=1, cop=3.663540445486518
4011-Section10.js:2347 S10: Target listener triggered by m_121, recalculating all.
 S10: Target utilization factor dependency m_121 changed.
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=2.7, l_116=0, l_114=0
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=2.7, l_116=0, l_114=0
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=2.7, l_116=0, l_114=0
 [S04] f_115 listener fired - S13 oil
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S13 space gas volume changed: h_115
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [S13] Set up dropdown event handlers for 4 dropdowns
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 S13: Pattern A initialization complete.
 S14: Section rendered - initializing Pattern A Dual-State Module.
 S14: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.11539679999 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.428123200021 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.428123200021 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=-12913.428123200021, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=0
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): -1384.9665511797534
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = -1384.9665511797534
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 S10: Reference listener triggered by ref_m_121, recalculating all.
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 S10: Reference utilization factor dependency ref_m_121 changed.
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=26279.609839999983, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=-12913.343520000053, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=13486.4629835961
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): -1384.9574774774833
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = -1384.9574774774833
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
4011-Section13.js:3033 [Section13] Running Target Model calculations...
4011-Section13.js:2439 [S13] TGT HEATING: system=Heatpump, ted=26279.609839999983, afue=1, cop=3.663540445486518
4011-Section13.js:2530 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
4011-Section13.js:2591 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
4011-Section13.js:3072 [Section13] Target Model calculations complete
4011-Section13.js:2928 [Section13] ✅ Target Model complete
4011-Section13.js:2955 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
4011-Section13.js:2961 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
4011-Section13.js:226 [Section13] 🔄 Updating calculated display values for target mode
4011-Section13.js:310 [Section13] Calculated display values updated for target mode
4011-Section14.js:1530 S14: Pattern A initialization complete.
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ index.html:1047Understand this warningAI
 [S04] S15 reference electricity changed: ref_d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
 [S04] j_32 update: 0
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 76754.58647999995, K32: 2763.1651132799984
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ index.html:1047Understand this warningAI
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ index.html:1047Understand this warningAI
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
calculateReferenceModel @ 4011-Section15.js:1654
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ index.html:1047Understand this warningAI
 [S04] S15 target electricity changed: d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
2 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateTargetModel @ 4011-Section04.js:1577
calculateAll @ 4011-Section04.js:1543
(anonymous) @ 4011-Section04.js:2440
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setCalculatedValue @ 4011-Section15.js:158
calculateValues @ 4011-Section15.js:1842
calculateTargetModel @ 4011-Section15.js:1701
calculateAll @ 4011-Section15.js:1390
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
calculateReferenceModel @ 4011-Section15.js:1654
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ index.html:1047Understand this warningAI
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 76754.58647999995, K32: 2763.1651132799984
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
2 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2440
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setCalculatedValue @ 4011-Section15.js:158
calculateValues @ 4011-Section15.js:1842
calculateTargetModel @ 4011-Section15.js:1701
calculateAll @ 4011-Section15.js:1390
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
calculateReferenceModel @ 4011-Section15.js:1654
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ index.html:1047Understand this warningAI
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=76754.58647999995, ref_k_32=2763.1651132799984 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for reference mode
 [S04DB] displayContext mode=reference j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
 [S04 DEBUG] Reference mode - j_32: ref_j_32=76754.58647999995 (NO fallback to Target)
 [S04 DEBUG] Reference mode - k_32: ref_k_32=2763.1651132799984 (NO fallback to Target)
 [S04 DEBUG] Reference mode - l_27: ref_l_27=36 (NO fallback to Target)
 [S04] Calculated display values updated for reference mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for reference mode
 [S04DB] displayContext mode=reference j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
 [S04 DEBUG] Reference mode - j_32: ref_j_32=76754.58647999995 (NO fallback to Target)
 [S04 DEBUG] Reference mode - k_32: ref_k_32=2763.1651132799984 (NO fallback to Target)
 [S04 DEBUG] Reference mode - l_27: ref_l_27=36 (NO fallback to Target)
 [S04] Calculated display values updated for reference mode
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
calculateReferenceModel @ 4011-Section15.js:1654
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ index.html:1047Understand this warningAI
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ index.html:1047Understand this warningAI
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=76754.58647999995, ref_k_32=2763.1651132799984 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
onSectionRendered @ 4011-Section15.js:2276
initializeSectionEventHandlers @ 4011-FieldManager.js:398
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
(anonymous) @ index.html:1047Understand this warningAI
 Section03: Province selected: ON
 S03: Synced province change "ON" to StateManager key "d_19"
 City dropdown updated for ON - selected: Alexandria
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
forceTEDITELIUpdate @ 4011-SectionIntegrator.js:305
initializeTEDITELIIntegration @ 4011-SectionIntegrator.js:241
(anonymous) @ 4011-SectionIntegrator.js:187
initializeAllIntegrations @ 4011-SectionIntegrator.js:184
(anonymous) @ 4011-SectionIntegrator.js:106
renderAllSections @ 4011-FieldManager.js:474
(anonymous) @ index.html:1047Understand this warningAI
 Section03: Province selected: ON
 S03: Synced province change "ON" to StateManager key "d_19"
 City dropdown updated for ON - selected: Alexandria
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
forceTEDITELIUpdate @ 4011-SectionIntegrator.js:305
initializeTEDITELIIntegration @ 4011-SectionIntegrator.js:241
(anonymous) @ 4011-SectionIntegrator.js:187
initializeAllIntegrations @ 4011-SectionIntegrator.js:184
(anonymous) @ 4011-SectionIntegrator.js:106
renderAllSections @ 4011-FieldManager.js:474
(anonymous) @ index.html:1047Understand this warningAI
 [StateManager] 🎯 h_10 setValue: "93.0" (state: default)
 [StateManager] h_10 setValue stack trace:
setValue @ 4011-StateManager.js:346
(anonymous) @ 4011-StateManager.js:222
initializeFromFieldManager @ 4011-StateManager.js:216
initialize @ 4011-StateManager.js:193
initialize @ 4011-Calculator.js:60
(anonymous) @ index.html:1067
 S02: Target defaults set from field definitions - overriding any localStorage empties
 S02: Loaded and merged Target state from localStorage
 S02: Reference defaults set from field definitions with overrides - overriding any localStorage empties
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 [S02] Refreshing UI for TARGET mode
 [S02] Updated h_12 (reporting year) slider = "2022" (target mode)
 [S02] Updated h_13 (service life) slider = "50" (target mode)
 [S02] Updated h_15 = "1427.2" (target mode)
 [S02] Updated i_17 = "8154" (target mode)
 [S02] Updated l_12 = "$0.1300" (target mode)
 [S02] Updated l_13 = "$0.5070" (target mode)
 [S02] Updated l_14 = "$1.6200" (target mode)
 [S02] Updated l_15 = "$180.00" (target mode)
 [S02] Updated l_16 = "$1.5000" (target mode)
 S03: Sliders initialized via FieldManager
 S03: Section rendered - initializing Self-Contained State Module.
 S03: ModeManager exposed globally for cross-section integration.
 S03: Checking climate data availability (attempt 1/10)
 S03: Climate data available (8) ['BC', 'AB', 'SK', 'MB', 'ON', 'QC', 'NU', 'NT']
 S03: Synced province "ON" to StateManager for cross-section communication
 City dropdown updated for ON - selected: Alexandria
 S03: Sliders initialized via FieldManager
 S03: Weather data updated for Alexandria, ON (Present)
 Section03: Province selected: ON
 S03: Synced province change "ON" to StateManager key "d_19"
 City dropdown updated for ON - selected: Alexandria
 S03: Weather data updated for Alexandria, ON (Present)
 S03: Self-Contained State Module initialization complete
 S04: Initializing Pattern A ModeManager
 S04: TargetState minimal defaults set (user inputs only)
 S04: TargetState loaded from localStorage
4011-Section04.js:262 S04: ReferenceState minimal defaults set (user inputs only)
4011-Section04.js:300 S04: ReferenceState loaded from localStorage
4011-Section01.js:1110 [S01] j_32 listener: 0 → 0
4011-Section01.js:1111 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 0
4011-Section04.js:347 S04: Synced Target defaults to StateManager
4011-Section04.js:350 S04: Pattern A initialization complete
4011-Section04.js:2360 [S04] Found 17 editable fields
4011-Section04.js:1534 [S04] Starting dual-engine Excel-compliant calculations
4011-Section04.js:975 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
4011-Section04.js:94 [S04] j_32 update: 0
4011-Section04.js:975 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 S05: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔍 [S02DB] storeReferenceResults: ref_d_12=A-Assembly stored in StateManager
 [S02] Reference results stored with ref_ prefix for downstream sections
 🔄 [S05] updateCalculatedDisplayValues: mode=target
 S06: Pattern A initialization starting...
 S06: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 🟢 [S06-TAR] Storing d_43 = 0 (from d_44=0, d_45=0, d_46=0)
 [S04] S06 onsite renewable subtotal changed: d_43
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S06 offsite renewable subtotal changed: i_43
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 🔵 [S06-REF] Storing ref_d_43 = 0 (from d_44=0, d_45=0, d_46=0)
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 🔄 [S06] updateCalculatedDisplayValues: mode=target
 S06: Pattern A initialization complete.
 🚀 [S07] onSectionRendered: Initializing state defaults from FieldDefinitions
 🔧 [S07] TargetState.setDefaults: Initializing from FieldDefinitions
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_49
 ✅ [S07] getFieldDefault: Found default for d_49 = "User Defined"
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_51
 ✅ [S07] getFieldDefault: Found default for d_51 = "Heatpump"
 ✅ [S07] TargetState.setDefaults: d_49="User Defined", d_51="Heatpump"
 🌐 [S07] TargetState.setDefaults: Published to StateManager
 🔧 [S07] ReferenceState.setDefaults: Initializing from FieldDefinitions
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_49
 ✅ [S07] getFieldDefault: Found default for d_49 = "User Defined"
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_51
 ✅ [S07] getFieldDefault: Found default for d_51 = "Heatpump"
 ✅ [S07] ReferenceState.setDefaults: d_49="User Defined", d_51="Heatpump"
 [S04] S07 water heating fuel type changed (Reference): ref_d_51
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 🔗 [S07] ReferenceState.setDefaults: Published to StateManager with ref_ prefix
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_49
 ✅ [S07] getFieldDefault: Found default for d_49 = "User Defined"
 🔍 [S07] getFieldDefault: Looking for default for fieldId=d_51
 ✅ [S07] getFieldDefault: Found default for d_51 = "Heatpump"
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (TGT)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S04] e_51 listener fired - S07 gas
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] k_54 listener fired - S07 oil
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S07] 🚨 CRITICAL: ref_d_63 missing, using default 0 for Reference calculation
calculateWaterUse @ 4011-Section07.js:658
calculateReferenceModel @ 4011-Section07.js:988
calculateAll @ 4011-Section07.js:1031
onSectionRendered @ 4011-Section07.js:1433
initializeSectionEventHandlers @ 4011-FieldManager.js:398
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (REF)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S08] S04 listeners setup complete
 [S04] S08 forestry offset changed: d_60
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S09] ✅ Pattern A dual-engine listeners registered (5 Target/Reference pairs)
 [S09] ✅ Pattern A dual-engine listeners registered (5 Target/Reference pairs)
 S09: UI refreshed for target mode
 [S04] S09 total internal gains changed (Reference): ref_h_71
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S09 heating internal gains changed (Reference): ref_i_71
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S09 cooling internal gains changed (Reference): ref_k_71
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Occupancy changed (Reference): ref_d_63
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
 [S04] j_32 update: 0
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
4011-Section04.js:539 [S04 DEBUG] Target mode - k_32: 0
4011-Section04.js:539 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:574 [S04] Calculated display values updated for target mode
4011-Section07.js:806 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (TGT)
4011-Section07.js:841 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
4011-Section07.js:806 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (REF)
4011-Section07.js:841 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
4011-Section09.js:383 [S09] Updated calculated display values for target mode
4011-Section09.js:383 [S09] Updated calculated display values for target mode
4011-Section09.js:2208 [S09] ✅ Pattern A dual-engine listeners registered (5 Target/Reference pairs)
4011-Section09.js:311 S09: UI refreshed for target mode
 [S09] Updated calculated display values for target mode
 [S09] Updated calculated display values for target mode
 S10: Section rendered - initializing Self-Contained State Module.
 S10: Simplified global StateManager listeners added
 S10: ModeManager exposed globally for cross-section integration.
 S11: Section rendered - initializing Self-Contained State Module.
 S11: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 S11: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 Error in envelopeTransmissionLosses module onSectionRendered: 
initializeSectionEventHandlers @ 4011-FieldManager.js:400
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this errorAI
 [Section13] 🔗 Attaching StateManager listeners...
 [Section13] 🔗 Attaching CRITICAL upstream listeners...
 [Section13] ✅ ALL LISTENERS ATTACHED SUCCESSFULLY
 S13: Section rendered - initializing Pattern A Dual-State Module.
 [S13 DEBUG] Loading reference standard: "OBC SB10 5.5-6 Z6"
 [S13 DEBUG] Found reference values: {f_113: '7.1', j_115: '0.90', d_118: '81', d_119: '8.33'}
 S13: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6 {f_113: '7.1', j_115: '0.90', d_118: '81', d_119: '8.33', j_116: '3.3', …}
 [Section13] 🔗 Attaching StateManager listeners...
 [Section13] 🔗 Attaching CRITICAL upstream listeners...
 [Section13] ✅ ALL LISTENERS ATTACHED SUCCESSFULLY
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=0, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=0
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 0
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S04] S13 space oil volume changed (Reference): ref_f_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 0
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 S10: Reference listener triggered by ref_m_121, recalculating all.
 S10: Reference utilization factor dependency ref_m_121 changed.
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=0, afue=1, cop=3.663540445486518
 S10: Target listener triggered by m_121, recalculating all.
 S10: Target utilization factor dependency m_121 changed.
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=2.7, l_116=0, l_114=0
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=2.7, l_116=0, l_114=0
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=2.7, l_116=0, l_114=0
 [S04] f_115 listener fired - S13 oil
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S13 space gas volume changed: h_115
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
4011-Section04.js:539 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:574 [S04] Calculated display values updated for target mode
4011-Section13.js:3072 [Section13] Target Model calculations complete
4011-Section13.js:2928 [Section13] ✅ Target Model complete
4011-Section13.js:2955 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
4011-Section13.js:2961 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
4011-Section13.js:226 [Section13] 🔄 Updating calculated display values for target mode
4011-Section13.js:310 [Section13] Calculated display values updated for target mode
4011-Section13.js:2288 [S13] Set up dropdown event handlers for 4 dropdowns
4011-Section13.js:226 [Section13] 🔄 Updating calculated display values for target mode
4011-Section13.js:310 [Section13] Calculated display values updated for target mode
 S13: Pattern A initialization complete.
 S14: Section rendered - initializing Pattern A Dual-State Module.
 S14: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.11539679999 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.428123200021 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.428123200021 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=-12913.428123200021, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=0
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): -1384.9665511797534
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = -1384.9665511797534
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 S10: Reference listener triggered by ref_m_121, recalculating all.
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 S10: Reference utilization factor dependency ref_m_121 changed.
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = -12913.343520000053 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = -12913.343520000053 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 23178.39 - 120694.93352 = -97516.54352
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=26279.609839999983, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=-12913.343520000053, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=13486.4629835961
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): -1384.9574774774833
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = -1384.9574774774833
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=26279.609839999983, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 S14: Pattern A initialization complete.
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
 [S04] S15 reference electricity changed: ref_d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
 [S04] j_32 update: 0
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 76754.58647999995, K32: 2763.1651132799984
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
calculateReferenceModel @ 4011-Section15.js:1654
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
 [S04] S15 target electricity changed: d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
2 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateTargetModel @ 4011-Section04.js:1577
calculateAll @ 4011-Section04.js:1543
(anonymous) @ 4011-Section04.js:2440
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setCalculatedValue @ 4011-Section15.js:158
calculateValues @ 4011-Section15.js:1842
calculateTargetModel @ 4011-Section15.js:1701
calculateAll @ 4011-Section15.js:1390
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
calculateReferenceModel @ 4011-Section15.js:1654
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
4011-Section04.js:975 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 76754.58647999995, K32: 2763.1651132799984
24011-Section05.js:266 🔄 [S05] updateCalculatedDisplayValues: mode=target
24011-Section05.js:266 🔄 [S05] updateCalculatedDisplayValues: mode=target
24011-Section15.js:1486 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2440
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setCalculatedValue @ 4011-Section15.js:158
calculateValues @ 4011-Section15.js:1842
calculateTargetModel @ 4011-Section15.js:1701
calculateAll @ 4011-Section15.js:1390
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
calculateReferenceModel @ 4011-Section15.js:1654
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
4011-Section04.js:1625 [S04] Reference model calculations complete
4011-Section04.js:1631 [S04DB] storeReference: ref_j_32=76754.58647999995, ref_k_32=2763.1651132799984 | current target j_32=0, k_32=0
4011-Section04.js:450 [S04] 🔄 Updating calculated display values for reference mode
4011-Section04.js:458 [S04DB] displayContext mode=reference j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
4011-Section04.js:529 [S04 DEBUG] Reference mode - j_32: ref_j_32=76754.58647999995 (NO fallback to Target)
4011-Section04.js:529 [S04 DEBUG] Reference mode - k_32: ref_k_32=2763.1651132799984 (NO fallback to Target)
4011-Section04.js:529 [S04 DEBUG] Reference mode - l_27: ref_l_27=36 (NO fallback to Target)
 [S04] Calculated display values updated for reference mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for reference mode
 [S04DB] displayContext mode=reference j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
 [S04 DEBUG] Reference mode - j_32: ref_j_32=76754.58647999995 (NO fallback to Target)
 [S04 DEBUG] Reference mode - k_32: ref_k_32=2763.1651132799984 (NO fallback to Target)
 [S04 DEBUG] Reference mode - l_27: ref_l_27=36 (NO fallback to Target)
 [S04] Calculated display values updated for reference mode
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
calculateReferenceModel @ 4011-Section15.js:1654
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
calculateReferenceModel @ 4011-Section15.js:1649
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setReferenceCalculatedValue @ 4011-Section04.js:123
setRefCalculatedValue @ 4011-Section04.js:1603
calculateRow32 @ 4011-Section04.js:983
calculateReferenceModel @ 4011-Section04.js:1616
calculateAll @ 4011-Section04.js:1548
(anonymous) @ 4011-Section04.js:2448
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setRefValueIfChanged @ 4011-Section15.js:1418
calculateReferenceModel @ 4011-Section15.js:1551
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
initializeSectionEventHandlers @ 4011-FieldManager.js:386
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=76754.58647999995, ref_k_32=2763.1651132799984 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:574 [S04] Calculated display values updated for target mode
4011-Section15.js:1486 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
initializeEventHandlers @ 4011-Section15.js:2251
onSectionRendered @ 4011-Section15.js:2276
initializeSectionEventHandlers @ 4011-FieldManager.js:398
renderSection @ 4011-FieldManager.js:443
(anonymous) @ 4011-FieldManager.js:470
renderAllSections @ 4011-FieldManager.js:469
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
4011-Section03.js:1059 Section03: Province selected: ON
4011-Section03.js:1068 S03: Synced province change "ON" to StateManager key "d_19"
4011-Section03.js:1126 City dropdown updated for ON - selected: Alexandria
4011-Section15.js:1486 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
forceTEDITELIUpdate @ 4011-SectionIntegrator.js:305
initializeTEDITELIIntegration @ 4011-SectionIntegrator.js:241
(anonymous) @ 4011-SectionIntegrator.js:187
initializeAllIntegrations @ 4011-SectionIntegrator.js:184
(anonymous) @ 4011-SectionIntegrator.js:106
renderAllSections @ 4011-FieldManager.js:474
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
4011-Section03.js:1059 Section03: Province selected: ON
4011-Section03.js:1068 S03: Synced province change "ON" to StateManager key "d_19"
4011-Section03.js:1126 City dropdown updated for ON - selected: Alexandria
4011-Section15.js:1486 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
forceTEDITELIUpdate @ 4011-SectionIntegrator.js:305
initializeTEDITELIIntegration @ 4011-SectionIntegrator.js:241
(anonymous) @ 4011-SectionIntegrator.js:187
initializeAllIntegrations @ 4011-SectionIntegrator.js:184
(anonymous) @ 4011-SectionIntegrator.js:106
renderAllSections @ 4011-FieldManager.js:474
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
index.html:1079 TEUI Calculator 4.011 initialization complete
4011-Section01.js:1014 [S01DB] upstream snapshot {ref_j_32: 76754.58647999995, ref_k_32: 2763.1651132799984, j_32: 0, k_32: 0, ref_h_15: '1427.20', …}
 🔍 [S01DB] updateTEUIDisplay START: e_10=53.779839181614314, h_10=93.0, useType=Utility Bills
 🔍 [S01DB] UPDATING h_10: 0.0 (from j_32=0, area=1427.2)
 ✅ [S01] CALCULATION CHAIN COMPLETE - All values finalized including h_10
4 [S15] Missing critical upstream Reference values: ref_g_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setCalculatedValue @ 4011-Section12.js:1144
calculateVolumeMetrics @ 4011-Section12.js:1395
calculateReferenceModel @ 4011-Section12.js:2203
calculateAll @ 4011-Section12.js:2175
(anonymous) @ 4011-SectionIntegrator.js:656
setTimeout
forceVolumeMetricsUpdate @ 4011-SectionIntegrator.js:650
initializeVolumeMetricsIntegration @ 4011-SectionIntegrator.js:589
(anonymous) @ 4011-SectionIntegrator.js:187
initializeAllIntegrations @ 4011-SectionIntegrator.js:184
(anonymous) @ 4011-SectionIntegrator.js:106
renderAllSections @ 4011-FieldManager.js:474
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
4 [S15] Missing critical upstream Reference values: ref_g_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setCalculatedValue @ 4011-Section12.js:1144
calculateVolumeMetrics @ 4011-Section12.js:1401
calculateReferenceModel @ 4011-Section12.js:2203
calculateAll @ 4011-Section12.js:2175
(anonymous) @ 4011-SectionIntegrator.js:656
setTimeout
forceVolumeMetricsUpdate @ 4011-SectionIntegrator.js:650
initializeVolumeMetricsIntegration @ 4011-SectionIntegrator.js:589
(anonymous) @ 4011-SectionIntegrator.js:187
initializeAllIntegrations @ 4011-SectionIntegrator.js:184
(anonymous) @ 4011-SectionIntegrator.js:106
renderAllSections @ 4011-FieldManager.js:474
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S12] U-agg REF: TB%=0 → g_101=0.103987, g_102=0.270270
4 [S15] Missing critical upstream Reference values: ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setCalculatedValue @ 4011-Section12.js:1144
calculateCombinedUValue @ 4011-Section12.js:1576
calculateReferenceModel @ 4011-Section12.js:2204
calculateAll @ 4011-Section12.js:2175
(anonymous) @ 4011-SectionIntegrator.js:656
setTimeout
forceVolumeMetricsUpdate @ 4011-SectionIntegrator.js:650
initializeVolumeMetricsIntegration @ 4011-SectionIntegrator.js:589
(anonymous) @ 4011-SectionIntegrator.js:187
initializeAllIntegrations @ 4011-SectionIntegrator.js:184
(anonymous) @ 4011-SectionIntegrator.js:106
renderAllSections @ 4011-FieldManager.js:474
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
4 [S15] Missing critical upstream Reference values: ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setCalculatedValue @ 4011-Section12.js:1144
calculateCombinedUValue @ 4011-Section12.js:1577
calculateReferenceModel @ 4011-Section12.js:2204
calculateAll @ 4011-Section12.js:2175
(anonymous) @ 4011-SectionIntegrator.js:656
setTimeout
forceVolumeMetricsUpdate @ 4011-SectionIntegrator.js:650
initializeVolumeMetricsIntegration @ 4011-SectionIntegrator.js:589
(anonymous) @ 4011-SectionIntegrator.js:187
initializeAllIntegrations @ 4011-SectionIntegrator.js:184
(anonymous) @ 4011-SectionIntegrator.js:106
renderAllSections @ 4011-FieldManager.js:474
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
4 [S15] Missing critical upstream Reference values: ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setCalculatedValue @ 4011-Section12.js:1144
calculateCombinedUValue @ 4011-Section12.js:1578
calculateReferenceModel @ 4011-Section12.js:2204
calculateAll @ 4011-Section12.js:2175
(anonymous) @ 4011-SectionIntegrator.js:656
setTimeout
forceVolumeMetricsUpdate @ 4011-SectionIntegrator.js:650
initializeVolumeMetricsIntegration @ 4011-SectionIntegrator.js:589
(anonymous) @ 4011-SectionIntegrator.js:187
initializeAllIntegrations @ 4011-SectionIntegrator.js:184
(anonymous) @ 4011-SectionIntegrator.js:106
renderAllSections @ 4011-FieldManager.js:474
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
 S10: Reference listener triggered by ref_i_103, recalculating all.
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 348.34632031929505 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 348.34632031929505 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 36440.079840319355 - 120694.93352 = -84254.85367968064
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 348.34632031929505 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 348.34632031929505 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 36440.079840319355 - 120694.93352 = -84254.85367968064
4 [S15] Missing critical upstream Reference values: ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setCalculatedValue @ 4011-Section10.js:367
calculateSubtotals @ 4011-Section10.js:1947
calculateTargetModel @ 4011-Section10.js:1632
calculateAll @ 4011-Section10.js:1616
(anonymous) @ 4011-Section10.js:2359
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setCalculatedValue @ 4011-Section12.js:1144
calculateAirLeakageHeatLoss @ 4011-Section12.js:1859
calculateReferenceModel @ 4011-Section12.js:2209
calculateAll @ 4011-Section12.js:2175
(anonymous) @ 4011-SectionIntegrator.js:656
setTimeout
forceVolumeMetricsUpdate @ 4011-SectionIntegrator.js:650
initializeVolumeMetricsIntegration @ 4011-SectionIntegrator.js:589
(anonymous) @ 4011-SectionIntegrator.js:187
initializeAllIntegrations @ 4011-SectionIntegrator.js:184
(anonymous) @ 4011-SectionIntegrator.js:106
renderAllSections @ 4011-FieldManager.js:474
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 348.34632031929505 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 348.34632031929505 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 36440.079840319355 - 120694.93352 = -84254.85367968064
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 348.34632031929505 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 348.34632031929505 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 36440.079840319355 - 120694.93352 = -84254.85367968064
4 [S15] Missing critical upstream Reference values: ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setCalculatedValue @ 4011-Section10.js:367
calculateSubtotalsReference @ 4011-Section10.js:1793
calculateReferenceModel @ 4011-Section10.js:1658
calculateAll @ 4011-Section10.js:1617
(anonymous) @ 4011-Section10.js:2359
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:401
setCalculatedValue @ 4011-Section12.js:1144
calculateAirLeakageHeatLoss @ 4011-Section12.js:1859
calculateReferenceModel @ 4011-Section12.js:2209
calculateAll @ 4011-Section12.js:2175
(anonymous) @ 4011-SectionIntegrator.js:656
setTimeout
forceVolumeMetricsUpdate @ 4011-SectionIntegrator.js:650
initializeVolumeMetricsIntegration @ 4011-SectionIntegrator.js:589
(anonymous) @ 4011-SectionIntegrator.js:187
initializeAllIntegrations @ 4011-SectionIntegrator.js:184
(anonymous) @ 4011-SectionIntegrator.js:106
renderAllSections @ 4011-FieldManager.js:474
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
 S10: Reference utilization factor dependency ref_i_103 changed.
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 348.34632031929505 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 348.34632031929505 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 36440.079840319355 - 120694.93352 = -84254.85367968064
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 348.34632031929505 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 348.34632031929505 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 36440.079840319355 - 120694.93352 = -84254.85367968064
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 348.34632031929505 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 348.34632031929505 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 36440.079840319355 - 120694.93352 = -84254.85367968064
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 348.34632031929505 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 348.34632031929505 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 36440.079840319355 - 120694.93352 = -84254.85367968064
 [S12DB] REF CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
 [S12DB] REF h_101 calc: (4600*0.10398737074942146*24)/1000 = 11.48020573073613
 [S12DB] REF i_101 result: 11.48020573073613 * 2124.49 = 24389.582272891595
4011-Section12.js:2087 [S12DB] REF g_104 calc: (0.10398737074942146*2124.49 + 0.27027027027027023*1100.42)/3224.9100009999997 = 0.16072725748424668
4011-Section12.js:2111 [S12DB] REF ROW104: i_101=24389.582272891595, i_102=13990.20454054054, i_103=36440.079840319355 → i_104=74819.8666537515
4011-Section12.js:2114 [S12DB] REF ROW104: h_21="Capacitance", k_98=0 → k_104=0
44011-Section15.js:1486 [S15] Missing critical upstream Reference values: ref_i_104
calculateReferenceModel @ 4011-Section15.js:1486
calculateAll @ 4011-Section15.js:1389
(anonymous) @ 4011-Section15.js:2104
(anonymous) @ 4011-StateManager.js:543
notifyListeners @ 4011-StateManager.js:541
setValue @ 4011-StateManager.js:419
setCalculatedValue @ 4011-Section12.js:1144
calculateEnvelopeTotals @ 4011-Section12.js:2127
calculateReferenceModel @ 4011-Section12.js:2220
calculateAll @ 4011-Section12.js:2175
(anonymous) @ 4011-SectionIntegrator.js:656
setTimeout
forceVolumeMetricsUpdate @ 4011-SectionIntegrator.js:650
initializeVolumeMetricsIntegration @ 4011-SectionIntegrator.js:589
(anonymous) @ 4011-SectionIntegrator.js:187
initializeAllIntegrations @ 4011-SectionIntegrator.js:184
(anonymous) @ 4011-SectionIntegrator.js:106
renderAllSections @ 4011-FieldManager.js:474
initialize @ 4011-Calculator.js:66
(anonymous) @ index.html:1067Understand this warningAI
4011-Section04.js:2447 [S04] S15 reference electricity changed: ref_d_136
4011-Section04.js:1534 [S04] Starting dual-engine Excel-compliant calculations
4011-Section04.js:975 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 109455.12186398954, K32: 5582.211215063467
4011-Section04.js:94 [S04] j_32 update: 109455.12186398954
4011-Section01.js:1110 [S01] j_32 listener: 0 → 109455.12186398954
4011-Section01.js:1111 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 109455.12186398954
24011-Section05.js:266 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 151574.45313375146, K32: 5456.680312815052
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=151574.45313375146, ref_k_32=5456.680312815052 | current target j_32=109455.12186398954, k_32=5582.211215063467
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=109455.12186398954 ref_j_32=151574.45313375146 k_32=5582.211215063467 ref_k_32=5456.680312815052
 [S04 DEBUG] Target mode - j_32: 109455.12186398954
 [S04 DEBUG] Target mode - k_32: 5582.211215063467
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=109455.12186398954 ref_j_32=151574.45313375146 k_32=5582.211215063467 ref_k_32=5456.680312815052
 [S04 DEBUG] Target mode - j_32: 109455.12186398954
 [S04 DEBUG] Target mode - k_32: 5582.211215063467
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S12DB] STORED for S15: ref_d_101=2124.49
 [S12DB] STORED for S15: ref_d_102=1100.42
 [S12DB] STORED for S15: ref_g_101=0.10398737074942146
 [S12DB] STORED for S15: ref_g_102=0.27027027027027023
 [S12DB] STORED for S15: ref_g_104=0.16072725748424668
 [S12DB] STORED for S15: ref_i_101=24389.582272891595
 [S12DB] STORED for S15: ref_i_102=13990.20454054054
 [S12DB] STORED for S15: ref_i_104=74819.8666537515
 [Section12] Reference results stored with ref_ prefix for downstream sections
 [S12] U-agg TGT: TB%=20 → g_101=0.145468, g_102=0.324324
 S10: Target listener triggered by i_103, recalculating all.
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 348.34632031929505 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 348.34632031929505 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 36440.079840319355 - 120694.93352 = -84254.85367968064
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=348.34632031929505, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=13486.4629835961
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 37.36018021442461
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 37.36018021442461
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 151574.45313375146, K32: 5456.680312815052
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=151574.45313375146, ref_k_32=5456.680312815052 | current target j_32=109455.12186398954, k_32=5582.211215063467
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=109455.12186398954 ref_j_32=151574.45313375146 k_32=5582.211215063467 ref_k_32=5456.680312815052
 [S04 DEBUG] Target mode - j_32: 109455.12186398954
 [S04 DEBUG] Target mode - k_32: 5582.211215063467
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=22984.064775760467, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [S04] S15 target electricity changed: d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 108555.56988325472, K32: 5536.334064045991
 [S04] j_32 update: 108555.56988325472
 [S01] j_32 listener: 109455.12186398954 → 108555.56988325472
 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 108555.56988325472
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 151574.45313375146, K32: 5456.680312815052
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=151574.45313375146, ref_k_32=5456.680312815052 | current target j_32=108555.56988325472, k_32=5536.334064045991
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=108555.56988325472 ref_j_32=151574.45313375146 k_32=5536.334064045991 ref_k_32=5456.680312815052
 [S04 DEBUG] Target mode - j_32: 108555.56988325472
 [S04 DEBUG] Target mode - k_32: 5536.334064045991
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=108555.56988325472 ref_j_32=151574.45313375146 k_32=5536.334064045991 ref_k_32=5456.680312815052
 [S04 DEBUG] Target mode - j_32: 108555.56988325472
 [S04 DEBUG] Target mode - k_32: 5536.334064045991
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=348.34632031929505, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=13486.4629835961
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 37.36018021442461
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
4011-Section13.js:3258 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 37.36018021442461
4011-Section13.js:3270 [Section13] Reference results stored with ref_ prefix for downstream sections
4011-Section13.js:3273 [S13 DEBUG] Total Reference results stored: 34
4011-Section13.js:3019 [Section13] Reference Model calculations complete
4011-Section13.js:2924 [Section13] ✅ Reference Model complete
4011-Section13.js:2926 [Section13] 🔄 Starting Target Model calculations...
4011-Section13.js:3033 [Section13] Running Target Model calculations...
4011-Section13.js:2439 [S13] TGT HEATING: system=Heatpump, ted=22984.064775760467, afue=1, cop=3.663540445486518
4011-Section13.js:2530 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
4011-Section13.js:2591 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
4011-Section13.js:3072 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 348.34632031929505 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 348.34632031929505 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 36440.079840319355 - 120694.93352 = -84254.85367968064
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 348.34632031929505 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 348.34632031929505 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 36440.079840319355 - 120694.93352 = -84254.85367968064
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 348.34632031929505 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 348.34632031929505 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 36440.079840319355 - 120694.93352 = -84254.85367968064
 S10: Target utilization factor dependency i_103 changed.
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 348.34632031929505 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 348.34632031929505 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 36440.079840319355 - 120694.93352 = -84254.85367968064
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 348.34632031929505 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 348.34632031929505 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 36440.079840319355 - 120694.93352 = -84254.85367968064
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 348.34632031929505 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 348.34632031929505 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 36440.079840319355 - 120694.93352 = -84254.85367968064
 [S14 DEBUG] ❌ getRefValue(i_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 0 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 348.34632031929505 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 348.34632031929505 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 0 + 0 + 36440.079840319355 - 120694.93352 = -84254.85367968064
 [S12DB] TGT CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
 [S12DB] TGT h_101 calc: (4600*0.14546768522069703*24)/1000 = 16.059632448364955
 [S12DB] TGT i_101 result: 16.059632448364955 * 2124.49 = 34118.52854022686
 [S12DB] TGT g_104 calc: (0.14546768522069703*2124.49 + 0.3243243243243243*1100.42)/3224.9100009999997 = 0.20649804656284781
 [S12DB] TGT ROW104: i_101=34118.52854022686, i_102=16788.24544864865, i_103=19882.844935760477 → i_104=70789.61892463599
 [S12DB] TGT ROW104: h_21="Capacitance", k_98=0 → k_104=0
 [Section13] 📡 🔥 i_104 (TRANSMISSION LOSS) listener triggered - S11 thermal bridges changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=348.34632031929505, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=13486.4629835961
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 37.36018021442461
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 37.36018021442461
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=22984.064775760467, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 i_104 (TRANSMISSION LOSS) listener triggered - S11 thermal bridges changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=348.34632031929505, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=13486.4629835961
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 37.36018021442461
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 37.36018021442461
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=22984.064775760467, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=348.34632031929505, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=13486.4629835961
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 37.36018021442461
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 37.36018021442461
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=22984.064775760467, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=348.34632031929505, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=13486.4629835961
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 37.36018021442461
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 37.36018021442461
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
4011-Section13.js:2439 [S13] TGT HEATING: system=Heatpump, ted=22984.064775760467, afue=1, cop=3.663540445486518
4011-Section13.js:2530 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
4011-Section13.js:2591 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
4011-Section13.js:3072 [Section13] Target Model calculations complete
4011-Section13.js:2928 [Section13] ✅ Target Model complete
4011-Section13.js:2955 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
4011-Section13.js:2961 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
4011-Section13.js:226 [Section13] 🔄 Updating calculated display values for target mode
4011-Section13.js:310 [Section13] Calculated display values updated for target mode
4011-Section12.js:240 [S12DB] g_104 DISPLAY (target): 0.20649804662687998
4011-Section12.js:244 [Section12] Calculated display values updated for target mode
4011-Dependency.js:116 [DependencyGraph] Data loaded: 388 nodes, 662 links
4011-Dependency.js:718 [DependencyGraph] Calculating node sizes...
 [CLOCK] Starting initial load timing
 S10: Target listener triggered by i_97, recalculating all.
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 59880.63133429077 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 59880.63133429077 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 0 + 36440.079840319355 - 120694.93352 = -24722.568665709186
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=59880.63133429077, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=13486.4629835961
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 6422.204132806817
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 6422.204132806817
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 151574.45313375146, K32: 5456.680312815052
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=151574.45313375146, ref_k_32=5456.680312815052 | current target j_32=108555.56988325472, k_32=5536.334064045991
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=108555.56988325472 ref_j_32=151574.45313375146 k_32=5536.334064045991 ref_k_32=5456.680312815052
 [S04 DEBUG] Target mode - j_32: 108555.56988325472
 [S04 DEBUG] Target mode - k_32: 5536.334064045991
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=82516.34978973193, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [S04] S15 target electricity changed: d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 124805.50240066837, K32: 6365.080622434087
 [S04] j_32 update: 124805.50240066837
 [S01] j_32 listener: 108555.56988325472 → 124805.50240066837
 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 124805.50240066837
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 151574.45313375146, K32: 5456.680312815052
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=151574.45313375146, ref_k_32=5456.680312815052 | current target j_32=124805.50240066837, k_32=6365.080622434087
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=124805.50240066837 ref_j_32=151574.45313375146 k_32=6365.080622434087 ref_k_32=5456.680312815052
 [S04 DEBUG] Target mode - j_32: 124805.50240066837
 [S04 DEBUG] Target mode - k_32: 6365.080622434087
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=124805.50240066837 ref_j_32=151574.45313375146 k_32=6365.080622434087 ref_k_32=5456.680312815052
 [S04 DEBUG] Target mode - j_32: 124805.50240066837
 [S04 DEBUG] Target mode - k_32: 6365.080622434087
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=59880.63133429077, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=13486.4629835961
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 6422.204132806817
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 6422.204132806817
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=82516.34978973193, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
4011-Section13.js:2961 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
4011-Section13.js:226 [Section13] 🔄 Updating calculated display values for target mode
4011-Section13.js:310 [Section13] Calculated display values updated for target mode
4011-Section14.js:1015 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
4011-Section14.js:1015 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
4011-Section14.js:1015 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
4011-Section14.js:1043 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
4011-Section14.js:1050 [S14 DEBUG] ✅ ref_d_127 = 59880.63133429077 (should be numeric, not NaN)
4011-Section14.js:1060 [S14 DEBUG] ✅ Stored ref_d_127 = 59880.63133429077 in StateManager
4011-Section14.js:1063 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1078 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 0 + 36440.079840319355 - 120694.93352 = -24722.568665709186
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 59880.63133429077 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 59880.63133429077 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 0 + 36440.079840319355 - 120694.93352 = -24722.568665709186
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 59880.63133429077 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 59880.63133429077 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 0 + 36440.079840319355 - 120694.93352 = -24722.568665709186
 S10: Target utilization factor dependency i_97 changed.
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 59880.63133429077 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 59880.63133429077 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 0 + 36440.079840319355 - 120694.93352 = -24722.568665709186
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_97): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 59880.63133429077 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 59880.63133429077 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 0 + 36440.079840319355 - 120694.93352 = -24722.568665709186
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 59880.63133429077 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 59880.63133429077 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 0 + 36440.079840319355 - 120694.93352 = -24722.568665709186
 [S14 DEBUG] ❌ getRefValue(i_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 0 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 59880.63133429077 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 59880.63133429077 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 0 + 36440.079840319355 - 120694.93352 = -24722.568665709186
 S10: Target listener triggered by i_98, recalculating all.
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=13486.4629835961
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 151574.45313375146, K32: 5456.680312815052
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=151574.45313375146, ref_k_32=5456.680312815052 | current target j_32=124805.50240066837, k_32=6365.080622434087
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=124805.50240066837 ref_j_32=151574.45313375146 k_32=6365.080622434087 ref_k_32=5456.680312815052
 [S04 DEBUG] Target mode - j_32: 124805.50240066837
 [S04 DEBUG] Target mode - k_32: 6365.080622434087
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=201580.91981767488, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [S04] S15 target electricity changed: d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 157305.36743549566, K32: 8022.573739210278
 [S04] j_32 update: 157305.36743549566
 [S01] j_32 listener: 124805.50240066837 → 157305.36743549566
 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 157305.36743549566
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 151574.45313375146, K32: 5456.680312815052
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=151574.45313375146, ref_k_32=5456.680312815052 | current target j_32=157305.36743549566, k_32=8022.573739210278
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=157305.36743549566 ref_j_32=151574.45313375146 k_32=8022.573739210278 ref_k_32=5456.680312815052
 [S04 DEBUG] Target mode - j_32: 157305.36743549566
 [S04 DEBUG] Target mode - k_32: 8022.573739210278
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=157305.36743549566 ref_j_32=151574.45313375146 k_32=8022.573739210278 ref_k_32=5456.680312815052
 [S04 DEBUG] Target mode - j_32: 157305.36743549566
 [S04 DEBUG] Target mode - k_32: 8022.573739210278
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=13486.4629835961
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=201580.91981767488, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=13486.4629835961
 [Section13] 🧊 COOLING RESULTS: d_117=5063.359562063149, j_116=2.663540445486518, l_116=0, l_114=8423.103421532951
 [Section13] Target Model calculations complete
4011-Section13.js:2928 [Section13] ✅ Target Model complete
4011-Section13.js:2955 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
4011-Section13.js:2961 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
4011-Section13.js:226 [Section13] 🔄 Updating calculated display values for target mode
4011-Section13.js:310 [Section13] Calculated display values updated for target mode
4011-Section14.js:1015 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
4011-Section14.js:1043 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
4011-Section14.js:1050 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
4011-Section14.js:1060 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
4011-Section14.js:1063 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1078 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 S10: Target utilization factor dependency i_98 changed.
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ❌ getRefValue(k_98): ref="null", fallback="null", dom="0", final="0"
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [S04] S15 target electricity changed: d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 156593.7579496997, K32: 7986.281655434685
 [S04] j_32 update: 156593.7579496997
 [S01] j_32 listener: 157305.36743549566 → 156593.7579496997
 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 156593.7579496997
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 151574.45313375146, K32: 5456.680312815052
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=151574.45313375146, ref_k_32=5456.680312815052 | current target j_32=156593.7579496997, k_32=7986.281655434685
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=156593.7579496997 ref_j_32=151574.45313375146 k_32=7986.281655434685 ref_k_32=5456.680312815052
 [S04 DEBUG] Target mode - j_32: 156593.7579496997
 [S04 DEBUG] Target mode - k_32: 7986.281655434685
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=156593.7579496997 ref_j_32=151574.45313375146 k_32=7986.281655434685 ref_k_32=5456.680312815052
 [S04 DEBUG] Target mode - j_32: 156593.7579496997
 [S04 DEBUG] Target mode - k_32: 7986.281655434685
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
 S10: Reference listener triggered by ref_i_98, recalculating all.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
4011-Section10.js:2377 S10: Reference utilization factor dependency ref_i_98 changed.
4011-Section14.js:1043 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
4011-Section14.js:1050 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
4011-Section14.js:1060 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
4011-Section14.js:1063 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1078 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
4011-Section14.js:1043 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
4011-Section14.js:1050 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
4011-Section14.js:1060 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
4011-Section14.js:1063 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1078 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 S10: Reference listener triggered by ref_i_97, recalculating all.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 S10: Reference utilization factor dependency ref_i_97 changed.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S11] Listener: ref_d_97 changed → recalculating (src=calculated)
 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Listener: ref_d_97 changed → recalculating (src=calculated)
 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 [S13DEBUG] Reference GF HDD changed: ref_d_22=1960 → triggering Reference calculations
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
4011-Section13.js:3258 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
4011-Section13.js:3270 [Section13] Reference results stored with ref_ prefix for downstream sections
4011-Section13.js:3273 [S13 DEBUG] Total Reference results stored: 34
4011-Section13.js:3019 [Section13] Reference Model calculations complete
4011-Section13.js:2924 [Section13] ✅ Reference Model complete
4011-Section13.js:2926 [Section13] 🔄 Starting Target Model calculations...
4011-Section13.js:3033 [Section13] Running Target Model calculations...
4011-Section13.js:2439 [S13] TGT HEATING: system=Heatpump, ted=201580.91981767488, afue=1, cop=3.663540445486518
4011-Section13.js:2530 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
4011-Section13.js:2591 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
4011-Section13.js:3072 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 [S13DEBUG] Reference GF CDD changed: ref_h_22=-1680 → triggering Reference calculations
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=201580.91981767488, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 [S13DEBUG] Reference GF HDD changed: ref_d_22=1960 → triggering Reference calculations
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=201580.91981767488, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 [S13DEBUG] Reference GF CDD changed: ref_h_22=-1680 → triggering Reference calculations
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
4011-Section13.js:3019 [Section13] Reference Model calculations complete
4011-Section13.js:2924 [Section13] ✅ Reference Model complete
4011-Section13.js:2926 [Section13] 🔄 Starting Target Model calculations...
4011-Section13.js:3033 [Section13] Running Target Model calculations...
4011-Section13.js:2439 [S13] TGT HEATING: system=Heatpump, ted=201580.91981767488, afue=1, cop=3.663540445486518
4011-Section13.js:2530 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
4011-Section13.js:2591 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
4011-Section13.js:3072 [Section13] Target Model calculations complete
4011-Section13.js:2928 [Section13] ✅ Target Model complete
4011-Section13.js:2955 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
4011-Section13.js:2961 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [S12] U-agg REF: TB%=50 → g_101=0.405594, g_102=0.405405
 [S12DB] REF CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
 [S12DB] REF h_101 calc: (4600*0.4055944265297311*24)/1000 = 44.77762468888231
 [S12DB] REF i_101 result: 44.77762468888231 * 2476.6199999999994 = 110897.16085697968
 [S12DB] REF g_104 calc: (0.4055944265297311*2476.6199999999994 + 0.4054054054054054*1100.42)/3577.0400009999994 = 0.4055362770454741
 [S12DB] REF ROW104: i_101=110897.16085697968, i_102=20985.306810810813, i_103=36440.079840319355 → i_104=168322.54750810983
 [S12DB] REF ROW104: h_21="Capacitance", k_98=-1895.4006468093894 → k_104=-1895.4006468093894
 [S04] S15 reference electricity changed: ref_d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 156593.7579496997, K32: 7986.281655434685
 [S04] j_32 update: 156593.7579496997
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 245077.13398810977, K32: 8822.776823571952
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=245077.13398810977, ref_k_32=8822.776823571952 | current target j_32=156593.7579496997, k_32=7986.281655434685
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=156593.7579496997 ref_j_32=245077.13398810977 k_32=7986.281655434685 ref_k_32=8822.776823571952
 [S04 DEBUG] Target mode - j_32: 156593.7579496997
 [S04 DEBUG] Target mode - k_32: 7986.281655434685
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=156593.7579496997 ref_j_32=245077.13398810977 k_32=7986.281655434685 ref_k_32=8822.776823571952
 [S04 DEBUG] Target mode - j_32: 156593.7579496997
 [S04 DEBUG] Target mode - k_32: 7986.281655434685
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S12DB] STORED for S15: ref_d_101=2476.6199999999994
 [S12DB] STORED for S15: ref_d_102=1100.42
 [S12DB] STORED for S15: ref_g_101=0.4055944265297311
 [S12DB] STORED for S15: ref_g_102=0.4054054054054054
 [S12DB] STORED for S15: ref_g_104=0.4055362770454741
 [S12DB] STORED for S15: ref_i_101=110897.16085697968
 [S12DB] STORED for S15: ref_i_102=20985.306810810813
 [S12DB] STORED for S15: ref_i_104=168322.54750810983
 [Section12] Reference results stored with ref_ prefix for downstream sections
 [S12] U-agg TGT: TB%=20 → g_101=0.278341, g_102=0.324324
 S10: Target listener triggered by i_103, recalculating all.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
4011-Section13.js:3033 [Section13] Running Target Model calculations...
4011-Section13.js:2439 [S13] TGT HEATING: system=Heatpump, ted=204876.46189470481, afue=1, cop=3.663540445486518
4011-Section13.js:2530 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
4011-Section13.js:2591 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
4011-Section04.js:2439 [S04] S15 target electricity changed: d_136
4011-Section04.js:1534 [S04] Starting dual-engine Excel-compliant calculations
4011-Section04.js:975 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 157493.30911504582, K32: 8032.158764867337
4011-Section04.js:94 [S04] j_32 update: 157493.30911504582
4011-Section01.js:1110 [S01] j_32 listener: 156593.7579496997 → 157493.30911504582
4011-Section01.js:1111 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 157493.30911504582
24011-Section05.js:266 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 245077.13398810977, K32: 8822.776823571952
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=245077.13398810977, ref_k_32=8822.776823571952 | current target j_32=157493.30911504582, k_32=8032.158764867337
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=157493.30911504582 ref_j_32=245077.13398810977 k_32=8032.158764867337 ref_k_32=8822.776823571952
 [S04 DEBUG] Target mode - j_32: 157493.30911504582
 [S04 DEBUG] Target mode - k_32: 8032.158764867337
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=157493.30911504582 ref_j_32=245077.13398810977 k_32=8032.158764867337 ref_k_32=8822.776823571952
 [S04 DEBUG] Target mode - j_32: 157493.30911504582
 [S04 DEBUG] Target mode - k_32: 8032.158764867337
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=204876.46189470481, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 S10: Target utilization factor dependency i_103 changed.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S12DB] TGT CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
 [S12DB] TGT h_101 calc: (4600*0.2783410626476887*24)/1000 = 30.728853316304836
 [S12DB] TGT i_101 result: 30.728853316304836 * 2476.6199999999994 = 76103.69270022686
 [S12DB] TGT g_104 calc: (0.2783410626476887*2476.6199999999994 + 0.3243243243243243*1100.42)/3577.0400009999994 = 0.2924870885578592
 [S12DB] TGT ROW104: i_101=76103.69270022686, i_102=16788.24544864865, i_103=23178.387012790416 → i_104=116070.32516166594
 [S12DB] TGT ROW104: h_21="Capacitance", k_98=-1895.4006468093894 → k_104=-1895.4006468093894
 [Section13] 📡 🔥 i_104 (TRANSMISSION LOSS) listener triggered - S11 thermal bridges changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=204876.46189470481, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 i_104 (TRANSMISSION LOSS) listener triggered - S11 thermal bridges changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=204876.46189470481, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=204876.46189470481, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
4011-Section13.js:226 [Section13] 🔄 Updating calculated display values for target mode
4011-Section13.js:310 [Section13] Calculated display values updated for target mode
4011-Section13.js:2910 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
4011-Section13.js:2916 [Section13] 🎯 Mode captured at calculation start: target
4011-Section13.js:2922 [Section13] 🔄 Starting Reference Model calculations...
4011-Section13.js:2972 [Section13] Running Reference Model calculations...
4011-Section13.js:2986 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
4011-Section13.js:2439 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
4011-Section13.js:2530 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
4011-Section13.js:3234 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
4011-Section13.js:3237 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=204876.46189470481, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [S12DB] g_104 DISPLAY (target): 0.29248708863962714
 [Section12] Calculated display values updated for target mode
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (TGT)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (REF)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=204876.46189470481, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 🟢 [S06-TAR] Storing d_43 = 0 (from d_44=0, d_45=0, d_46=0)
 🔵 [S06-REF] Storing ref_d_43 = 0 (from d_44=0, d_45=0, d_46=0)
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 157493.30911504582, K32: 8032.158764867337
 [S04] j_32 update: 157493.30911504582
4011-Section04.js:975 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 245077.13398810977, K32: 8822.776823571952
4011-Section04.js:1625 [S04] Reference model calculations complete
4011-Section04.js:1631 [S04DB] storeReference: ref_j_32=245077.13398810977, ref_k_32=8822.776823571952 | current target j_32=157493.30911504582, k_32=8032.158764867337
4011-Section04.js:450 [S04] 🔄 Updating calculated display values for target mode
4011-Section04.js:458 [S04DB] displayContext mode=target j_32=157493.30911504582 ref_j_32=245077.13398810977 k_32=8032.158764867337 ref_k_32=8822.776823571952
4011-Section04.js:539 [S04 DEBUG] Target mode - j_32: 157493.30911504582
4011-Section04.js:539 [S04 DEBUG] Target mode - k_32: 8032.158764867337
4011-Section04.js:539 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:574 [S04] Calculated display values updated for target mode
4011-Section04.js:1556 [S04] Dual-engine calculations completed successfully
4011-Dependency.js:116 [DependencyGraph] Data loaded: 388 nodes, 662 links
4011-Dependency.js:718 [DependencyGraph] Calculating node sizes...
4011-Section12.js:1562 [S12] U-agg REF: TB%=50 → g_101=0.347926, g_102=0.405405
 [S12DB] REF CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
 [S12DB] REF h_101 calc: (4600*0.3479263283096109*24)/1000 = 38.41106664538104
 [S12DB] REF i_101 result: 38.41106664538104 * 2476.6199999999994 = 95129.61587528358
 [S12DB] REF g_104 calc: (0.3479263283096109*2476.6199999999994 + 0.4054054054054054*1100.42)/3577.0400009999994 = 0.36560886069732407
 [S12DB] REF ROW104: i_101=95129.61587528358, i_102=20985.306810810813, i_103=36440.079840319355 → i_104=152555.00252641374
 [S12DB] REF ROW104: h_21="Capacitance", k_98=-1895.4006468093894 → k_104=-1895.4006468093894
 [S04] S15 reference electricity changed: ref_d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 157493.30911504582, K32: 8032.158764867337
 [S04] j_32 update: 157493.30911504582
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 229309.58900641365, K32: 8255.145204230892
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=229309.58900641365, ref_k_32=8255.145204230892 | current target j_32=157493.30911504582, k_32=8032.158764867337
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=157493.30911504582 ref_j_32=229309.58900641365 k_32=8032.158764867337 ref_k_32=8255.145204230892
 [S04 DEBUG] Target mode - j_32: 157493.30911504582
 [S04 DEBUG] Target mode - k_32: 8032.158764867337
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=157493.30911504582 ref_j_32=229309.58900641365 k_32=8032.158764867337 ref_k_32=8255.145204230892
 [S04 DEBUG] Target mode - j_32: 157493.30911504582
 [S04 DEBUG] Target mode - k_32: 8032.158764867337
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S12DB] STORED for S15: ref_d_101=2476.6199999999994
 [S12DB] STORED for S15: ref_d_102=1100.42
 [S12DB] STORED for S15: ref_g_101=0.3479263283096109
 [S12DB] STORED for S15: ref_g_102=0.4054054054054054
 [S12DB] STORED for S15: ref_g_104=0.36560886069732407
 [S12DB] STORED for S15: ref_i_101=95129.61587528358
 [S12DB] STORED for S15: ref_i_102=20985.306810810813
4011-Section12.js:2302 [S12DB] STORED for S15: ref_i_104=152555.00252641374
4011-Section12.js:2307 [Section12] Reference results stored with ref_ prefix for downstream sections
4011-Section12.js:1562 [S12] U-agg TGT: TB%=20 → g_101=0.278341, g_102=0.324324
4011-Section12.js:1915 [S12DB] TGT CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
4011-Section12.js:1939 [S12DB] TGT h_101 calc: (4600*0.2783410626476887*24)/1000 = 30.728853316304836
4011-Section12.js:1942 [S12DB] TGT i_101 result: 30.728853316304836 * 2476.6199999999994 = 76103.69270022686
4011-Section12.js:2091 [S12DB] TGT g_104 calc: (0.2783410626476887*2476.6199999999994 + 0.3243243243243243*1100.42)/3577.0400009999994 = 0.2924870885578592
4011-Section12.js:2118 [S12DB] TGT ROW104: i_101=76103.69270022686, i_102=16788.24544864865, i_103=23178.387012790416 → i_104=116070.32516166594
4011-Section12.js:2121 [S12DB] TGT ROW104: h_21="Capacitance", k_98=-1895.4006468093894 → k_104=-1895.4006468093894
4011-Section12.js:240 [S12DB] g_104 DISPLAY (target): 0.29248708863962714
4011-Section12.js:244 [Section12] Calculated display values updated for target mode
4011-Section01.js:1014 [S01DB] upstream snapshot {ref_j_32: 229309.58900641365, ref_k_32: 8255.145204230892, j_32: 157493.30911504582, k_32: 8032.158764867337, ref_h_15: '1427.20', …}
4011-Section01.js:574 🔍 [S01DB] updateTEUIDisplay START: e_10=160.6709564226553, h_10=93.0, useType=Utility Bills
4011-Section01.js:729 🔍 [S01DB] UPDATING h_10: 110.4 (from j_32=157493.30911504582, area=1427.2)
4011-Clock.js:59 🕐 [CLOCK] ⭐ INITIALIZATION COMPLETE: 1091ms (all calculations finalized)
4011-Section01.js:1032 ✅ [S01] CALCULATION CHAIN COMPLETE - All values finalized including h_10
4011-Clock.js:146 [CLOCK] 🎯 User interaction started - timing to h_10 settlement
4011-Section11.js:1792 [S11] Listener: d_97 changed → recalculating (src=user-modified)
 S10: Target listener triggered by i_97, recalculating all.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=198923.23339330766, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [S04] S15 target electricity changed: d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 155868.31586330445, K32: 7949.2841090285265
 [S04] j_32 update: 155868.31586330445
 [S01] j_32 listener: 157493.30911504582 → 155868.31586330445
 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 155868.31586330445
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 229309.58900641365, K32: 8255.145204230892
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=229309.58900641365, ref_k_32=8255.145204230892 | current target j_32=155868.31586330445, k_32=7949.2841090285265
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=155868.31586330445 ref_j_32=229309.58900641365 k_32=7949.2841090285265 ref_k_32=8255.145204230892
 [S04 DEBUG] Target mode - j_32: 155868.31586330445
 [S04 DEBUG] Target mode - k_32: 7949.2841090285265
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=155868.31586330445 ref_j_32=229309.58900641365 k_32=7949.2841090285265 ref_k_32=8255.145204230892
 [S04 DEBUG] Target mode - j_32: 155868.31586330445
 [S04 DEBUG] Target mode - k_32: 7949.2841090285265
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=198923.23339330766, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 S10: Target utilization factor dependency i_97 changed.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
4011-Section14.js:1063 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1078 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
4011-Section14.js:1043 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
4011-Section14.js:1050 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
4011-Section14.js:1060 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
4011-Section14.js:1063 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1078 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Listener: d_97 changed → recalculating (src=user-modified)
 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 [FieldManager] Routed d_97=45 through sect11 ModeManager
 [CLOCK] 🎯 User interaction started - timing to h_10 settlement
 [S11] Slider input d_97=45 (localMode=target)
 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 [S01DB] upstream snapshot {ref_j_32: 229309.58900641365, ref_k_32: 8255.145204230892, j_32: 155868.31586330445, k_32: 7949.2841090285265, ref_h_15: '1427.20', …}
 🔍 [S01DB] updateTEUIDisplay START: e_10=160.6709564226553, h_10=93.0, useType=Utility Bills
 🔍 [S01DB] UPDATING h_10: 109.2 (from j_32=155868.31586330445, area=1427.2)
 🕐 [CLOCK] ⚡ CALCULATION COMPLETE: 29ms (subsequent update)
 🕐 [CLOCK] ⚡ USER INTERACTION COMPLETE: 29ms (interaction → h_10 settlement)
 ✅ [S01] CALCULATION CHAIN COMPLETE - All values finalized including h_10
 [CLOCK] 🎯 User interaction started - timing to h_10 settlement
 [S11] Listener: d_97 changed → recalculating (src=user-modified)
 S10: Target listener triggered by i_97, recalculating all.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=192970.00489191053, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [S04] S15 target electricity changed: d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 154243.32261156308, K32: 7866.409453189717
 [S04] j_32 update: 154243.32261156308
 [S01] j_32 listener: 155868.31586330445 → 154243.32261156308
 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 154243.32261156308
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 229309.58900641365, K32: 8255.145204230892
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=229309.58900641365, ref_k_32=8255.145204230892 | current target j_32=154243.32261156308, k_32=7866.409453189717
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=154243.32261156308 ref_j_32=229309.58900641365 k_32=7866.409453189717 ref_k_32=8255.145204230892
 [S04 DEBUG] Target mode - j_32: 154243.32261156308
4011-Section04.js:539 [S04 DEBUG] Target mode - k_32: 7866.409453189717
4011-Section04.js:539 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:574 [S04] Calculated display values updated for target mode
4011-Section04.js:1556 [S04] Dual-engine calculations completed successfully
4011-Section04.js:450 [S04] 🔄 Updating calculated display values for target mode
4011-Section04.js:458 [S04DB] displayContext mode=target j_32=154243.32261156308 ref_j_32=229309.58900641365 k_32=7866.409453189717 ref_k_32=8255.145204230892
4011-Section04.js:539 [S04 DEBUG] Target mode - j_32: 154243.32261156308
 [S04 DEBUG] Target mode - k_32: 7866.409453189717
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=192970.00489191053, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 S10: Target utilization factor dependency i_97 changed.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Listener: d_97 changed → recalculating (src=user-modified)
4011-Section11.js:1185 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
4011-Section11.js:1363 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
4011-FieldManager.js:208 [FieldManager] Routed d_97=40 through sect11 ModeManager
4011-Clock.js:146 [CLOCK] 🎯 User interaction started - timing to h_10 settlement
4011-Section11.js:1744 [S11] Slider input d_97=40 (localMode=target)
4011-Section11.js:1185 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
4011-Section11.js:1363 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 [CLOCK] 🎯 User interaction started - timing to h_10 settlement
 [S11] Listener: d_97 changed → recalculating (src=user-modified)
 S10: Target listener triggered by i_97, recalculating all.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=187016.77639051338, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [S04] S15 target electricity changed: d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 152618.32935982174, K32: 7783.534797350909
 [S04] j_32 update: 152618.32935982174
 [S01] j_32 listener: 154243.32261156308 → 152618.32935982174
 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 152618.32935982174
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 229309.58900641365, K32: 8255.145204230892
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=229309.58900641365, ref_k_32=8255.145204230892 | current target j_32=152618.32935982174, k_32=7783.534797350909
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=152618.32935982174 ref_j_32=229309.58900641365 k_32=7783.534797350909 ref_k_32=8255.145204230892
 [S04 DEBUG] Target mode - j_32: 152618.32935982174
 [S04 DEBUG] Target mode - k_32: 7783.534797350909
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=152618.32935982174 ref_j_32=229309.58900641365 k_32=7783.534797350909 ref_k_32=8255.145204230892
 [S04 DEBUG] Target mode - j_32: 152618.32935982174
 [S04 DEBUG] Target mode - k_32: 7783.534797350909
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=187016.77639051338, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 S10: Target utilization factor dependency i_97 changed.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
4011-Section14.js:1050 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
4011-Section14.js:1060 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
4011-Section14.js:1063 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1078 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
4011-Section11.js:1185 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
4011-Section11.js:1363 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
4011-Section11.js:1792 [S11] Listener: d_97 changed → recalculating (src=user-modified)
4011-Section11.js:1185 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
4011-Section11.js:1363 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
4011-FieldManager.js:208 [FieldManager] Routed d_97=35 through sect11 ModeManager
4011-Clock.js:146 [CLOCK] 🎯 User interaction started - timing to h_10 settlement
4011-Section11.js:1744 [S11] Slider input d_97=35 (localMode=target)
4011-Section11.js:1185 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
4011-Section11.js:1363 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 [S01DB] upstream snapshot {ref_j_32: 229309.58900641365, ref_k_32: 8255.145204230892, j_32: 152618.32935982174, k_32: 7783.534797350909, ref_h_15: '1427.20', …}
 🔍 [S01DB] updateTEUIDisplay START: e_10=160.6709564226553, h_10=93.0, useType=Utility Bills
 🔍 [S01DB] UPDATING h_10: 106.9 (from j_32=152618.32935982174, area=1427.2)
 🕐 [CLOCK] ⚡ CALCULATION COMPLETE: 76ms (subsequent update)
 🕐 [CLOCK] ⚡ USER INTERACTION COMPLETE: 76ms (interaction → h_10 settlement)
 ✅ [S01] CALCULATION CHAIN COMPLETE - All values finalized including h_10
 [CLOCK] 🎯 User interaction started - timing to h_10 settlement
 [S11] Listener: d_97 changed → recalculating (src=user-modified)
 S10: Target listener triggered by i_97, recalculating all.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=181063.54788911622, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [S04] S15 target electricity changed: d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 150993.33610808034, K32: 7700.660141512098
 [S04] j_32 update: 150993.33610808034
 [S01] j_32 listener: 152618.32935982174 → 150993.33610808034
 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 150993.33610808034
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 229309.58900641365, K32: 8255.145204230892
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=229309.58900641365, ref_k_32=8255.145204230892 | current target j_32=150993.33610808034, k_32=7700.660141512098
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=150993.33610808034 ref_j_32=229309.58900641365 k_32=7700.660141512098 ref_k_32=8255.145204230892
 [S04 DEBUG] Target mode - j_32: 150993.33610808034
 [S04 DEBUG] Target mode - k_32: 7700.660141512098
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=150993.33610808034 ref_j_32=229309.58900641365 k_32=7700.660141512098 ref_k_32=8255.145204230892
 [S04 DEBUG] Target mode - j_32: 150993.33610808034
 [S04 DEBUG] Target mode - k_32: 7700.660141512098
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
4011-Section13.js:2972 [Section13] Running Reference Model calculations...
4011-Section13.js:2986 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
4011-Section13.js:2439 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
4011-Section13.js:2530 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
4011-Section13.js:3234 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
4011-Section13.js:3237 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
4011-Section13.js:3240 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=181063.54788911622, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 S10: Target utilization factor dependency i_97 changed.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Listener: d_97 changed → recalculating (src=user-modified)
4011-Section11.js:1185 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
4011-Section11.js:1363 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
4011-FieldManager.js:208 [FieldManager] Routed d_97=30 through sect11 ModeManager
4011-Clock.js:146 [CLOCK] 🎯 User interaction started - timing to h_10 settlement
4011-Section11.js:1744 [S11] Slider input d_97=30 (localMode=target)
4011-Section11.js:1185 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
4011-Section11.js:1363 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
4011-Section01.js:1014 [S01DB] upstream snapshot {ref_j_32: 229309.58900641365, ref_k_32: 8255.145204230892, j_32: 150993.33610808034, k_32: 7700.660141512098, ref_h_15: '1427.20', …}
4011-Section01.js:574 🔍 [S01DB] updateTEUIDisplay START: e_10=160.6709564226553, h_10=93.0, useType=Utility Bills
4011-Section01.js:729 🔍 [S01DB] UPDATING h_10: 105.8 (from j_32=150993.33610808034, area=1427.2)
4011-Clock.js:65 🕐 [CLOCK] ⚡ CALCULATION COMPLETE: 51ms (subsequent update)
4011-Clock.js:161 🕐 [CLOCK] ⚡ USER INTERACTION COMPLETE: 51ms (interaction → h_10 settlement)
4011-Section01.js:1032 ✅ [S01] CALCULATION CHAIN COMPLETE - All values finalized including h_10
4011-Clock.js:146 [CLOCK] 🎯 User interaction started - timing to h_10 settlement
4011-Section11.js:1792 [S11] Listener: d_97 changed → recalculating (src=user-modified)
 S10: Target listener triggered by i_97, recalculating all.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=175110.3193877191, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [S04] S15 target electricity changed: d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 149368.342856339, K32: 7617.785485673289
 [S04] j_32 update: 149368.342856339
 [S01] j_32 listener: 150993.33610808034 → 149368.342856339
 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 149368.342856339
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 229309.58900641365, K32: 8255.145204230892
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=229309.58900641365, ref_k_32=8255.145204230892 | current target j_32=149368.342856339, k_32=7617.785485673289
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=149368.342856339 ref_j_32=229309.58900641365 k_32=7617.785485673289 ref_k_32=8255.145204230892
 [S04 DEBUG] Target mode - j_32: 149368.342856339
 [S04 DEBUG] Target mode - k_32: 7617.785485673289
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=149368.342856339 ref_j_32=229309.58900641365 k_32=7617.785485673289 ref_k_32=8255.145204230892
 [S04 DEBUG] Target mode - j_32: 149368.342856339
 [S04 DEBUG] Target mode - k_32: 7617.785485673289
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=175110.3193877191, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 S10: Target utilization factor dependency i_97 changed.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
4011-Section14.js:1050 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
4011-Section14.js:1060 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
4011-Section14.js:1063 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1078 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
4011-Section11.js:1185 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
4011-Section11.js:1363 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
4011-Section11.js:1792 [S11] Listener: d_97 changed → recalculating (src=user-modified)
 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
 [FieldManager] Routed d_97=25 through sect11 ModeManager
 [CLOCK] 🎯 User interaction started - timing to h_10 settlement
 [S11] Slider input d_97=25 (localMode=target)
 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
4011-Section11.js:1363 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
4011-Section01.js:1014 [S01DB] upstream snapshot {ref_j_32: 229309.58900641365, ref_k_32: 8255.145204230892, j_32: 149368.342856339, k_32: 7617.785485673289, ref_h_15: '1427.20', …}
4011-Section01.js:574 🔍 [S01DB] updateTEUIDisplay START: e_10=160.6709564226553, h_10=93.0, useType=Utility Bills
4011-Section01.js:729 🔍 [S01DB] UPDATING h_10: 104.7 (from j_32=149368.342856339, area=1427.2)
4011-Clock.js:65 🕐 [CLOCK] ⚡ CALCULATION COMPLETE: 30ms (subsequent update)
4011-Clock.js:161 🕐 [CLOCK] ⚡ USER INTERACTION COMPLETE: 30ms (interaction → h_10 settlement)
4011-Section01.js:1032 ✅ [S01] CALCULATION CHAIN COMPLETE - All values finalized including h_10
4011-Clock.js:146 [CLOCK] 🎯 User interaction started - timing to h_10 settlement
4011-Section11.js:1792 [S11] Listener: d_97 changed → recalculating (src=user-modified)
 S10: Target listener triggered by i_97, recalculating all.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=169157.09088632194, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [S04] S15 target electricity changed: d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 147743.3496045976, K32: 7534.910829834478
 [S04] j_32 update: 147743.3496045976
 [S01] j_32 listener: 149368.342856339 → 147743.3496045976
 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 147743.3496045976
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 229309.58900641365, K32: 8255.145204230892
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=229309.58900641365, ref_k_32=8255.145204230892 | current target j_32=147743.3496045976, k_32=7534.910829834478
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=147743.3496045976 ref_j_32=229309.58900641365 k_32=7534.910829834478 ref_k_32=8255.145204230892
 [S04 DEBUG] Target mode - j_32: 147743.3496045976
 [S04 DEBUG] Target mode - k_32: 7534.910829834478
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=147743.3496045976 ref_j_32=229309.58900641365 k_32=7534.910829834478 ref_k_32=8255.145204230892
 [S04 DEBUG] Target mode - j_32: 147743.3496045976
 [S04 DEBUG] Target mode - k_32: 7534.910829834478
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=178945.20136223367, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=11591.062336786714
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 19191.892037991598
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 19191.892037991598
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=169157.09088632194, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=11591.062336786714
 [Section13] 🧊 COOLING RESULTS: d_117=4351.750076267195, j_116=2.663540445486518, l_116=0, l_114=7239.312260519519
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
4011-Section14.js:1063 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1078 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
4011-Section14.js:1043 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
4011-Section14.js:1050 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
4011-Section14.js:1060 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
4011-Section14.js:1063 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1078 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
4011-Section10.js:2368 S10: Target utilization factor dependency i_97 changed.
4011-Section14.js:1043 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
4011-Section14.js:1050 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
4011-Section14.js:1060 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
4011-Section14.js:1063 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1078 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
4011-Section14.js:1043 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
4011-Section14.js:1050 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
4011-Section14.js:1060 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
4011-Section14.js:1063 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1078 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
4011-Section14.js:1043 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
4011-Section14.js:1050 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
4011-Section14.js:1060 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
4011-Section14.js:1063 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1078 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
4011-Section14.js:1043 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
4011-Section14.js:1050 [S14 DEBUG] ✅ ref_d_127 = 178945.20136223367 (should be numeric, not NaN)
4011-Section14.js:1060 [S14 DEBUG] ✅ Stored ref_d_127 = 178945.20136223367 in StateManager
4011-Section14.js:1063 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1078 [S14 DEBUG] ref_d_128 calculation: 59532.28501397147 + 119064.57002794294 + 36440.079840319355 - 120694.93352 = 94342.00136223376
4011-Section11.js:1185 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
4011-Section11.js:1363 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
4011-Section11.js:1792 [S11] Listener: d_97 changed → recalculating (src=user-modified)
4011-Section11.js:1185 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
4011-Section11.js:1363 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
4011-FieldManager.js:208 [FieldManager] Routed d_97=20 through sect11 ModeManager
4011-Clock.js:146 [CLOCK] 🎯 User interaction started - timing to h_10 settlement
4011-Section11.js:1744 [S11] Slider input d_97=20 (localMode=target)
4011-Section11.js:1185 [S11] REF TB%=50% → ref_i_97=59532.29, ref_k_97=-947.70
4011-Section11.js:1363 [S11] Writing ref penalty: ref_i_97=59532.29, ref_k_97=-947.70
4011-Section01.js:1014 [S01DB] upstream snapshot {ref_j_32: 229309.58900641365, ref_k_32: 8255.145204230892, j_32: 147743.3496045976, k_32: 7534.910829834478, ref_h_15: '1427.20', …}
4011-Section01.js:574 🔍 [S01DB] updateTEUIDisplay START: e_10=160.6709564226553, h_10=93.0, useType=Utility Bills
4011-Section01.js:729 🔍 [S01DB] UPDATING h_10: 103.5 (from j_32=147743.3496045976, area=1427.2)
4011-Clock.js:65 🕐 [CLOCK] ⚡ CALCULATION COMPLETE: 29ms (subsequent update)
4011-Clock.js:161 🕐 [CLOCK] ⚡ USER INTERACTION COMPLETE: 30ms (interaction → h_10 settlement)
4011-Section01.js:1032 ✅ [S01] CALCULATION CHAIN COMPLETE - All values finalized including h_10
4011-Clock.js:146 [CLOCK] 🎯 User interaction started - timing to h_10 settlement
4011-Section11.js:1760 [S11] Slider change d_97=20 (localMode=target)
4011-Section12.js:1562 [S12] U-agg REF: TB%=50 → g_101=0.347926, g_102=0.405405
4011-Section12.js:1904 [S12DB] REF CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
4011-Section12.js:1932 [S12DB] REF h_101 calc: (4600*0.3479263283096109*24)/1000 = 38.41106664538104
4011-Section12.js:1935 [S12DB] REF i_101 result: 38.41106664538104 * 2476.6199999999994 = 95129.61587528358
4011-Section12.js:2087 [S12DB] REF g_104 calc: (0.3479263283096109*2476.6199999999994 + 0.4054054054054054*1100.42)/3577.0400009999994 = 0.36560886069732407
4011-Section12.js:2111 [S12DB] REF ROW104: i_101=95129.61587528358, i_102=20985.306810810813, i_103=36440.079840319355 → i_104=152555.00252641374
4011-Section12.js:2114 [S12DB] REF ROW104: h_21="Capacitance", k_98=-1895.4006468093894 → k_104=-1895.4006468093894
4011-Section12.js:2302 [S12DB] STORED for S15: ref_d_101=2476.6199999999994
4011-Section12.js:2302 [S12DB] STORED for S15: ref_d_102=1100.42
4011-Section12.js:2302 [S12DB] STORED for S15: ref_g_101=0.3479263283096109
4011-Section12.js:2302 [S12DB] STORED for S15: ref_g_102=0.4054054054054054
4011-Section12.js:2302 [S12DB] STORED for S15: ref_g_104=0.36560886069732407
4011-Section12.js:2302 [S12DB] STORED for S15: ref_i_101=95129.61587528358
4011-Section12.js:2302 [S12DB] STORED for S15: ref_i_102=20985.306810810813
4011-Section12.js:2302 [S12DB] STORED for S15: ref_i_104=152555.00252641374
4011-Section12.js:2307 [Section12] Reference results stored with ref_ prefix for downstream sections
4011-Section12.js:1562 [S12] U-agg TGT: TB%=20 → g_101=0.278341, g_102=0.324324
4011-Section12.js:1915 [S12DB] TGT CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
4011-Section12.js:1939 [S12DB] TGT h_101 calc: (4600*0.2783410626476887*24)/1000 = 30.728853316304836
4011-Section12.js:1942 [S12DB] TGT i_101 result: 30.728853316304836 * 2476.6199999999994 = 76103.69270022686
4011-Section12.js:2091 [S12DB] TGT g_104 calc: (0.2783410626476887*2476.6199999999994 + 0.3243243243243243*1100.42)/3577.0400009999994 = 0.2924870885578592
4011-Section12.js:2118 [S12DB] TGT ROW104: i_101=76103.69270022686, i_102=16788.24544864865, i_103=23178.387012790416 → i_104=116070.32516166594
4011-Section12.js:2121 [S12DB] TGT ROW104: h_21="Capacitance", k_98=-1895.4006468093894 → k_104=-1895.4006468093894
4011-Section12.js:240 [S12DB] g_104 DISPLAY (target): 0.29248708863962714
4011-Section12.js:244 [Section12] Calculated display values updated for target mode
4011-Section11.js:285 S11: Switched to REFERENCE mode
4011-Section11.js:285 S11: Switched to TARGET mode