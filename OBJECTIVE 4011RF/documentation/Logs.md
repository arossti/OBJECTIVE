 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Occupancy changed (Reference): ref_d_63
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
 [S04] j_32 update: 0
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (TGT)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (REF)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
2 [S09] Updated calculated display values for target mode
 [S04] Occupancy changed (Reference): ref_d_63
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
 [S04] j_32 update: 0
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (TGT)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (REF)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S09] 🔗 Published initial ref_d_63=126 for S07
 [S09] ✅ Pattern A dual-engine listeners registered (5 Target/Reference pairs)
 S09: UI refreshed for target mode
 [S04] Occupancy changed (Reference): ref_d_63
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
 [S04] j_32 update: 0
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (TGT)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (REF)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
2 [S09] Updated calculated display values for target mode
 S10: Section rendered - initializing Self-Contained State Module.
 S10: Simplified global StateManager listeners added
 S10: ModeManager exposed globally for cross-section integration.
 [S10 DEBUG] calculateAll() triggered in target mode - running both engines
 [S10 DEBUG] Dual-engine calculations complete in target mode
 S11: Section rendered - initializing Self-Contained State Module.
 S11: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 S11: ModeManager exposed globally for cross-section integration.
 [S11] calculateAll TRIGGERED. isReferenceMode: false
 [S11] REF TB%=50% → ref_i_97=31694.95, ref_k_97=-2133.81
 S10: Reference listener triggered by ref_i_98, recalculating all.
 [S10 DEBUG] calculateAll() triggered in target mode - running both engines
 [S10 DEBUG] Dual-engine calculations complete in target mode
 S10: Reference utilization factor dependency ref_i_98 changed.
 [S11] Writing ref penalty: ref_i_97=31694.95, ref_k_97=-2133.81
 S10: Reference listener triggered by ref_i_97, recalculating all.
 [S10 DEBUG] calculateAll() triggered in target mode - running both engines
 [S10 DEBUG] Dual-engine calculations complete in target mode
 S10: Reference utilization factor dependency ref_i_97 changed.
 [S11] Listener: ref_d_97 changed → recalculating (src=calculated)
 [S11] calculateAll TRIGGERED. isReferenceMode: false
 [S11] REF TB%=50% → ref_i_97=31694.95, ref_k_97=-2133.81
 [S11] Writing ref penalty: ref_i_97=31694.95, ref_k_97=-2133.81
 S10: Target listener triggered by i_97, recalculating all.
 [S10 DEBUG] calculateAll() triggered in target mode - running both engines
 [S10 DEBUG] Dual-engine calculations complete in target mode
 S10: Target utilization factor dependency i_97 changed.
 S10: Target listener triggered by i_98, recalculating all.
 [S10 DEBUG] calculateAll() triggered in target mode - running both engines
 [S10 DEBUG] Dual-engine calculations complete in target mode
 S10: Target utilization factor dependency i_98 changed.
 [S11] Listener: ref_d_97 changed → recalculating (src=calculated)
 [S11] calculateAll TRIGGERED. isReferenceMode: false
 [S11] REF TB%=50% → ref_i_97=31694.95, ref_k_97=-2133.81
 [S11] Writing ref penalty: ref_i_97=31694.95, ref_k_97=-2133.81
 [Section13] 🔗 Attaching StateManager listeners...
 [Section13] 🔗 Attaching CRITICAL upstream listeners...
 [Section13] ✅ ALL LISTENERS ATTACHED SUCCESSFULLY
 S13: Section rendered - initializing Pattern A Dual-State Module.
 [S13 DEBUG] Loading reference standard: "OBC SB10 5.5-6 Z6"
 [S13 DEBUG] Found reference values: Object
 S13: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6 Object
 [Section13] 🔗 Attaching StateManager listeners...
 [Section13] 🔗 Attaching CRITICAL upstream listeners...
 [Section13] ✅ ALL LISTENERS ATTACHED SUCCESSFULLY
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=0, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=0
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 0
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S04] S13 space oil volume changed (Reference): ref_f_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 0
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 S10: Reference listener triggered by ref_m_121, recalculating all.
 [S10 DEBUG] calculateAll() triggered in target mode - running both engines
 [S10 DEBUG] Dual-engine calculations complete in target mode
 S10: Reference utilization factor dependency ref_m_121 changed.
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=0, afue=1, cop=3.663540445486518
 S10: Target listener triggered by m_121, recalculating all.
 [S10 DEBUG] calculateAll() triggered in target mode - running both engines
 [S10 DEBUG] Dual-engine calculations complete in target mode
 S10: Target utilization factor dependency m_121 changed.
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=2.7, l_116=0, l_114=0
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=2.7, l_116=0, l_114=0
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=0
 [Section13] 🧊 COOLING RESULTS: d_117=0, j_116=2.7, l_116=0, l_114=0
 [S04] f_115 listener fired - S13 oil
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] S13 space gas volume changed: h_115
 [S04] j_32 update: 0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [S13] Set up dropdown event handlers for 4 dropdowns
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 S13: Pattern A initialization complete.
 S14: Section rendered - initializing Pattern A Dual-State Module.
 S14: Reference defaults loaded from standard: OBC SB10 5.5-6 Z6
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 63389.89418794294 + 23178.39 + 84603.11539679999 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 82171.41315871438 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 82171.41315871438 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 63389.89418794294 + 23178.39 - 120694.93352 = -2431.7022380855924
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=82171.41315871438, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=0
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 8812.892874164992
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 8812.892874164992
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 S10: Reference listener triggered by ref_m_121, recalculating all.
 [S10 DEBUG] calculateAll() triggered in target mode - running both engines
 [S10 DEBUG] Dual-engine calculations complete in target mode
 S10: Reference utilization factor dependency ref_m_121 changed.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 63389.89418794294 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 82171.49776191435 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 82171.49776191435 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 63389.89418794294 + 23178.39 - 120694.93352 = -2431.7022380855924
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=10192.893604542265
 [Section13] 🧊 COOLING RESULTS: d_117=3826.8214105081656, j_116=2.663540445486518, l_116=0, l_114=6366.0721940341
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=10192.893604542265
 [Section13] 🧊 COOLING RESULTS: d_117=3826.8214105081656, j_116=2.663540445486518, l_116=0, l_114=6366.0721940341
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 63389.89418794294 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 82171.49776191435 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 82171.49776191435 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 63389.89418794294 + 23178.39 - 120694.93352 = -2431.7022380855924
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 63389.89418794294 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 82171.49776191435 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 82171.49776191435 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 63389.89418794294 + 23178.39 - 120694.93352 = -2431.7022380855924
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 63389.89418794294 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 82171.49776191435 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 82171.49776191435 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 63389.89418794294 + 23178.39 - 120694.93352 = -2431.7022380855924
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 63389.89418794294 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 82171.49776191435 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 82171.49776191435 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 63389.89418794294 + 23178.39 - 120694.93352 = -2431.7022380855924
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 63389.89418794294 + 23178.39 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 82171.49776191435 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 82171.49776191435 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 63389.89418794294 + 23178.39 - 120694.93352 = -2431.7022380855924
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=119171.54798887548, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=10192.893604542265
 [Section13] 🧊 COOLING RESULTS: d_117=3826.8214105081656, j_116=2.663540445486518, l_116=0, l_114=6366.0721940341
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=82171.49776191435, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=10192.893604542265
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 8812.901947867262
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 8812.901947867262
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 0, K32: 0
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=0, ref_k_32=0 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=0 k_32=0 ref_k_32=0
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=119171.54798887548, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=10192.893604542265
 [Section13] 🧊 COOLING RESULTS: d_117=3826.8214105081656, j_116=2.663540445486518, l_116=0, l_114=6366.0721940341
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 S14: Pattern A initialization complete.
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S04] S15 reference electricity changed: ref_d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
 [S04] j_32 update: 0
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 76754.58647999995, K32: 2763.1651132799984
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S04] S15 target electricity changed: d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 0, K32: 0
4 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 76754.58647999995, K32: 2763.1651132799984
4 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=76754.58647999995, ref_k_32=2763.1651132799984 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for reference mode
 [S04DB] displayContext mode=reference j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
 [S04 DEBUG] Reference mode - j_32: ref_j_32=76754.58647999995 (NO fallback to Target)
 [S04 DEBUG] Reference mode - k_32: ref_k_32=2763.1651132799984 (NO fallback to Target)
 [S04 DEBUG] Reference mode - l_27: ref_l_27=36 (NO fallback to Target)
 [S04] Calculated display values updated for reference mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for reference mode
 [S04DB] displayContext mode=reference j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
 [S04 DEBUG] Reference mode - j_32: ref_j_32=76754.58647999995 (NO fallback to Target)
 [S04 DEBUG] Reference mode - k_32: ref_k_32=2763.1651132799984 (NO fallback to Target)
 [S04 DEBUG] Reference mode - l_27: ref_l_27=36 (NO fallback to Target)
 [S04] Calculated display values updated for reference mode
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=76754.58647999995, ref_k_32=2763.1651132799984 | current target j_32=0, k_32=0
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=0 ref_j_32=76754.58647999995 k_32=0 ref_k_32=2763.1651132799984
 [S04 DEBUG] Target mode - j_32: 0
 [S04 DEBUG] Target mode - k_32: 0
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S18] Notes section rendered
 [S18] Notes & QC Monitor section loaded
 Section03: Province selected: ON
 S03: Synced province change "ON" to StateManager key "d_19"
 City dropdown updated for ON - selected: Alexandria
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 Section03: Province selected: ON
 S03: Synced province change "ON" to StateManager key "d_19"
 City dropdown updated for ON - selected: Alexandria
 [S15] Missing critical upstream Reference values: ref_g_101, ref_d_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 TEUI Calculator 4.011 initialization complete
 [QCMonitor] QC monitoring disabled. Add ?qc=true to URL to activate.
 [DependencyGraph] Data loaded: 389 nodes, 663 links
 [DependencyGraph] Calculating node sizes...
 [S01DB] upstream snapshot Object
 🔍 [S01DB] updateTEUIDisplay START: e_10=341.2, h_10=93.0, useType=Utility Bills
 🔍 [S01DB] UPDATING h_10: 0.0 (from j_32=0, area=1427.2)
 ✅ [S01] CALCULATION CHAIN COMPLETE - All values finalized including h_10
 [S15] Missing critical upstream Reference values: ref_g_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_g_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_g_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_g_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_g_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_g_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_g_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_g_101, ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S12] U-agg REF: TB%=50 → g_101=0.347926, g_102=0.405405
 [S15] Missing critical upstream Reference values: ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 [S15] Missing critical upstream Reference values: ref_i_104
calculateReferenceModel @ 4011-Section15.js:1395Understand this warningAI
 [S15] Using fallback values for missing upstream dependencies (initialization timing)
 S10: Reference listener triggered by ref_i_103, recalculating all.
 [S10 DEBUG] calculateAll() triggered in target mode - running both engines
 [S10 DEBUG] Dual-engine calculations complete in target mode
 S10: Reference utilization factor dependency ref_i_103 changed.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 63389.89418794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 95433.18760223371 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 95433.18760223371 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 63389.89418794294 + 36440.079840319355 - 120694.93352 = 10829.987602233756
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 63389.89418794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 95433.18760223371 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 95433.18760223371 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 63389.89418794294 + 36440.079840319355 - 120694.93352 = 10829.987602233756
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 63389.89418794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 95433.18760223371 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 95433.18760223371 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 63389.89418794294 + 36440.079840319355 - 120694.93352 = 10829.987602233756
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 63389.89418794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 95433.18760223371 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 95433.18760223371 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 63389.89418794294 + 36440.079840319355 - 120694.93352 = 10829.987602233756
 [S12DB] REF CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
 [S12DB] REF h_101 calc: (4600*0.34792632830961084*24)/1000 = 38.41106664538104
 [S12DB] REF i_101 result: 38.41106664538104 * 2476.6199999999994 = 95129.61587528358
 [S12DB] REF g_104 calc: (0.34792632830961084*2476.6199999999994 + 0.4054054054054054*1100.42)/3577.0400009999994 = 0.36560886069732396
 [S12DB] REF ROW104: i_101=95129.61587528358, i_102=20985.306810810813, i_103=36440.079840319355 → i_104=152555.00252641374
 [S12DB] REF ROW104: h_21="Capacitance", k_98=-4267.625965209389 → k_104=-4267.625965209389
 [S04] S15 reference electricity changed: ref_d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 133574.3671495516, K32: 6812.292724627132
 [S04] j_32 update: 133574.3671495516
 [S01] j_32 listener: 0 → 133574.3671495516
 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 133574.3671495516
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 229309.58900641365, K32: 8255.145204230892
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=229309.58900641365, ref_k_32=8255.145204230892 | current target j_32=133574.3671495516, k_32=6812.292724627132
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.3671495516 ref_j_32=229309.58900641365 k_32=6812.292724627132 ref_k_32=8255.145204230892
 [S04 DEBUG] Target mode - j_32: 133574.3671495516
 [S04 DEBUG] Target mode - k_32: 6812.292724627132
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.3671495516 ref_j_32=229309.58900641365 k_32=6812.292724627132 ref_k_32=8255.145204230892
 [S04 DEBUG] Target mode - j_32: 133574.3671495516
 [S04 DEBUG] Target mode - k_32: 6812.292724627132
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S12DB] STORED for S15: ref_d_101=2476.6199999999994
 [S12DB] STORED for S15: ref_d_102=1100.42
 [S12DB] STORED for S15: ref_g_101=0.34792632830961084
 [S12DB] STORED for S15: ref_g_102=0.4054054054054054
 [S12DB] STORED for S15: ref_g_104=0.36560886069732396
 [S12DB] STORED for S15: ref_i_101=95129.61587528358
 [S12DB] STORED for S15: ref_i_102=20985.306810810813
 [S12DB] STORED for S15: ref_i_104=152555.00252641374
 [Section12] Reference results stored with ref_ prefix for downstream sections
 [S12] U-agg TGT: TB%=20 → g_101=0.278341, g_102=0.324324
 S10: Target listener triggered by i_103, recalculating all.
 [S10 DEBUG] calculateAll() triggered in target mode - running both engines
 [S10 DEBUG] Dual-engine calculations complete in target mode
 S10: Target utilization factor dependency i_103 changed.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 63389.89418794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 95433.18760223371 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 95433.18760223371 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 63389.89418794294 + 36440.079840319355 - 120694.93352 = 10829.987602233756
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=95433.18760223371, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=10192.893604542265
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 10235.21960555917
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 10235.21960555917
 [S04] S13 space gas volume changed (Reference): ref_h_115
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 229309.58900641365, K32: 8255.145204230892
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=229309.58900641365, ref_k_32=8255.145204230892 | current target j_32=133574.3671495516, k_32=6812.292724627132
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.3671495516 ref_j_32=229309.58900641365 k_32=6812.292724627132 ref_k_32=8255.145204230892
 [S04 DEBUG] Target mode - j_32: 133574.3671495516
 [S04 DEBUG] Target mode - k_32: 6812.292724627132
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=119171.54500166589, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=10192.893604542265
 [Section13] 🧊 COOLING RESULTS: d_117=3826.8214105081656, j_116=2.663540445486518, l_116=0, l_114=6366.0721940341
 [S04] S15 target electricity changed: d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 133574.36633416289, K32: 6812.2926830423075
 [S04] j_32 update: 133574.36633416289
 [S01] j_32 listener: 133574.3671495516 → 133574.36633416289
 [S01] 🕐 j_32 listener timing: StateManager current j_32 = 133574.36633416289
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 229309.58900641365, K32: 8255.145204230892
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=229309.58900641365, ref_k_32=8255.145204230892 | current target j_32=133574.36633416289, k_32=6812.2926830423075
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=229309.58900641365 k_32=6812.2926830423075 ref_k_32=8255.145204230892
 [S04 DEBUG] Target mode - j_32: 133574.36633416289
 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=229309.58900641365 k_32=6812.2926830423075 ref_k_32=8255.145204230892
 [S04 DEBUG] Target mode - j_32: 133574.36633416289
 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 d_127 (TED) listener triggered - S14 energy demand changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=95433.18760223371, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=10192.893604542265
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 10235.21960555917
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 10235.21960555917
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=119171.54500166589, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=10192.893604542265
 [Section13] 🧊 COOLING RESULTS: d_117=3826.8214105081656, j_116=2.663540445486518, l_116=0, l_114=6366.0721940341
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 63389.89418794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 95433.18760223371 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 95433.18760223371 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 63389.89418794294 + 36440.079840319355 - 120694.93352 = 10829.987602233756
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 63389.89418794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 95433.18760223371 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 95433.18760223371 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 63389.89418794294 + 36440.079840319355 - 120694.93352 = 10829.987602233756
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 63389.89418794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 95433.18760223371 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 95433.18760223371 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 63389.89418794294 + 36440.079840319355 - 120694.93352 = 10829.987602233756
 [S12DB] TGT CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
 [S12DB] TGT h_101 calc: (4600*0.27834106264768865*24)/1000 = 30.72885331630483
 [S12DB] TGT i_101 result: 30.72885331630483 * 2476.6199999999994 = 76103.69270022685
 [S12DB] TGT g_104 calc: (0.27834106264768865*2476.6199999999994 + 0.3243243243243243*1100.42)/3577.0400009999994 = 0.29248708855785915
 [S12DB] TGT ROW104: i_101=76103.69270022685, i_102=16788.24544864865, i_103=23178.387012790416 → i_104=116070.32516166591
 [S12DB] TGT ROW104: h_21="Capacitance", k_98=-3293.5693790538335 → k_104=-3293.5693790538335
 [Section13] 📡 🔥 i_104 (TRANSMISSION LOSS) listener triggered - S11 thermal bridges changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=95433.18760223371, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=10192.893604542265
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 10235.21960555917
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 10235.21960555917
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=119171.54500166589, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=10192.893604542265
 [Section13] 🧊 COOLING RESULTS: d_117=3826.8214105081656, j_116=2.663540445486518, l_116=0, l_114=6366.0721940341
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 📡 🔥 i_104 (TRANSMISSION LOSS) listener triggered - S11 thermal bridges changed!
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=95433.18760223371, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=10192.893604542265
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 10235.21960555917
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 10235.21960555917
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=119171.54500166589, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=10192.893604542265
 [Section13] 🧊 COOLING RESULTS: d_117=3826.8214105081656, j_116=2.663540445486518, l_116=0, l_114=6366.0721940341
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=95433.18760223371, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=10192.893604542265
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 10235.21960555917
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 10235.21960555917
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=119171.54500166589, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=10192.893604542265
 [Section13] 🧊 COOLING RESULTS: d_117=3826.8214105081656, j_116=2.663540445486518, l_116=0, l_114=6366.0721940341
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=95433.18760223371, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=10192.893604542265
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 10235.21960555917
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 10235.21960555917
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=119171.54500166589, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=10192.893604542265
 [Section13] 🧊 COOLING RESULTS: d_117=3826.8214105081656, j_116=2.663540445486518, l_116=0, l_114=6366.0721940341
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [Section13] 🔄 Updating calculated display values for target mode
 [Section13] Calculated display values updated for target mode
 [S12DB] g_104 DISPLAY (target): 0.2924870886396271
 [Section12] Calculated display values updated for target mode
 [CLOCK] Starting initial load timing
 [S11] calculateAll TRIGGERED. isReferenceMode: false
 [S11] REF TB%=50% → ref_i_97=31694.95, ref_k_97=-2133.81
 [S11] Writing ref penalty: ref_i_97=31694.95, ref_k_97=-2133.81
 [S11] calculateAll TRIGGERED. isReferenceMode: false
 [S11] REF TB%=50% → ref_i_97=31694.95, ref_k_97=-2133.81
 [S11] Writing ref penalty: ref_i_97=31694.95, ref_k_97=-2133.81
 [S13DEBUG] Reference GF HDD changed: ref_d_22=1960 → triggering Reference calculations
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=95433.18760223371, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=10192.893604542265
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 10235.21960555917
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 10235.21960555917
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=119171.54500166589, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=10192.893604542265
 [Section13] 🧊 COOLING RESULTS: d_117=3826.8214105081656, j_116=2.663540445486518, l_116=0, l_114=6366.0721940341
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [S11] calculateAll TRIGGERED. isReferenceMode: false
 [S11] REF TB%=50% → ref_i_97=31694.95, ref_k_97=-2133.81
 [S11] Writing ref penalty: ref_i_97=31694.95, ref_k_97=-2133.81
 [S11] calculateAll TRIGGERED. isReferenceMode: false
 [S11] REF TB%=50% → ref_i_97=31694.95, ref_k_97=-2133.81
 [S11] Writing ref penalty: ref_i_97=31694.95, ref_k_97=-2133.81
 [S13DEBUG] Reference GF CDD changed: ref_h_22=-1680 → triggering Reference calculations
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=95433.18760223371, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=10192.893604542265
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 10235.21960555917
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 10235.21960555917
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=119171.54500166589, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=10192.893604542265
 [Section13] 🧊 COOLING RESULTS: d_117=3826.8214105081656, j_116=2.663540445486518, l_116=0, l_114=6366.0721940341
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [S11] calculateAll TRIGGERED. isReferenceMode: false
 [S11] REF TB%=50% → ref_i_97=31694.95, ref_k_97=-2133.81
 [S11] Writing ref penalty: ref_i_97=31694.95, ref_k_97=-2133.81
 [S11] calculateAll TRIGGERED. isReferenceMode: false
 [S11] REF TB%=50% → ref_i_97=31694.95, ref_k_97=-2133.81
 [S11] Writing ref penalty: ref_i_97=31694.95, ref_k_97=-2133.81
 [S13DEBUG] Reference GF HDD changed: ref_d_22=1960 → triggering Reference calculations
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=95433.18760223371, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=10192.893604542265
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 10235.21960555917
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 10235.21960555917
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=119171.54500166589, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=10192.893604542265
 [Section13] 🧊 COOLING RESULTS: d_117=3826.8214105081656, j_116=2.663540445486518, l_116=0, l_114=6366.0721940341
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [S11] calculateAll TRIGGERED. isReferenceMode: false
 [S11] REF TB%=50% → ref_i_97=31694.95, ref_k_97=-2133.81
 [S11] Writing ref penalty: ref_i_97=31694.95, ref_k_97=-2133.81
 [S11] calculateAll TRIGGERED. isReferenceMode: false
 [S11] REF TB%=50% → ref_i_97=31694.95, ref_k_97=-2133.81
 [S11] Writing ref penalty: ref_i_97=31694.95, ref_k_97=-2133.81
 [S13DEBUG] Reference GF CDD changed: ref_h_22=-1680 → triggering Reference calculations
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
 [Section13] 🎯 Mode captured at calculation start: target
 [Section13] 🔄 Starting Reference Model calculations...
 [Section13] Running Reference Model calculations...
 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
 [S13] REF HEATING: system=Gas, ted=95433.18760223371, afue=0.9, cop=1
 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=10192.893604542265
 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 10235.21960555917
 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 10235.21960555917
 [Section13] Reference results stored with ref_ prefix for downstream sections
 [S13 DEBUG] Total Reference results stored: 34
 [Section13] Reference Model calculations complete
 [Section13] ✅ Reference Model complete
 [Section13] 🔄 Starting Target Model calculations...
 [Section13] Running Target Model calculations...
 [S13] TGT HEATING: system=Heatpump, ted=119171.54500166589, afue=1, cop=3.663540445486518
 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=10192.893604542265
 [Section13] 🧊 COOLING RESULTS: d_117=3826.8214105081656, j_116=2.663540445486518, l_116=0, l_114=6366.0721940341
 [Section13] Target Model calculations complete
 [Section13] ✅ Target Model complete
 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
 [S12] U-agg REF: TB%=50 → g_101=0.347926, g_102=0.405405
 [S12DB] REF CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
 [S12DB] REF h_101 calc: (4600*0.34792632830961084*24)/1000 = 38.41106664538104
 [S12DB] REF i_101 result: 38.41106664538104 * 2476.6199999999994 = 95129.61587528358
 [S12DB] REF g_104 calc: (0.34792632830961084*2476.6199999999994 + 0.4054054054054054*1100.42)/3577.0400009999994 = 0.36560886069732396
 [S12DB] REF ROW104: i_101=95129.61587528358, i_102=20985.306810810813, i_103=36440.079840319355 → i_104=152555.00252641374
 [S12DB] REF ROW104: h_21="Capacitance", k_98=-4267.625965209389 → k_104=-4267.625965209389
 [S12DB] STORED for S15: ref_d_101=2476.6199999999994
 [S12DB] STORED for S15: ref_d_102=1100.42
 [S12DB] STORED for S15: ref_g_101=0.34792632830961084
 [S12DB] STORED for S15: ref_g_102=0.4054054054054054
 [S12DB] STORED for S15: ref_g_104=0.36560886069732396
 [S12DB] STORED for S15: ref_i_101=95129.61587528358
 [S12DB] STORED for S15: ref_i_102=20985.306810810813
 [S12DB] STORED for S15: ref_i_104=152555.00252641374
 [Section12] Reference results stored with ref_ prefix for downstream sections
 [S12] U-agg TGT: TB%=20 → g_101=0.278341, g_102=0.324324
 [S12DB] TGT CLIMATE: d_20=4600, d_21=196, d_22=1960, h_22=-1680
 [S12DB] TGT h_101 calc: (4600*0.27834106264768865*24)/1000 = 30.72885331630483
 [S12DB] TGT i_101 result: 30.72885331630483 * 2476.6199999999994 = 76103.69270022685
 [S12DB] TGT g_104 calc: (0.27834106264768865*2476.6199999999994 + 0.3243243243243243*1100.42)/3577.0400009999994 = 0.29248708855785915
 [S12DB] TGT ROW104: i_101=76103.69270022685, i_102=16788.24544864865, i_103=23178.387012790416 → i_104=116070.32516166591
 [S12DB] TGT ROW104: h_21="Capacitance", k_98=-3293.5693790538335 → k_104=-3293.5693790538335
 [S12DB] g_104 DISPLAY (target): 0.2924870886396271
 [Section12] Calculated display values updated for target mode
 [S10 DEBUG] calculateAll() triggered in target mode - running both engines
 [S10 DEBUG] Dual-engine calculations complete in target mode
 [S11] calculateAll TRIGGERED. isReferenceMode: false
 [S11] REF TB%=50% → ref_i_97=31694.95, ref_k_97=-2133.81
 [S11] Writing ref penalty: ref_i_97=31694.95, ref_k_97=-2133.81
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (TGT)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [S07] calculateEmissionsAndLosses: systemType="Heatpump" (REF)
 [S07] ⚡ Non-fossil fuel: Heatpump → e_51=0, k_54=0 (both cleared)
 [Section13] 🚀 CALCULATEALL TRIGGERED - Running dual-engine calculations...
4011-Section13.js:2941 [Section13] 🎯 Mode captured at calculation start: target
4011-Section13.js:2947 [Section13] 🔄 Starting Reference Model calculations...
4011-Section13.js:2997 [Section13] Running Reference Model calculations...
4011-Section13.js:3011 [S13 CONTAMINATION DEBUG] calculateReferenceModel: Using system type = Gas
4011-Section13.js:2464 [S13] REF HEATING: system=Gas, ted=95433.18760223371, afue=0.9, cop=1
4011-Section13.js:2555 [Section13] 🧊 COOLING CALC: mode=REF, coolingSystemType="Cooling", heatingType="Gas", isCoolingActive=true, coolingDemand=10192.893604542265
4011-Section13.js:3259 [S13 CONTAMINATION DEBUG] storeReferenceResults called during target mode
4011-Section13.js:3262 [S13 CONTAMINATION DEBUG] Reference heating system: Gas
4011-Section13.js:3265 [S13 CONTAMINATION DEBUG] Target heating system: Heatpump
4011-Section13.js:3268 [S13 CONTAMINATION DEBUG] Reference h_115 (gas volume): 10235.21960555917
4011-Section13.js:3271 [S13 CONTAMINATION DEBUG] Reference f_115 (oil volume): 0
4011-Section13.js:3283 [S13 CONTAMINATION DEBUG] Writing ref_f_115 = 0
4011-Section13.js:3283 [S13 CONTAMINATION DEBUG] Writing ref_h_115 = 10235.21960555917
4011-Section13.js:3295 [Section13] Reference results stored with ref_ prefix for downstream sections
4011-Section13.js:3298 [S13 DEBUG] Total Reference results stored: 34
4011-Section13.js:3044 [Section13] Reference Model calculations complete
4011-Section13.js:2949 [Section13] ✅ Reference Model complete
4011-Section13.js:2951 [Section13] 🔄 Starting Target Model calculations...
4011-Section13.js:3058 [Section13] Running Target Model calculations...
4011-Section13.js:2464 [S13] TGT HEATING: system=Heatpump, ted=119171.54500166589, afue=1, cop=3.663540445486518
4011-Section13.js:2555 [Section13] 🧊 COOLING CALC: mode=TGT, coolingSystemType="Cooling", heatingType="Heatpump", isCoolingActive=true, coolingDemand=10192.893604542265
4011-Section13.js:2616 [Section13] 🧊 COOLING RESULTS: d_117=3826.8214105081656, j_116=2.663540445486518, l_116=0, l_114=6366.0721940341
4011-Section13.js:3097 [Section13] Target Model calculations complete
4011-Section13.js:2953 [Section13] ✅ Target Model complete
4011-Section13.js:2980 [Section13] ⏭️ Skipping Reference value re-write - triggered in target mode
4011-Section13.js:2986 [Section13] 🎉 DUAL-ENGINE CALCULATIONS COMPLETE
4011-Section06.js:513 🟢 [S06-TAR] Storing d_43 = 0 (from d_44=0, d_45=0, d_46=0)
4011-Section06.js:508 🔵 [S06-REF] Storing ref_d_43 = 0 (from d_44=0, d_45=0, d_46=0)
4011-Section14.js:986 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 63389.89418794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
4011-Section14.js:993 [S14 DEBUG] ✅ ref_d_127 = 95433.18760223371 (should be numeric, not NaN)
4011-Section14.js:1003 [S14 DEBUG] ✅ Stored ref_d_127 = 95433.18760223371 in StateManager
4011-Section14.js:1006 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1021 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 63389.89418794294 + 36440.079840319355 - 120694.93352 = 10829.987602233756
4011-Section04.js:1535 [S04] Starting dual-engine Excel-compliant calculations
4011-Section04.js:976 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 133574.36633416289, K32: 6812.2926830423075
4011-Section04.js:94 [S04] j_32 update: 133574.36633416289
4011-Section04.js:976 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 229309.58900641365, K32: 8255.145204230892
4011-Section04.js:1626 [S04] Reference model calculations complete
4011-Section04.js:1632 [S04DB] storeReference: ref_j_32=229309.58900641365, ref_k_32=8255.145204230892 | current target j_32=133574.36633416289, k_32=6812.2926830423075
4011-Section04.js:451 [S04] 🔄 Updating calculated display values for target mode
4011-Section04.js:459 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=229309.58900641365 k_32=6812.2926830423075 ref_k_32=8255.145204230892
4011-Section04.js:540 [S04 DEBUG] Target mode - j_32: 133574.36633416289
4011-Section04.js:540 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
4011-Section04.js:540 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:575 [S04] Calculated display values updated for target mode
4011-Section04.js:1557 [S04] Dual-engine calculations completed successfully
4011-Dependency.js:116 [DependencyGraph] Data loaded: 389 nodes, 663 links
4011-Dependency.js:718 [DependencyGraph] Calculating node sizes...
4011-Section01.js:1014 [S01DB] upstream snapshot Object
4011-Section01.js:574 🔍 [S01DB] updateTEUIDisplay START: e_10=341.2, h_10=93.0, useType=Utility Bills
4011-Section01.js:729 🔍 [S01DB] UPDATING h_10: 93.6 (from j_32=133574.36633416289, area=1427.2)
4011-Clock.js:59 🕐 [CLOCK] ⭐ INITIALIZATION COMPLETE: 553ms (all calculations finalized)
4011-Section01.js:1032 ✅ [S01] CALCULATION CHAIN COMPLETE - All values finalized including h_10
4011-Section10.js:153 [S10 DEBUG] Mode switch: target → REFERENCE
4011-Section10.js:157 [S10 DEBUG] Calling updateCalculatedDisplayValues() for reference mode
4011-Section11.js:246 S11: Switched to REFERENCE mode
4011-Section10.js:524 [S10 AREA EVENT] handleFieldBlur: d_73=100 in reference mode
4011-Section10.js:184 [S10 MODEMANAGER DEBUG] setValue: d_73=100 in reference mode, source=user-modified
4011-Clock.js:146 [CLOCK] 🎯 User interaction started - timing to h_10 settlement
4011-Section11.js:2022 [S11 AREA] Reference listener: ref_d_73=100 → d_88
4011-Section11.js:1672 [S11] calculateAll TRIGGERED. isReferenceMode: false
4011-Section11.js:1241 [S11] REF TB%=50% → ref_i_97=42679.75, ref_k_97=-1665.76
4011-Section10.js:2436 S10: Reference listener triggered by ref_i_98, recalculating all.
4011-Section10.js:1679 [S10 DEBUG] calculateAll() triggered in reference mode - running both engines
4011-Section14.js:986 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
4011-Section14.js:993 [S14 DEBUG] ✅ ref_d_127 = 117402.78760223372 (should be numeric, not NaN)
4011-Section14.js:1003 [S14 DEBUG] ✅ Stored ref_d_127 = 117402.78760223372 in StateManager
4011-Section14.js:1006 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1021 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 - 120694.93352 = 32799.58760223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 120694.93352
 [S14 DEBUG] ✅ ref_d_127 = 117402.78760223372 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 117402.78760223372 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 - 120694.93352 = 32799.58760223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 125399.14352
 [S14 DEBUG] ✅ ref_d_127 = 112698.57760223372 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 112698.57760223372 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 - 125399.14352 = 28095.37760223377
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 125399.14352
 [S14 DEBUG] ✅ ref_d_127 = 112698.57760223372 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 112698.57760223372 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 - 125399.14352 = 28095.37760223377
 [S04] S15 reference electricity changed: ref_d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 133574.36633416289, K32: 6812.2926830423075
 [S04] j_32 update: 133574.36633416289
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 224605.37900641368, K32: 8085.793644230893
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=224605.37900641368, ref_k_32=8085.793644230893 | current target j_32=133574.36633416289, k_32=6812.2926830423075
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=224605.37900641368 k_32=6812.2926830423075 ref_k_32=8085.793644230893
 [S04 DEBUG] Target mode - j_32: 133574.36633416289
 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=224605.37900641368 k_32=6812.2926830423075 ref_k_32=8085.793644230893
 [S04 DEBUG] Target mode - j_32: 133574.36633416289
 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S10 DEBUG] Dual-engine calculations complete in reference mode
 S10: Reference utilization factor dependency ref_i_98 changed.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 187938.06371423372 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 187938.06371423372 in StateManager
4011-Section14.js:1006 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1021 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 - 50159.657408 = 103334.86371423377
4011-Section14.js:986 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
4011-Section14.js:993 [S14 DEBUG] ✅ ref_d_127 = 187938.06371423372 (should be numeric, not NaN)
4011-Section14.js:1003 [S14 DEBUG] ✅ Stored ref_d_127 = 187938.06371423372 in StateManager
4011-Section14.js:1006 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1021 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 - 50159.657408 = 103334.86371423377
4011-Section04.js:2448 [S04] S15 reference electricity changed: ref_d_136
4011-Section04.js:1535 [S04] Starting dual-engine Excel-compliant calculations
4011-Section04.js:976 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 133574.36633416289, K32: 6812.2926830423075
4011-Section04.js:94 [S04] j_32 update: 133574.36633416289
4011-Section04.js:976 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 299844.8651184137, K32: 10794.415144262894
24011-Section05.js:266 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=299844.8651184137, ref_k_32=10794.415144262894 | current target j_32=133574.36633416289, k_32=6812.2926830423075
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=299844.8651184137 k_32=6812.2926830423075 ref_k_32=10794.415144262894
 [S04 DEBUG] Target mode - j_32: 133574.36633416289
 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=299844.8651184137 k_32=6812.2926830423075 ref_k_32=10794.415144262894
 [S04 DEBUG] Target mode - j_32: 133574.36633416289
 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 187938.06371423372 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 187938.06371423372 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 - 50159.657408 = 103334.86371423377
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 187938.06371423372 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 187938.06371423372 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 - 50159.657408 = 103334.86371423377
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 187938.06371423372 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 187938.06371423372 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 - 50159.657408 = 103334.86371423377
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 187938.06371423372 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 187938.06371423372 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 31694.94709397147 + 85359.49418794294 + 36440.079840319355 - 50159.657408 = 103334.86371423377
 [S11] Writing ref penalty: ref_i_97=42679.75, ref_k_97=-1665.76
 S10: Reference listener triggered by ref_i_97, recalculating all.
 [S10 DEBUG] calculateAll() triggered in reference mode - running both engines
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 42679.74709397147 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 125399.14352
 [S14 DEBUG] ✅ ref_d_127 = 123683.37760223371 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 123683.37760223371 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 42679.74709397147 + 85359.49418794294 + 36440.079840319355 - 125399.14352 = 39080.17760223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 42679.74709397147 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 125399.14352
 [S14 DEBUG] ✅ ref_d_127 = 123683.37760223371 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 123683.37760223371 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 42679.74709397147 + 85359.49418794294 + 36440.079840319355 - 125399.14352 = 39080.17760223376
 [S04] S15 reference electricity changed: ref_d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 133574.36633416289, K32: 6812.2926830423075
 [S04] j_32 update: 133574.36633416289
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 224605.37900641368, K32: 8085.793644230893
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=224605.37900641368, ref_k_32=8085.793644230893 | current target j_32=133574.36633416289, k_32=6812.2926830423075
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=224605.37900641368 k_32=6812.2926830423075 ref_k_32=8085.793644230893
 [S04 DEBUG] Target mode - j_32: 133574.36633416289
 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=224605.37900641368 k_32=6812.2926830423075 ref_k_32=8085.793644230893
 [S04 DEBUG] Target mode - j_32: 133574.36633416289
 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S10 DEBUG] Dual-engine calculations complete in reference mode
 S10: Reference utilization factor dependency ref_i_97 changed.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 42679.74709397147 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 198922.8637142337 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 198922.8637142337 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 42679.74709397147 + 85359.49418794294 + 36440.079840319355 - 50159.657408 = 114319.66371423376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 42679.74709397147 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 198922.8637142337 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 198922.8637142337 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 42679.74709397147 + 85359.49418794294 + 36440.079840319355 - 50159.657408 = 114319.66371423376
 [S04] S15 reference electricity changed: ref_d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 133574.36633416289, K32: 6812.2926830423075
 [S04] j_32 update: 133574.36633416289
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 299844.8651184137, K32: 10794.415144262894
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Reference model calculations complete
4011-Section04.js:1632 [S04DB] storeReference: ref_j_32=299844.8651184137, ref_k_32=10794.415144262894 | current target j_32=133574.36633416289, k_32=6812.2926830423075
4011-Section04.js:451 [S04] 🔄 Updating calculated display values for target mode
4011-Section04.js:459 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=299844.8651184137 k_32=6812.2926830423075 ref_k_32=10794.415144262894
4011-Section04.js:540 [S04 DEBUG] Target mode - j_32: 133574.36633416289
4011-Section04.js:540 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
4011-Section04.js:540 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:575 [S04] Calculated display values updated for target mode
4011-Section04.js:1557 [S04] Dual-engine calculations completed successfully
4011-Section04.js:451 [S04] 🔄 Updating calculated display values for target mode
4011-Section04.js:459 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=299844.8651184137 k_32=6812.2926830423075 ref_k_32=10794.415144262894
4011-Section04.js:540 [S04 DEBUG] Target mode - j_32: 133574.36633416289
4011-Section04.js:540 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
4011-Section04.js:540 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:575 [S04] Calculated display values updated for target mode
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 42679.74709397147 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 198922.8637142337 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 198922.8637142337 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 42679.74709397147 + 85359.49418794294 + 36440.079840319355 - 50159.657408 = 114319.66371423376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 42679.74709397147 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 198922.8637142337 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 198922.8637142337 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 42679.74709397147 + 85359.49418794294 + 36440.079840319355 - 50159.657408 = 114319.66371423376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 42679.74709397147 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 198922.8637142337 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 198922.8637142337 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 42679.74709397147 + 85359.49418794294 + 36440.079840319355 - 50159.657408 = 114319.66371423376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 42679.74709397147 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 198922.8637142337 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 198922.8637142337 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 42679.74709397147 + 85359.49418794294 + 36440.079840319355 - 50159.657408 = 114319.66371423376
 S10: Reference listener triggered by ref_i_97, recalculating all.
 [S10 DEBUG] calculateAll() triggered in reference mode - running both engines
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 23812.91400558859 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 125399.14352
 [S14 DEBUG] ✅ ref_d_127 = 104816.54451385084 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 104816.54451385084 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 23812.91400558859 + 85359.49418794294 + 36440.079840319355 - 125399.14352 = 20213.344513850883
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 23812.91400558859 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 125399.14352
 [S14 DEBUG] ✅ ref_d_127 = 104816.54451385084 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 104816.54451385084 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 23812.91400558859 + 85359.49418794294 + 36440.079840319355 - 125399.14352 = 20213.344513850883
 [S04] S15 reference electricity changed: ref_d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 133574.36633416289, K32: 6812.2926830423075
 [S04] j_32 update: 133574.36633416289
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 224605.37900641368, K32: 8085.793644230893
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=224605.37900641368, ref_k_32=8085.793644230893 | current target j_32=133574.36633416289, k_32=6812.2926830423075
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=224605.37900641368 k_32=6812.2926830423075 ref_k_32=8085.793644230893
 [S04 DEBUG] Target mode - j_32: 133574.36633416289
 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=224605.37900641368 k_32=6812.2926830423075 ref_k_32=8085.793644230893
 [S04 DEBUG] Target mode - j_32: 133574.36633416289
 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S10 DEBUG] Dual-engine calculations complete in reference mode
 S10: Reference utilization factor dependency ref_i_97 changed.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 23812.91400558859 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 180056.03062585084 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 180056.03062585084 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 23812.91400558859 + 85359.49418794294 + 36440.079840319355 - 50159.657408 = 95452.83062585088
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 23812.91400558859 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 180056.03062585084 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 180056.03062585084 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 23812.91400558859 + 85359.49418794294 + 36440.079840319355 - 50159.657408 = 95452.83062585088
 [S04] S15 reference electricity changed: ref_d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 133574.36633416289, K32: 6812.2926830423075
 [S04] j_32 update: 133574.36633416289
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 299844.8651184137, K32: 10794.415144262894
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=299844.8651184137, ref_k_32=10794.415144262894 | current target j_32=133574.36633416289, k_32=6812.2926830423075
4011-Section04.js:451 [S04] 🔄 Updating calculated display values for target mode
4011-Section04.js:459 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=299844.8651184137 k_32=6812.2926830423075 ref_k_32=10794.415144262894
4011-Section04.js:540 [S04 DEBUG] Target mode - j_32: 133574.36633416289
4011-Section04.js:540 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
4011-Section04.js:540 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:575 [S04] Calculated display values updated for target mode
4011-Section04.js:1557 [S04] Dual-engine calculations completed successfully
4011-Section04.js:451 [S04] 🔄 Updating calculated display values for target mode
4011-Section04.js:459 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=299844.8651184137 k_32=6812.2926830423075 ref_k_32=10794.415144262894
4011-Section04.js:540 [S04 DEBUG] Target mode - j_32: 133574.36633416289
4011-Section04.js:540 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
4011-Section04.js:540 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:575 [S04] Calculated display values updated for target mode
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 23812.91400558859 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 180056.03062585084 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 180056.03062585084 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 23812.91400558859 + 85359.49418794294 + 36440.079840319355 - 50159.657408 = 95452.83062585088
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 23812.91400558859 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 180056.03062585084 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 180056.03062585084 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 23812.91400558859 + 85359.49418794294 + 36440.079840319355 - 50159.657408 = 95452.83062585088
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 23812.91400558859 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 180056.03062585084 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 180056.03062585084 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 23812.91400558859 + 85359.49418794294 + 36440.079840319355 - 50159.657408 = 95452.83062585088
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 23812.91400558859 + 85359.49418794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 180056.03062585084 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 180056.03062585084 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 23812.91400558859 + 85359.49418794294 + 36440.079840319355 - 50159.657408 = 95452.83062585088
 S10: Reference listener triggered by ref_i_98, recalculating all.
 [S10 DEBUG] calculateAll() triggered in reference mode - running both engines
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 23812.91400558859 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 125399.14352
 [S14 DEBUG] ✅ ref_d_127 = 138521.62035385083 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 138521.62035385083 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 23812.91400558859 + 119064.57002794294 + 36440.079840319355 - 125399.14352 = 53918.42035385089
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 23812.91400558859 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 125399.14352
 [S14 DEBUG] ✅ ref_d_127 = 138521.62035385083 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 138521.62035385083 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 23812.91400558859 + 119064.57002794294 + 36440.079840319355 - 125399.14352 = 53918.42035385089
 [S04] S15 reference electricity changed: ref_d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 133574.36633416289, K32: 6812.2926830423075
 [S04] j_32 update: 133574.36633416289
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 224605.37900641368, K32: 8085.793644230893
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=224605.37900641368, ref_k_32=8085.793644230893 | current target j_32=133574.36633416289, k_32=6812.2926830423075
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=224605.37900641368 k_32=6812.2926830423075 ref_k_32=8085.793644230893
 [S04 DEBUG] Target mode - j_32: 133574.36633416289
 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=224605.37900641368 k_32=6812.2926830423075 ref_k_32=8085.793644230893
 [S04 DEBUG] Target mode - j_32: 133574.36633416289
 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S10 DEBUG] Dual-engine calculations complete in reference mode
 S10: Reference utilization factor dependency ref_i_98 changed.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 23812.91400558859 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 213761.1064658508 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 213761.1064658508 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 23812.91400558859 + 119064.57002794294 + 36440.079840319355 - 50159.657408 = 129157.90646585089
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 23812.91400558859 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 213761.1064658508 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 213761.1064658508 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 23812.91400558859 + 119064.57002794294 + 36440.079840319355 - 50159.657408 = 129157.90646585089
 [S04] S15 reference electricity changed: ref_d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 133574.36633416289, K32: 6812.2926830423075
 [S04] j_32 update: 133574.36633416289
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 299844.8651184137, K32: 10794.415144262894
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=299844.8651184137, ref_k_32=10794.415144262894 | current target j_32=133574.36633416289, k_32=6812.2926830423075
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=299844.8651184137 k_32=6812.2926830423075 ref_k_32=10794.415144262894
 [S04 DEBUG] Target mode - j_32: 133574.36633416289
 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=299844.8651184137 k_32=6812.2926830423075 ref_k_32=10794.415144262894
 [S04 DEBUG] Target mode - j_32: 133574.36633416289
 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
4011-Section04.js:540 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:575 [S04] Calculated display values updated for target mode
4011-Section14.js:986 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 23812.91400558859 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
4011-Section14.js:993 [S14 DEBUG] ✅ ref_d_127 = 213761.1064658508 (should be numeric, not NaN)
4011-Section14.js:1003 [S14 DEBUG] ✅ Stored ref_d_127 = 213761.1064658508 in StateManager
4011-Section14.js:1006 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1021 [S14 DEBUG] ref_d_128 calculation: 23812.91400558859 + 119064.57002794294 + 36440.079840319355 - 50159.657408 = 129157.90646585089
4011-Section14.js:986 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 23812.91400558859 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
4011-Section14.js:993 [S14 DEBUG] ✅ ref_d_127 = 213761.1064658508 (should be numeric, not NaN)
4011-Section14.js:1003 [S14 DEBUG] ✅ Stored ref_d_127 = 213761.1064658508 in StateManager
4011-Section14.js:1006 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1021 [S14 DEBUG] ref_d_128 calculation: 23812.91400558859 + 119064.57002794294 + 36440.079840319355 - 50159.657408 = 129157.90646585089
4011-Section14.js:986 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 23812.91400558859 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
4011-Section14.js:993 [S14 DEBUG] ✅ ref_d_127 = 213761.1064658508 (should be numeric, not NaN)
4011-Section14.js:1003 [S14 DEBUG] ✅ Stored ref_d_127 = 213761.1064658508 in StateManager
4011-Section14.js:1006 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1021 [S14 DEBUG] ref_d_128 calculation: 23812.91400558859 + 119064.57002794294 + 36440.079840319355 - 50159.657408 = 129157.90646585089
4011-Section14.js:986 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 23812.91400558859 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
4011-Section14.js:993 [S14 DEBUG] ✅ ref_d_127 = 213761.1064658508 (should be numeric, not NaN)
4011-Section14.js:1003 [S14 DEBUG] ✅ Stored ref_d_127 = 213761.1064658508 in StateManager
4011-Section14.js:1006 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1021 [S14 DEBUG] ref_d_128 calculation: 23812.91400558859 + 119064.57002794294 + 36440.079840319355 - 50159.657408 = 129157.90646585089
 S10: Reference listener triggered by ref_i_97, recalculating all.
 [S10 DEBUG] calculateAll() triggered in reference mode - running both engines
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 125399.14352
 [S14 DEBUG] ✅ ref_d_127 = 157388.45344223373 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 157388.45344223373 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 - 125399.14352 = 72785.25344223376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 125399.14352
 [S14 DEBUG] ✅ ref_d_127 = 157388.45344223373 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 157388.45344223373 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 - 125399.14352 = 72785.25344223376
 [S04] S15 reference electricity changed: ref_d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 133574.36633416289, K32: 6812.2926830423075
 [S04] j_32 update: 133574.36633416289
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 224605.37900641368, K32: 8085.793644230893
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=224605.37900641368, ref_k_32=8085.793644230893 | current target j_32=133574.36633416289, k_32=6812.2926830423075
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=224605.37900641368 k_32=6812.2926830423075 ref_k_32=8085.793644230893
 [S04 DEBUG] Target mode - j_32: 133574.36633416289
 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=224605.37900641368 k_32=6812.2926830423075 ref_k_32=8085.793644230893
 [S04 DEBUG] Target mode - j_32: 133574.36633416289
 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S10 DEBUG] Dual-engine calculations complete in reference mode
 S10: Reference utilization factor dependency ref_i_97 changed.
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 232627.93955423372 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 232627.93955423372 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 - 50159.657408 = 148024.73955423376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 232627.93955423372 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 232627.93955423372 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 - 50159.657408 = 148024.73955423376
 [S04] S15 reference electricity changed: ref_d_136
 [S04] Starting dual-engine Excel-compliant calculations
 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 133574.36633416289, K32: 6812.2926830423075
 [S04] j_32 update: 133574.36633416289
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 299844.8651184137, K32: 10794.415144262894
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=299844.8651184137, ref_k_32=10794.415144262894 | current target j_32=133574.36633416289, k_32=6812.2926830423075
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=299844.8651184137 k_32=6812.2926830423075 ref_k_32=10794.415144262894
 [S04 DEBUG] Target mode - j_32: 133574.36633416289
 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S04] Dual-engine calculations completed successfully
 [S04] 🔄 Updating calculated display values for target mode
 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=299844.8651184137 k_32=6812.2926830423075 ref_k_32=10794.415144262894
 [S04 DEBUG] Target mode - j_32: 133574.36633416289
 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
 [S04 DEBUG] Target mode - l_27: 51
 [S04] Calculated display values updated for target mode
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 232627.93955423372 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 232627.93955423372 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 - 50159.657408 = 148024.73955423376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 232627.93955423372 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 232627.93955423372 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 - 50159.657408 = 148024.73955423376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 232627.93955423372 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 232627.93955423372 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 - 50159.657408 = 148024.73955423376
 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 50159.657408
 [S14 DEBUG] ✅ ref_d_127 = 232627.93955423372 (should be numeric, not NaN)
 [S14 DEBUG] ✅ Stored ref_d_127 = 232627.93955423372 in StateManager
 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
 [S14 DEBUG] ref_d_128 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 - 50159.657408 = 148024.73955423376
 [S10 MODEMANAGER DEBUG] Reference StateManager write: ref_d_73=100
 [S10 CALC TRIGGER] calculateAll() triggered by d_73 in reference mode
 [S10 DEBUG] calculateAll() triggered in reference mode - running both engines
4011-Section14.js:986 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 125399.14352
4011-Section14.js:993 [S14 DEBUG] ✅ ref_d_127 = 157388.45344223373 (should be numeric, not NaN)
4011-Section14.js:1003 [S14 DEBUG] ✅ Stored ref_d_127 = 157388.45344223373 in StateManager
4011-Section14.js:1006 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1021 [S14 DEBUG] ref_d_128 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 - 125399.14352 = 72785.25344223376
4011-Section14.js:986 [S14 DEBUG] ✅ Converted to numbers - ref_d_127 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 + 84603.19999999995 - 125399.14352
4011-Section14.js:993 [S14 DEBUG] ✅ ref_d_127 = 157388.45344223373 (should be numeric, not NaN)
4011-Section14.js:1003 [S14 DEBUG] ✅ Stored ref_d_127 = 157388.45344223373 in StateManager
4011-Section14.js:1006 [S14 DEBUG] 🔄 Continuing with other Reference calculations...
4011-Section14.js:1021 [S14 DEBUG] ref_d_128 calculation: 42679.74709397147 + 119064.57002794294 + 36440.079840319355 - 125399.14352 = 72785.25344223376
4011-Section04.js:2448 [S04] S15 reference electricity changed: ref_d_136
4011-Section04.js:1535 [S04] Starting dual-engine Excel-compliant calculations
4011-Section04.js:976 [S04] Row 32 Subtotals - F32: 132938, G32: 6779.838, J32: 133574.36633416289, K32: 6812.2926830423075
 [S04] j_32 update: 133574.36633416289
 [S04] Row 32 Subtotals - F32: 132938, G32: 4785.768, J32: 224605.37900641368, K32: 8085.793644230893
2 🔄 [S05] updateCalculatedDisplayValues: mode=target
 [S04] Reference model calculations complete
 [S04DB] storeReference: ref_j_32=224605.37900641368, ref_k_32=8085.793644230893 | current target j_32=133574.36633416289, k_32=6812.2926830423075
 [S04] 🔄 Updating calculated display values for target mode
4011-Section04.js:459 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=224605.37900641368 k_32=6812.2926830423075 ref_k_32=8085.793644230893
4011-Section04.js:540 [S04 DEBUG] Target mode - j_32: 133574.36633416289
4011-Section04.js:540 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
4011-Section04.js:540 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:575 [S04] Calculated display values updated for target mode
4011-Section04.js:1557 [S04] Dual-engine calculations completed successfully
4011-Section04.js:451 [S04] 🔄 Updating calculated display values for target mode
4011-Section04.js:459 [S04DB] displayContext mode=target j_32=133574.36633416289 ref_j_32=224605.37900641368 k_32=6812.2926830423075 ref_k_32=8085.793644230893
4011-Section04.js:540 [S04 DEBUG] Target mode - j_32: 133574.36633416289
4011-Section04.js:540 [S04 DEBUG] Target mode - k_32: 6812.2926830423075
4011-Section04.js:540 [S04 DEBUG] Target mode - l_27: 51
4011-Section04.js:575 [S04] Calculated display values updated for target mode
4011-Section10.js:1685 [S10 DEBUG] Dual-engine calculations complete in reference mode
4011-Section01.js:1014 [S01DB] upstream snapshot {ref_j_32: 224605.37900641368, ref_k_32: 8085.793644230893, j_32: 133574.36633416289, k_32: 6812.2926830423075, ref_h_15: '1427.20', …}
4011-Section01.js:574 🔍 [S01DB] updateTEUIDisplay START: e_10=341.2, h_10=93.0, useType=Utility Bills
4011-Section01.js:729 🔍 [S01DB] UPDATING h_10: 93.6 (from j_32=133574.36633416289, area=1427.2)
4011-Clock.js:65 🕐 [CLOCK] ⚡ CALCULATION COMPLETE: 345ms (subsequent update)
4011-Clock.js:161 🕐 [CLOCK] ⚡ USER INTERACTION COMPLETE: 345ms (interaction → h_10 settlement)
4011-Section01.js:1032 ✅ [S01] CALCULATION CHAIN COMPLETE - All values finalized including h_10